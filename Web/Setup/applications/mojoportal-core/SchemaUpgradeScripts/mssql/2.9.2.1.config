SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


ALTER   PROCEDURE [dbo].[mp_UserRoles_SelectByUsername]
	@SiteID int,
	@Username NVARCHAR(225)
AS
BEGIN
	SELECT
		r.[RoleID],
		r.[SiteID],
		r.[RoleName],
		r.[DisplayName],
		r.[SiteGuid],
		r.[RoleGuid],
		r.[Description]
	FROM [dbo].[mp_UserRoles] ur
	INNER JOIN [dbo].[mp_Users] u ON ur.[UserID] = u.[UserID]
	INNER JOIN [dbo].[mp_Roles] r ON ur.[RoleID] = r.[RoleID]
	WHERE u.[SiteID] = @SiteID
	AND (u.[LoginName] = @Username OR u.[Email] = @Username);
END
