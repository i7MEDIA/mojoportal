CREATE TABLE mp_LetterInfo (
 LetterInfoGuid VARCHAR(36) NOT NULL, 
 SiteGuid VARCHAR(36) NOT NULL,
 Title VARCHAR(255) NOT NULL,
 Description BLOB SUB_TYPE 1 NOT NULL,
 AvailableToRoles BLOB SUB_TYPE 1 NOT NULL,
 Enabled SMALLINT NOT NULL,
 AllowUserFeedback SMALLINT NOT NULL,
 AllowAnonFeedback SMALLINT NOT NULL,
 FromAddress VARCHAR(255) NOT NULL,
 FromName VARCHAR(255) NOT NULL,
 ReplyToAddress VARCHAR(255) NOT NULL,
 SendMode INTEGER NOT NULL,
 EnableViewAsWebPage SMALLINT NOT NULL,
 EnableSendLog SMALLINT NOT NULL,
 RolesThatCanEdit BLOB SUB_TYPE 1 NOT NULL,
 RolesThatCanApprove BLOB SUB_TYPE 1 NOT NULL,
 RolesThatCanSend BLOB SUB_TYPE 1 NOT NULL,
 SubscriberCount INTEGER NOT NULL,
 CreatedUTC TIMESTAMP NOT NULL,
 CreatedBy VARCHAR(36) NOT NULL,
 LastModUTC TIMESTAMP NOT NULL,
 LastModBy VARCHAR(36) NOT NULL,
 PRIMARY KEY (LetterInfoGuid)   
);

CREATE TABLE mp_Letter (
 LetterGuid VARCHAR(36) NOT NULL, 
 LetterInfoGuid VARCHAR(36) NOT NULL,
 Subject VARCHAR(255) NOT NULL,
 HtmlBody BLOB SUB_TYPE 1 NOT NULL,
 TextBody BLOB SUB_TYPE 1 NOT NULL,
 CreatedBy VARCHAR(36) NOT NULL,
 CreatedUTC TIMESTAMP NOT NULL,
 LastModBy VARCHAR(36) NOT NULL,
 LastModUTC TIMESTAMP NOT NULL,
 IsApproved SMALLINT NOT NULL,
 ApprovedBy VARCHAR(36) NOT NULL,
 SendClickedUTC TIMESTAMP ,
 SendStartedUTC TIMESTAMP ,
 SendCompleteUTC TIMESTAMP ,
 SendCount INTEGER NOT NULL,
 PRIMARY KEY (LetterGuid)   
);

CREATE TABLE mp_LetterHtmlTemplate (
 Guid VARCHAR(36) NOT NULL, 
 SiteGuid VARCHAR(36) NOT NULL,
 Title VARCHAR(255) NOT NULL,
 Html BLOB SUB_TYPE 1 NOT NULL,
 LastModUTC TIMESTAMP NOT NULL,
 PRIMARY KEY (Guid)   
);


CREATE TABLE mp_LetterSendLog (
 RowID INTEGER NOT NULL , 
 LetterGuid VARCHAR(36) NOT NULL,
 UserGuid VARCHAR(36) NOT NULL,
 EmailAddress VARCHAR(100) ,
 UTC TIMESTAMP NOT NULL,
 ErrorOccurred SMALLINT NOT NULL,
 ErrorMessage BLOB SUB_TYPE 1 ,
PRIMARY KEY (RowID)
);

CREATE SEQUENCE mp_LetterSendLog_seq;

CREATE TABLE mp_LetterSubscriber (
 LetterInfoGuid VARCHAR(36) NOT NULL,
 UserGuid VARCHAR(36) NOT NULL,
 UseHtml SMALLINT NOT NULL,
 BeginUTC TIMESTAMP NOT NULL,
PRIMARY KEY (LetterInfoGuid,UserGuid)
);



CREATE TABLE mp_LetterSubscriberHx (
 RowID INTEGER NOT NULL , 
 LetterInfoGuid VARCHAR(36) NOT NULL,
 UserGuid VARCHAR(36) NOT NULL,
 UseHtml SMALLINT NOT NULL,
 BeginUTC TIMESTAMP NOT NULL,
 EndUTC TIMESTAMP NOT NULL,
PRIMARY KEY (RowID)
);

CREATE SEQUENCE mp_LetterSubscriberHx_seq;
