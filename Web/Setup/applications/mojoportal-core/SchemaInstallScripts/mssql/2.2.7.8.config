/****** Object:  Table [dbo].[mp_Sites]    Script Date: 11/10/2008 11:37:48 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_Sites](
	[SiteID] [int] IDENTITY(1,1) NOT NULL,
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[SiteAlias] [nvarchar](50) NULL,
	[SiteName] [nvarchar](255) NOT NULL,
	[Skin] [nvarchar](100) NULL,
	[Logo] [nvarchar](50) NULL,
	[Icon] [nvarchar](50) NULL,
	[AllowUserSkins] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_AllowUserSkins]  DEFAULT ((0)),
	[AllowPageSkins] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_AllowPageSkins]  DEFAULT ((1)),
	[AllowHideMenuOnPages] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_AllowHideMenuOnPages]  DEFAULT ((1)),
	[AllowNewRegistration] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_AllowNewRegistration]  DEFAULT ((1)),
	[UseSecureRegistration] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_UseSecureRegistration]  DEFAULT ((0)),
	[UseSSLOnAllPages] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_UseSSLOnAllPages]  DEFAULT ((0)),
	[DefaultPageKeyWords] [nvarchar](255) NULL,
	[DefaultPageDescription] [nvarchar](255) NULL,
	[DefaultPageEncoding] [nvarchar](255) NULL,
	[DefaultAdditionalMetaTags] [nvarchar](255) NULL,
	[IsServerAdminSite] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_IsServerAdminSite]  DEFAULT ((0)),
	[UseLdapAuth] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_UseLdapAuth]  DEFAULT ((0)),
	[AutoCreateLdapUserOnFirstLogin] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_AutoCreateLdapUserOnFirstLogin]  DEFAULT ((1)),
	[LdapServer] [nvarchar](255) NULL,
	[LdapPort] [int] NOT NULL CONSTRAINT [DF_mp_Sites_LdapPort]  DEFAULT ((389)),
	[LdapDomain] [nvarchar](255) NULL,
	[LdapRootDN] [nvarchar](255) NULL,
	[LdapUserDNKey] [nvarchar](10) NOT NULL CONSTRAINT [DF_mp_Sites_LdapUserDNKey]  DEFAULT ('uid'),
	[ReallyDeleteUsers] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_ReallyDeleteUsers]  DEFAULT ((1)),
	[UseEmailForLogin] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_UseEmailForLogin]  DEFAULT ((1)),
	[AllowUserFullNameChange] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_AllowUserFullNameChange]  DEFAULT ((0)),
	[EditorSkin] [nvarchar](50) NOT NULL CONSTRAINT [DF_mp_Sites_EditorSkin]  DEFAULT ('normal'),
	[DefaultFriendlyUrlPatternEnum] [nvarchar](50) NOT NULL CONSTRAINT [DF_mp_Sites_DefaultFriendlyUrlPatternEnum]  DEFAULT ('PageNameWithDotASPX'),
	[AllowPasswordRetrieval] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_AllowPasswordRetrieval]  DEFAULT ((1)),
	[AllowPasswordReset] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_AllowPasswordReset]  DEFAULT ((1)),
	[RequiresQuestionAndAnswer] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_RequiresQuestionAndAnswer]  DEFAULT ((0)),
	[MaxInvalidPasswordAttempts] [int] NOT NULL CONSTRAINT [DF_mp_Sites_MaxInvalidPasswordAttempts]  DEFAULT ((5)),
	[PasswordAttemptWindowMinutes] [int] NOT NULL CONSTRAINT [DF_mp_Sites_PasswordAttemptWindowMinutes]  DEFAULT ((5)),
	[RequiresUniqueEmail] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_RequiresUniqueEmail]  DEFAULT ((1)),
	[PasswordFormat] [int] NOT NULL CONSTRAINT [DF_mp_Sites_PasswordFormat]  DEFAULT ((0)),
	[MinRequiredPasswordLength] [int] NOT NULL CONSTRAINT [DF_mp_Sites_MinRequiredPasswordLength]  DEFAULT ((4)),
	[MinReqNonAlphaChars] [int] NOT NULL CONSTRAINT [DF_mp_Sites_MinRequiredNonAlphanumericCharacters]  DEFAULT ((0)),
	[PwdStrengthRegex] [ntext] NULL,
	[DefaultEmailFromAddress] [nvarchar](100) NULL,
	[EnableMyPageFeature] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_EnableMyPageFeature]  DEFAULT ((1)),
	[EditorProvider] [nvarchar](255) NULL,
	[CaptchaProvider] [nvarchar](255) NULL,
	[DatePickerProvider] [nvarchar](255) NULL,
	[RecaptchaPrivateKey] [nvarchar](255) NULL,
	[RecaptchaPublicKey] [nvarchar](255) NULL,
	[WordpressAPIKey] [nvarchar](255) NULL,
	[WindowsLiveAppID] [nvarchar](255) NULL,
	[WindowsLiveKey] [nvarchar](255) NULL,
	[AllowOpenIDAuth] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_AllowOpenIDAuth]  DEFAULT ((0)),
	[AllowWindowsLiveAuth] [bit] NOT NULL CONSTRAINT [DF_mp_Sites_AllowWindowsLiveAuth]  DEFAULT ((0)),
	[GmapApiKey] [nvarchar](255) NULL,
	[ApiKeyExtra1] [nvarchar](255) NULL,
	[ApiKeyExtra2] [nvarchar](255) NULL,
	[ApiKeyExtra3] [nvarchar](255) NULL,
	[ApiKeyExtra4] [nvarchar](255) NULL,
	[ApiKeyExtra5] [nvarchar](255) NULL,
 CONSTRAINT [PK_Portals] PRIMARY KEY NONCLUSTERED 
(
	[SiteID] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [idxSitesGuid] ON [dbo].[mp_Sites] 
(
	[SiteGuid] ASC
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_Users]    Script Date: 11/10/2008 11:38:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_Users](
	[UserID] [int] IDENTITY(1,1) NOT NULL,
	[SiteID] [int] NOT NULL,
	[Name] [nvarchar](100) NOT NULL,
	[LoginName] [nvarchar](50) NULL,
	[Email] [nvarchar](100) NOT NULL,
	[LoweredEmail] [nvarchar](100) NULL,
	[Password] [nvarchar](128) NOT NULL,
	[PasswordQuestion] [nvarchar](255) NULL,
	[PasswordAnswer] [nvarchar](255) NULL,
	[Gender] [nchar](10) NULL,
	[ProfileApproved] [bit] NOT NULL CONSTRAINT [DF_Users_ProfileApproved]  DEFAULT ((1)),
	[RegisterConfirmGuid] [uniqueidentifier] NULL,
	[ApprovedForForums] [bit] NOT NULL CONSTRAINT [DF_Users_Approved]  DEFAULT ((1)),
	[Trusted] [bit] NOT NULL CONSTRAINT [DF_Users_Trusted]  DEFAULT ((0)),
	[DisplayInMemberList] [bit] NULL CONSTRAINT [DF_mp_Users_DisplayInMemberList]  DEFAULT ((1)),
	[WebSiteURL] [nvarchar](100) NULL,
	[Country] [nvarchar](100) NULL,
	[State] [nvarchar](100) NULL,
	[Occupation] [nvarchar](100) NULL,
	[Interests] [nvarchar](100) NULL,
	[MSN] [nvarchar](50) NULL,
	[Yahoo] [nvarchar](50) NULL,
	[AIM] [nvarchar](50) NULL,
	[ICQ] [nvarchar](50) NULL,
	[TotalPosts] [int] NOT NULL CONSTRAINT [DF_Users_TotalPosts]  DEFAULT ((0)),
	[AvatarUrl] [nvarchar](255) NULL CONSTRAINT [DF_mp_Users_AvatarUrl]  DEFAULT ('blank.gif'),
	[TimeOffsetHours] [int] NOT NULL CONSTRAINT [DF_mp_Users_TimeOffSetHours]  DEFAULT ((0)),
	[Signature] [nvarchar](255) NULL,
	[DateCreated] [datetime] NOT NULL CONSTRAINT [DF_Users_DateCreated]  DEFAULT (getdate()),
	[UserGuid] [uniqueidentifier] NULL CONSTRAINT [DF_mp_Users_UserGuid]  DEFAULT (newid()),
	[Skin] [nvarchar](100) NULL,
	[IsDeleted] [bit] NOT NULL CONSTRAINT [DF_mp_Users_IsDeleted]  DEFAULT ((0)),
	[LastActivityDate] [datetime] NULL,
	[LastLoginDate] [datetime] NULL,
	[LastPasswordChangedDate] [datetime] NULL,
	[LastLockoutDate] [datetime] NULL,
	[FailedPasswordAttemptCount] [int] NULL,
	[FailedPwdAttemptWindowStart] [datetime] NULL,
	[FailedPwdAnswerAttemptCount] [int] NULL,
	[FailedPwdAnswerWindowStart] [datetime] NULL,
	[IsLockedOut] [bit] NOT NULL CONSTRAINT [DF_mp_Users_IsLockedOut]  DEFAULT ((0)),
	[MobilePIN] [nvarchar](16) NULL,
	[PasswordSalt] [nvarchar](128) NULL,
	[Comment] [ntext] NULL,
	[OpenIDURI] [nvarchar](255) NULL,
	[WindowsLiveID] [nvarchar](36) NULL,
	[SiteGuid] [uniqueidentifier] NULL,
 CONSTRAINT [PK_mp_Users] PRIMARY KEY CLUSTERED 
(
	[UserID] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [idxUserUGuid] ON [dbo].[mp_Users] 
(
	[UserGuid] ASC
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_mp_Users] ON [dbo].[mp_Users] 
(
	[UserGuid] ASC
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_mp_Users_1] ON [dbo].[mp_Users] 
(
	[OpenIDURI] ASC
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_mp_Users_2] ON [dbo].[mp_Users] 
(
	[WindowsLiveID] ASC
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_Roles]    Script Date: 11/10/2008 11:37:10 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_Roles](
	[RoleID] [int] IDENTITY(1,1) NOT NULL,
	[SiteID] [int] NOT NULL,
	[RoleName] [nvarchar](50) NOT NULL,
	[DisplayName] [nvarchar](50) NULL,
	[SiteGuid] [uniqueidentifier] NULL,
	[RoleGuid] [uniqueidentifier] NULL,
 CONSTRAINT [PK_mp_Roles] PRIMARY KEY CLUSTERED 
(
	[RoleID] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_Pages]    Script Date: 11/10/2008 11:36:56 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_Pages](
	[PageID] [int] IDENTITY(0,1) NOT NULL,
	[ParentID] [int] NULL CONSTRAINT [DF_mp_Pages_ParentID]  DEFAULT ((-1)),
	[PageOrder] [int] NOT NULL,
	[SiteID] [int] NOT NULL,
	[PageName] [nvarchar](50) NOT NULL,
	[PageTitle] [nvarchar](255) NULL,
	[AuthorizedRoles] [ntext] NULL,
	[EditRoles] [ntext] NULL,
	[CreateChildPageRoles] [ntext] NULL,
	[RequireSSL] [bit] NOT NULL CONSTRAINT [DF_mp_Pages_RequireSSL]  DEFAULT ((0)),
	[AllowBrowserCache] [bit] NOT NULL CONSTRAINT [DF_mp_Pages_AllowBrowserCache]  DEFAULT ((1)),
	[ShowBreadcrumbs] [bit] NOT NULL CONSTRAINT [DF_mp_Pages_ShowBreadcrumbs]  DEFAULT ((0)),
	[PageKeyWords] [nvarchar](255) NULL,
	[PageDescription] [nvarchar](255) NULL,
	[PageEncoding] [nvarchar](255) NULL,
	[AdditionalMetaTags] [nvarchar](255) NULL,
	[MenuImage] [nvarchar](50) NULL,
	[UseUrl] [bit] NOT NULL CONSTRAINT [DF_mp_Pages_UseLinkInsteadOfPage]  DEFAULT ((0)),
	[Url] [nvarchar](255) NULL,
	[OpenInNewWindow] [bit] NOT NULL CONSTRAINT [DF_mp_Pages_OpenInNewWindow]  DEFAULT ((0)),
	[ShowChildPageMenu] [bit] NOT NULL CONSTRAINT [DF_mp_Pages_ShowChildPageMenu]  DEFAULT ((0)),
	[ShowChildBreadCrumbs] [bit] NOT NULL CONSTRAINT [DF_mp_Pages_ShowChildBreadCrumbs]  DEFAULT ((0)),
	[Skin] [nvarchar](100) NULL,
	[HideMainMenu] [bit] NOT NULL CONSTRAINT [DF_mp_Pages_HideMainMenu]  DEFAULT ((0)),
	[IncludeInMenu] [bit] NOT NULL CONSTRAINT [DF_mp_Pages_IncludeInMenu]  DEFAULT ((1)),
	[ChangeFrequency] [nvarchar](20) NULL,
	[SiteMapPriority] [nvarchar](10) NULL,
	[LastModifiedUTC] [datetime] NULL,
	[PageGuid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_Pages_PageGuid]  DEFAULT (newid()),
	[ParentGuid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_Pages_ParentGuid]  DEFAULT ('00000000-0000-0000-0000-000000000000'),
	[HideAfterLogin] [bit] NOT NULL CONSTRAINT [DF_mp_Pages_HideAfterLogin]  DEFAULT ((0)),
	[SiteGuid] [uniqueidentifier] NULL,
	[CompiledMeta] [ntext] NULL,
	[CompiledMetaUtc] [datetime] NULL,
 CONSTRAINT [PK_Tabs] PRIMARY KEY NONCLUSTERED 
(
	[PageID] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_ModuleDefinitions]    Script Date: 11/10/2008 11:36:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_ModuleDefinitions](
	[ModuleDefID] [int] IDENTITY(1,1) NOT NULL,
	[FeatureName] [nvarchar](255) NOT NULL,
	[ControlSrc] [nvarchar](255) NOT NULL,
	[SortOrder] [int] NOT NULL CONSTRAINT [DF_mp_ModuleDefinitions_SortOrder]  DEFAULT ((500)),
	[IsAdmin] [bit] NOT NULL CONSTRAINT [DF_mp_ModuleDefinitions_IsAdmin]  DEFAULT ((0)),
	[Icon] [nvarchar](255) NULL,
	[DefaultCacheTime] [int] NOT NULL CONSTRAINT [DF_mp_ModuleDefinitions_DefaultCacheTime]  DEFAULT ((0)),
	[Guid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_ModuleDefinitions_Guid]  DEFAULT (newid()),
	[ResourceFile] [nvarchar](255) NULL,
 CONSTRAINT [PK_ModuleDefinitions] PRIMARY KEY NONCLUSTERED 
(
	[ModuleDefID] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [idxModuleDefGuid] ON [dbo].[mp_ModuleDefinitions] 
(
	[Guid] ASC
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_mp_ModuleDefinitions] ON [dbo].[mp_ModuleDefinitions] 
(
	[Guid] ASC
) ON [PRIMARY]
GO

/****** Object:  Table [dbo].[mp_BannedIPAddresses]    Script Date: 11/10/2008 11:35:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_BannedIPAddresses](
	[RowID] [int] IDENTITY(1,1) NOT NULL,
	[BannedIP] [nvarchar](50) NOT NULL,
	[BannedUTC] [datetime] NOT NULL CONSTRAINT [DF_mp_BannedIPAddresses_BannedUTC]  DEFAULT (getutcdate()),
	[BannedReason] [nvarchar](255) NULL,
 CONSTRAINT [PK_mp_BannedIPAddresses] PRIMARY KEY CLUSTERED 
(
	[RowID] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_GoogleCheckoutLog]    Script Date: 11/10/2008 11:35:51 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_GoogleCheckoutLog](
	[RowGuid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_RowGuid]  DEFAULT (newid()),
	[CreatedUtc] [datetime] NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_CreatedUtc]  DEFAULT (getutcdate()),
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[UserGuid] [uniqueidentifier] NOT NULL,
	[StoreGuid] [uniqueidentifier] NOT NULL,
	[CartGuid] [uniqueidentifier] NOT NULL,
	[NotificationType] [nvarchar](255) NULL,
	[RawResponse] [ntext] NULL,
	[SerialNumber] [nvarchar](50) NULL,
	[GTimestamp] [datetime] NULL,
	[OrderNumber] [nvarchar](50) NULL,
	[BuyerId] [nvarchar](50) NULL,
	[FullfillState] [nvarchar](50) NULL,
	[FinanceState] [nvarchar](50) NULL,
	[EmailListOptIn] [bit] NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_EmailListOptIn]  DEFAULT ((0)),
	[AvsResponse] [nvarchar](5) NULL,
	[CvnResponse] [nvarchar](5) NULL,
	[AuthExpDate] [datetime] NULL,
	[AuthAmt] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_AuthAmt]  DEFAULT ((0)),
	[DiscountTotal] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_DiscountTotal]  DEFAULT ((0)),
	[ShippingTotal] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_ShippingTotal]  DEFAULT ((0)),
	[TaxTotal] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_TaxTotal]  DEFAULT ((0)),
	[OrderTotal] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_OrderTotal]  DEFAULT ((0)),
	[LatestChgAmt] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_LatestChgAmt]  DEFAULT ((0)),
	[TotalChgAmt] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_TotalChgAmt]  DEFAULT ((0)),
	[LatestRefundAmt] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_LatestRefundAmt]  DEFAULT ((0)),
	[TotalRefundAmt] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_TotalRefundAmt]  DEFAULT ((0)),
	[LatestChargeback] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_LatestChargeback]  DEFAULT ((0)),
	[TotalChargeback] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_GoogleCheckoutLog_TotalChargeback]  DEFAULT ((0)),
	[CartXml] [ntext] NULL,
	[ProviderName] [nvarchar](255) NULL,
 CONSTRAINT [PK_mp_GoogleCheckoutLog] PRIMARY KEY CLUSTERED 
(
	[RowGuid] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_UserPages]    Script Date: 11/10/2008 11:38:16 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_UserPages](
	[UserPageID] [uniqueidentifier] NOT NULL,
	[SiteID] [int] NOT NULL,
	[UserGuid] [uniqueidentifier] NOT NULL,
	[PageName] [nvarchar](255) NOT NULL,
	[PagePath] [nvarchar](255) NOT NULL,
	[PageOrder] [int] NOT NULL CONSTRAINT [DF_mp_UserPages_PageOrder]  DEFAULT ((3)),
	[SiteGuid] [uniqueidentifier] NULL,
 CONSTRAINT [PK_mp_UserPages] PRIMARY KEY CLUSTERED 
(
	[UserPageID] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_SitePersonalizationAllUsers]    Script Date: 11/10/2008 11:37:23 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_SitePersonalizationAllUsers](
	[PathID] [uniqueidentifier] NOT NULL,
	[PageSettings] [image] NOT NULL,
	[LastUpdate] [datetime] NOT NULL CONSTRAINT [DF_mp_PersonalizationAllUsers_LastUpdateDate]  DEFAULT (getdate()),
 CONSTRAINT [PK_mp_PersonalizationAllUsers] PRIMARY KEY CLUSTERED 
(
	[PathID] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_SiteSettingsEx]    Script Date: 11/10/2008 11:37:50 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_SiteSettingsEx](
	[SiteID] [int] NOT NULL,
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[KeyName] [nvarchar](128) NOT NULL,
	[KeyValue] [ntext] NULL,
	[GroupName] [nvarchar](128) NULL,
 CONSTRAINT [PK_mp_SiteSettingsEx] PRIMARY KEY CLUSTERED 
(
	[SiteID] ASC,
	[KeyName] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_SiteSettingsExDef]    Script Date: 11/10/2008 11:37:51 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_SiteSettingsExDef](
	[KeyName] [nvarchar](128) NOT NULL,
	[GroupName] [nvarchar](128) NULL,
	[DefaultValue] [ntext] NULL,
	[SortOrder] [int] NOT NULL,
 CONSTRAINT [PK_mp_SiteSettingsExDef] PRIMARY KEY CLUSTERED 
(
	[KeyName] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_SchemaVersion]    Script Date: 11/10/2008 11:37:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_SchemaVersion](
	[ApplicationID] [uniqueidentifier] NOT NULL,
	[ApplicationName] [nvarchar](255) NOT NULL,
	[Major] [int] NOT NULL CONSTRAINT [DF_mp_SchemaVersion_Major]  DEFAULT ((0)),
	[Minor] [int] NOT NULL CONSTRAINT [DF_mp_SchemaVersion_Minor]  DEFAULT ((0)),
	[Build] [int] NOT NULL CONSTRAINT [DF_mp_SchemaVersion_Build]  DEFAULT ((0)),
	[Revision] [int] NOT NULL CONSTRAINT [DF_mp_SchemaVersion_Revision]  DEFAULT ((0)),
 CONSTRAINT [PK_mp_SchemaVersion] PRIMARY KEY CLUSTERED 
(
	[ApplicationID] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_LetterInfo]    Script Date: 11/10/2008 11:36:20 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_LetterInfo](
	[LetterInfoGuid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_Table_1_InfoGuid]  DEFAULT (newid()),
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[Title] [nvarchar](255) NOT NULL,
	[Description] [ntext] NOT NULL,
	[AvailableToRoles] [ntext] NOT NULL CONSTRAINT [DF_mp_LetterInfo_AvailableToRoles]  DEFAULT ('All Users'),
	[Enabled] [bit] NOT NULL CONSTRAINT [DF_mp_LetterInfo_Enabled]  DEFAULT ((1)),
	[AllowUserFeedback] [bit] NOT NULL CONSTRAINT [DF_mp_LetterInfo_AllowUserFeedback]  DEFAULT ((1)),
	[AllowAnonFeedback] [bit] NOT NULL CONSTRAINT [DF_mp_LetterInfo_AllowAnonFeedback]  DEFAULT ((0)),
	[FromAddress] [nvarchar](255) NOT NULL,
	[FromName] [nvarchar](255) NOT NULL,
	[ReplyToAddress] [nvarchar](255) NOT NULL,
	[SendMode] [int] NOT NULL CONSTRAINT [DF_mp_LetterInfo_SendMode]  DEFAULT ((0)),
	[EnableViewAsWebPage] [bit] NOT NULL CONSTRAINT [DF_mp_LetterInfo_EnableViewAsWebPage]  DEFAULT ((1)),
	[EnableSendLog] [bit] NOT NULL CONSTRAINT [DF_mp_LetterInfo_EnableSendLog]  DEFAULT ((0)),
	[RolesThatCanEdit] [ntext] NOT NULL,
	[RolesThatCanApprove] [ntext] NOT NULL,
	[RolesThatCanSend] [ntext] NOT NULL,
	[SubscriberCount] [int] NOT NULL CONSTRAINT [DF_mp_LetterInfo_SubscriberCount]  DEFAULT ((0)),
	[CreatedUTC] [datetime] NOT NULL CONSTRAINT [DF_mp_LetterInfo_CreatedUTC]  DEFAULT (getutcdate()),
	[CreatedBy] [uniqueidentifier] NOT NULL,
	[LastModUTC] [datetime] NOT NULL CONSTRAINT [DF_mp_LetterInfo_LastModUTC]  DEFAULT (getutcdate()),
	[LastModBy] [uniqueidentifier] NOT NULL,
 CONSTRAINT [PK_mp_LetterInfo] PRIMARY KEY CLUSTERED 
(
	[LetterInfoGuid] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_RedirectList]    Script Date: 11/10/2008 11:37:08 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_RedirectList](
	[RowGuid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_RedirectList_RowGuid]  DEFAULT (newid()),
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[SiteID] [int] NOT NULL,
	[OldUrl] [nvarchar](255) NOT NULL,
	[NewUrl] [nvarchar](255) NOT NULL,
	[CreatedUtc] [datetime] NOT NULL CONSTRAINT [DF_mp_RedirectList_CreatedUtc]  DEFAULT (getutcdate()),
	[ExpireUtc] [datetime] NOT NULL,
 CONSTRAINT [PK_mp_RedirectList] PRIMARY KEY CLUSTERED 
(
	[RowGuid] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_mp_RedirectListOldUrl] ON [dbo].[mp_RedirectList] 
(
	[OldUrl] ASC
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_mp_RedirectListSiteGuid] ON [dbo].[mp_RedirectList] 
(
	[SiteGuid] ASC
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_mp_RedirectListSiteID] ON [dbo].[mp_RedirectList] 
(
	[SiteID] ASC
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_ContentRating]    Script Date: 11/10/2008 11:36:03 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_ContentRating](
	[RowGuid] [uniqueidentifier] NOT NULL,
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[ContentGuid] [uniqueidentifier] NOT NULL,
	[UserGuid] [uniqueidentifier] NOT NULL,
	[EmailAddress] [nvarchar](100) NULL,
	[Rating] [int] NOT NULL,
	[Comments] [ntext] NULL,
	[IpAddress] [nvarchar](50) NULL,
	[CreatedUtc] [datetime] NOT NULL CONSTRAINT [DF_mp_ContentRating_CreatedUtc]  DEFAULT (getutcdate()),
	[LastModUtc] [datetime] NOT NULL CONSTRAINT [DF_mp_ContentRating_LastModUtc]  DEFAULT (getutcdate()),
 CONSTRAINT [PK_mp_ContentRating] PRIMARY KEY CLUSTERED 
(
	[RowGuid] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_mp_ContentRatingContentGuid] ON [dbo].[mp_ContentRating] 
(
	[ContentGuid] ASC
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_mp_ContentRatingIPAddr] ON [dbo].[mp_ContentRating] 
(
	[IpAddress] ASC
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_mp_ContentRatingSiteGuid] ON [dbo].[mp_ContentRating] 
(
	[SiteGuid] ASC
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_mp_ContentRatingUserGuid] ON [dbo].[mp_ContentRating] 
(
	[UserGuid] ASC
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_IndexingQueue]    Script Date: 11/10/2008 11:36:05 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_IndexingQueue](
	[RowId] [bigint] IDENTITY(1,1) NOT NULL,
	[IndexPath] [nvarchar](255) NOT NULL,
	[SerializedItem] [ntext] NOT NULL,
	[ItemKey] [nvarchar](255) NOT NULL,
	[RemoveOnly] [bit] NOT NULL CONSTRAINT [DF_mp_IndexingQueue_RemoveOnly]  DEFAULT ((0)),
 CONSTRAINT [PK_mp_IndexingQueue] PRIMARY KEY CLUSTERED 
(
	[RowId] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_ModuleDefinitionSettings]    Script Date: 11/10/2008 11:36:33 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_ModuleDefinitionSettings](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ModuleDefID] [int] NOT NULL,
	[SettingName] [nvarchar](50) NOT NULL,
	[SettingValue] [nvarchar](255) NOT NULL,
	[ControlType] [nvarchar](50) NULL,
	[RegexValidationExpression] [ntext] NULL,
	[FeatureGuid] [uniqueidentifier] NOT NULL,
	[ResourceFile] [nvarchar](255) NULL,
	[ControlSrc] [nvarchar](255) NULL,
	[SortOrder] [int] NOT NULL DEFAULT ((100)),
	[HelpKey] [nvarchar](255) NULL,
 CONSTRAINT [PK_mp_ModuleDefinitionSettings_1] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
) ON [PRIMARY],
 CONSTRAINT [IX_mp_ModuleDefinitionSettings] UNIQUE NONCLUSTERED 
(
	[ModuleDefID] ASC,
	[SettingName] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_WebParts]    Script Date: 11/10/2008 11:38:40 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_WebParts](
	[WebPartID] [uniqueidentifier] NOT NULL,
	[SiteID] [int] NOT NULL,
	[Title] [nvarchar](255) NOT NULL,
	[Description] [nvarchar](255) NOT NULL,
	[ImageUrl] [nvarchar](255) NULL,
	[ClassName] [nvarchar](255) NOT NULL,
	[AssemblyName] [nvarchar](255) NOT NULL,
	[AvailableForMyPage] [bit] NOT NULL CONSTRAINT [DF_mp_WebParts_AvailableForMyPage]  DEFAULT ((0)),
	[AllowMultipleInstancesOnMyPage] [bit] NOT NULL CONSTRAINT [DF_mp_WebParts_AllowMultipleInstancesOnMyPage]  DEFAULT ((1)),
	[AvailableForContentSystem] [bit] NOT NULL CONSTRAINT [DF_mp_WebParts_AvailableForContentSystem]  DEFAULT ((0)),
	[CountOfUseOnMyPage] [int] NOT NULL CONSTRAINT [DF_mp_WebParts_CountOfUseOnMyPage]  DEFAULT ((0)),
	[SiteGuid] [uniqueidentifier] NULL,
 CONSTRAINT [PK_mp_WebParts] PRIMARY KEY CLUSTERED 
(
	[WebPartID] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_GeoCountry]    Script Date: 11/10/2008 11:35:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_GeoCountry](
	[Guid] [uniqueidentifier] NOT NULL,
	[Name] [nvarchar](255) NOT NULL,
	[ISOCode2] [nchar](2) NOT NULL,
	[ISOCode3] [nchar](3) NOT NULL,
 CONSTRAINT [PK_mp_GeoCountry] PRIMARY KEY NONCLUSTERED 
(
	[Guid] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_UserProperties]    Script Date: 11/10/2008 11:38:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_UserProperties](
	[PropertyID] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_UserProperties_PropertyID]  DEFAULT (newid()),
	[UserGuid] [uniqueidentifier] NOT NULL,
	[PropertyName] [nvarchar](255) NULL,
	[PropertyValueString] [ntext] NULL,
	[PropertyValueBinary] [image] NULL,
	[LastUpdatedDate] [datetime] NOT NULL CONSTRAINT [DF_mp_UserProperties_LastUpdatedDate]  DEFAULT (getdate()),
	[IsLazyLoaded] [bit] NOT NULL CONSTRAINT [DF_mp_UserProperties_IsLazyLoaded]  DEFAULT ((0)),
 CONSTRAINT [PK_mp_UserProperties] PRIMARY KEY CLUSTERED 
(
	[PropertyID] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_Language]    Script Date: 11/10/2008 11:36:06 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_Language](
	[Guid] [uniqueidentifier] NOT NULL,
	[Name] [nvarchar](255) NOT NULL,
	[Code] [nchar](2) NOT NULL,
	[Sort] [int] NOT NULL,
 CONSTRAINT [PK_mp_Language] PRIMARY KEY NONCLUSTERED 
(
	[Guid] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_TaxRateHistory]    Script Date: 11/10/2008 11:38:08 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_TaxRateHistory](
	[Guid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_TaxRateHistory_Guid]  DEFAULT (newid()),
	[TaxRateGuid] [uniqueidentifier] NOT NULL,
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[GeoZoneGuid] [uniqueidentifier] NOT NULL,
	[TaxClassGuid] [uniqueidentifier] NOT NULL,
	[Priority] [int] NOT NULL,
	[Rate] [decimal](18, 4) NOT NULL,
	[Description] [nvarchar](255) NULL,
	[Created] [datetime] NOT NULL,
	[CreatedBy] [uniqueidentifier] NOT NULL,
	[LastModified] [datetime] NULL,
	[ModifiedBy] [uniqueidentifier] NULL,
	[LogTime] [datetime] NOT NULL CONSTRAINT [DF_mp_TaxRateHistory_LogTime]  DEFAULT (getutcdate()),
 CONSTRAINT [PK_mp_TaxRateHx] PRIMARY KEY CLUSTERED 
(
	[Guid] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_PayPalLog]    Script Date: 11/10/2008 11:37:05 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_PayPalLog](
	[RowGuid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_PayPalLog_RowGuid]  DEFAULT (newid()),
	[CreatedUtc] [datetime] NOT NULL CONSTRAINT [DF_mp_PayPalLog_CreatedUtc]  DEFAULT (getutcdate()),
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[UserGuid] [uniqueidentifier] NOT NULL,
	[StoreGuid] [uniqueidentifier] NOT NULL,
	[CartGuid] [uniqueidentifier] NOT NULL,
	[RequestType] [nvarchar](255) NOT NULL,
	[ApiVersion] [nvarchar](50) NULL,
	[RawResponse] [ntext] NULL,
	[Token] [nvarchar](50) NULL,
	[PayerId] [nvarchar](50) NULL,
	[TransactionId] [nvarchar](50) NULL,
	[PaymentType] [nvarchar](10) NULL,
	[PaymentStatus] [nvarchar](50) NULL,
	[PendingReason] [nvarchar](255) NULL,
	[ReasonCode] [nvarchar](50) NULL,
	[CurrencyCode] [nvarchar](50) NULL,
	[ExchangeRate] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_PayPalLog_ExchangeRate]  DEFAULT ((0)),
	[CartTotal] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_PayPalLog_CartTotal]  DEFAULT ((0)),
	[PayPalAmt] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_PayPalLog_PayPalAmt]  DEFAULT ((0)),
	[TaxAmt] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_PayPalLog_TaxAmt]  DEFAULT ((0)),
	[FeeAmt] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_PayPalLog_FeeAmt]  DEFAULT ((0)),
	[SettleAmt] [decimal](15, 4) NOT NULL CONSTRAINT [DF_mp_PayPalLog_SettleAmt]  DEFAULT ((0)),
	[ProviderName] [nvarchar](255) NULL,
	[ReturnUrl] [nvarchar](255) NULL,
	[SerializedObject] [ntext] NULL,
	[PDTProviderName] [nvarchar](255) NULL,
	[IPNProviderName] [nvarchar](255) NULL,
	[Response] [nvarchar](255) NULL,
 CONSTRAINT [PK_mp_PayPalLog] PRIMARY KEY CLUSTERED 
(
	[RowGuid] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_LetterHtmlTemplate]    Script Date: 11/10/2008 11:36:13 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_LetterHtmlTemplate](
	[Guid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_LetterHtmlTemplate_Guid]  DEFAULT (newid()),
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[Title] [nvarchar](255) NOT NULL,
	[Html] [ntext] NOT NULL,
	[LastModUTC] [datetime] NOT NULL CONSTRAINT [DF_mp_LetterHtmlTemplate_LastModUTC]  DEFAULT (getutcdate()),
 CONSTRAINT [PK_mp_LetterHtmlTemplate] PRIMARY KEY CLUSTERED 
(
	[Guid] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_TaxRate]    Script Date: 11/10/2008 11:38:03 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_TaxRate](
	[Guid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_TaxRate_Guid]  DEFAULT (newid()),
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[GeoZoneGuid] [uniqueidentifier] NOT NULL,
	[TaxClassGuid] [uniqueidentifier] NOT NULL,
	[Priority] [int] NOT NULL CONSTRAINT [DF_mp_TaxRate_Priority]  DEFAULT ((1)),
	[Rate] [decimal](18, 4) NOT NULL,
	[Description] [nvarchar](255) NOT NULL,
	[Created] [datetime] NOT NULL CONSTRAINT [DF_mp_TaxRate_Created]  DEFAULT (getutcdate()),
	[CreatedBy] [uniqueidentifier] NOT NULL,
	[LastModified] [datetime] NULL,
	[ModifiedBy] [uniqueidentifier] NULL,
 CONSTRAINT [PK_mp_TaxRate] PRIMARY KEY CLUSTERED 
(
	[Guid] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_SiteModuleDefinitions]    Script Date: 11/10/2008 11:37:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_SiteModuleDefinitions](
	[SiteID] [int] NOT NULL,
	[ModuleDefID] [int] NOT NULL,
	[AuthorizedRoles] [ntext] NULL,
	[SiteGuid] [uniqueidentifier] NULL,
	[FeatureGuid] [uniqueidentifier] NULL,
 CONSTRAINT [PK_mp_SiteModuleDefinitions] PRIMARY KEY CLUSTERED 
(
	[SiteID] ASC,
	[ModuleDefID] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_SitePersonalizationPerUser]    Script Date: 11/10/2008 11:37:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_SitePersonalizationPerUser](
	[ID] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_SitePersonalizationPerUser_ID]  DEFAULT (newid()),
	[PathID] [uniqueidentifier] NOT NULL,
	[UserID] [uniqueidentifier] NOT NULL,
	[PageSettings] [image] NOT NULL,
	[LastUpdate] [datetime] NOT NULL CONSTRAINT [DF_mp_PersonalizationPerUser_LastUpdateDate]  DEFAULT (getdate()),
 CONSTRAINT [PK_mp_PersonalizationPerUser] PRIMARY KEY NONCLUSTERED 
(
	[ID] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_Currency]    Script Date: 11/10/2008 11:36:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_Currency](
	[Guid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_Currency_Guid]  DEFAULT (newid()),
	[Title] [nvarchar](50) NOT NULL,
	[Code] [nchar](3) NOT NULL,
	[SymbolLeft] [nvarchar](15) NULL,
	[SymbolRight] [nvarchar](15) NULL,
	[DecimalPointChar] [nchar](1) NULL,
	[ThousandsPointChar] [nchar](1) NULL,
	[DecimalPlaces] [nchar](1) NULL,
	[Value] [decimal](13, 8) NULL,
	[LastModified] [datetime] NULL,
	[Created] [datetime] NOT NULL CONSTRAINT [DF_mp_Currency_Created]  DEFAULT (getutcdate()),
 CONSTRAINT [PK_mp_Currency] PRIMARY KEY CLUSTERED 
(
	[Guid] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_TaxClass]    Script Date: 11/10/2008 11:38:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_TaxClass](
	[Guid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_TaxClass_Guid]  DEFAULT (newid()),
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[Title] [nvarchar](255) NOT NULL,
	[Description] [ntext] NOT NULL,
	[LastModified] [datetime] NULL,
	[Created] [datetime] NOT NULL CONSTRAINT [DF_mp_TaxClass_Created]  DEFAULT (getutcdate()),
 CONSTRAINT [PK_mp_TaxClass] PRIMARY KEY CLUSTERED 
(
	[Guid] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_UserLocation]    Script Date: 11/10/2008 11:38:14 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_UserLocation](
	[RowID] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_UserLocation_RowID]  DEFAULT (newid()),
	[UserGuid] [uniqueidentifier] NOT NULL,
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[IPAddress] [nvarchar](50) NOT NULL,
	[IPAddressLong] [bigint] NOT NULL CONSTRAINT [DF_mp_UserLocation_IPAddressLong]  DEFAULT ((0)),
	[Hostname] [nvarchar](255) NULL,
	[Longitude] [float] NOT NULL CONSTRAINT [DF_mp_UserLocation_Longitude]  DEFAULT ((0)),
	[Latitude] [float] NOT NULL CONSTRAINT [DF_mp_UserLocation_Latitude]  DEFAULT ((0)),
	[ISP] [nvarchar](255) NULL,
	[Continent] [nvarchar](255) NULL,
	[Country] [nvarchar](255) NULL,
	[Region] [nvarchar](255) NULL,
	[City] [nvarchar](255) NULL,
	[TimeZone] [nvarchar](255) NULL,
	[CaptureCount] [int] NOT NULL CONSTRAINT [DF_mp_UserLocation_CaptureCount]  DEFAULT ((1)),
	[FirstCaptureUTC] [datetime] NOT NULL CONSTRAINT [DF_mp_UserLocation_FirstCaptureUTC]  DEFAULT (getutcdate()),
	[LastCaptureUTC] [datetime] NOT NULL CONSTRAINT [DF_mp_UserLocation_LastCaptureUTC]  DEFAULT (getutcdate()),
 CONSTRAINT [PK_mp_UserLocation] PRIMARY KEY CLUSTERED 
(
	[RowID] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [idxULocateIP] ON [dbo].[mp_UserLocation] 
(
	[IPAddress] ASC
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [idxULocateU] ON [dbo].[mp_UserLocation] 
(
	[UserGuid] ASC
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_UserRoles]    Script Date: 11/10/2008 11:38:21 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_UserRoles](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[UserID] [int] NOT NULL,
	[RoleID] [int] NOT NULL,
	[UserGuid] [uniqueidentifier] NULL,
	[RoleGuid] [uniqueidentifier] NULL,
 CONSTRAINT [PK_mp_UserRoles] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_FriendlyUrls]    Script Date: 11/10/2008 11:35:57 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[mp_FriendlyUrls](
	[UrlID] [int] IDENTITY(1,1) NOT NULL,
	[SiteID] [int] NULL,
	[FriendlyUrl] [varchar](255) NULL,
	[RealUrl] [varchar](255) NULL,
	[IsPattern] [bit] NOT NULL CONSTRAINT [DF_mp_FriendlyUrls_IsPattern]  DEFAULT ((0)),
	[PageGuid] [uniqueidentifier] NULL,
	[SiteGuid] [uniqueidentifier] NULL,
	[ItemGuid] [uniqueidentifier] NULL,
 CONSTRAINT [PK_mp_FriendlyUrls] PRIMARY KEY CLUSTERED 
(
	[UrlID] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
CREATE NONCLUSTERED INDEX [IX_mp_FriendlyUrls] ON [dbo].[mp_FriendlyUrls] 
(
	[FriendlyUrl] ASC
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_TaskQueue]    Script Date: 11/10/2008 11:37:58 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_TaskQueue](
	[Guid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_TaskQueue_Guid]  DEFAULT (newid()),
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[QueuedBy] [uniqueidentifier] NOT NULL,
	[TaskName] [nvarchar](255) NOT NULL,
	[NotifyOnCompletion] [bit] NOT NULL CONSTRAINT [DF_mp_TaskQueue_NotifyOnCompletion]  DEFAULT ((0)),
	[NotificationToEmail] [nvarchar](255) NULL,
	[NotificationFromEmail] [nvarchar](255) NULL,
	[NotificationSubject] [nvarchar](255) NULL,
	[TaskCompleteMessage] [ntext] NULL,
	[NotificationSentUTC] [datetime] NULL,
	[CanStop] [bit] NOT NULL CONSTRAINT [DF_mp_TaskQueue_CanStop]  DEFAULT ((0)),
	[CanResume] [bit] NOT NULL CONSTRAINT [DF_mp_TaskQueue_CanResume]  DEFAULT ((0)),
	[UpdateFrequency] [int] NOT NULL CONSTRAINT [DF_mp_TaskQueue_UpdateFrequency]  DEFAULT ((5)),
	[QueuedUTC] [datetime] NOT NULL,
	[StartUTC] [datetime] NULL,
	[CompleteUTC] [datetime] NULL,
	[LastStatusUpdateUTC] [datetime] NULL,
	[CompleteRatio] [float] NOT NULL CONSTRAINT [DF_mp_TaskQueue_CompleteRatio]  DEFAULT ((0)),
	[Status] [nvarchar](255) NULL,
	[SerializedTaskObject] [ntext] NULL,
	[SerializedTaskType] [nvarchar](255) NULL,
 CONSTRAINT [PK_mp_TaskQueue] PRIMARY KEY CLUSTERED 
(
	[Guid] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_SiteHosts]    Script Date: 11/10/2008 11:37:18 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_SiteHosts](
	[HostID] [int] IDENTITY(1,1) NOT NULL,
	[SiteID] [int] NOT NULL,
	[HostName] [nvarchar](255) NOT NULL,
	[SiteGuid] [uniqueidentifier] NULL,
 CONSTRAINT [PK_mp_SiteHosts] PRIMARY KEY CLUSTERED 
(
	[HostID] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_AuthorizeNetLog]    Script Date: 11/10/2008 11:35:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_AuthorizeNetLog](
	[RowGuid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_AuthorizeNetLog_RowGuid]  DEFAULT (newid()),
	[CreatedUtc] [datetime] NOT NULL CONSTRAINT [DF_mp_AuthorizeNetLog_CreatedUtc]  DEFAULT (getutcdate()),
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[UserGuid] [uniqueidentifier] NOT NULL,
	[StoreGuid] [uniqueidentifier] NOT NULL,
	[CartGuid] [uniqueidentifier] NOT NULL,
	[RawResponse] [ntext] NULL,
	[ResponseCode] [nchar](1) NULL,
	[ResponseReasonCode] [nvarchar](20) NULL,
	[Reason] [ntext] NULL,
	[AvsCode] [nvarchar](50) NULL,
	[CcvCode] [nchar](1) NULL,
	[CavCode] [nchar](1) NULL,
	[TransactionId] [nvarchar](50) NULL,
	[TransactionType] [nvarchar](50) NULL,
	[Method] [nvarchar](20) NULL,
	[AuthCode] [nvarchar](50) NULL,
	[Amount] [decimal](15, 4) NULL,
	[Tax] [decimal](15, 4) NULL,
	[Duty] [decimal](15, 4) NULL,
	[Freight] [decimal](15, 4) NULL,
 CONSTRAINT [PK_mp_AuthorizeNetLog] PRIMARY KEY CLUSTERED 
(
	[RowGuid] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_LetterSendLog]    Script Date: 11/10/2008 11:36:22 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_LetterSendLog](
	[RowID] [int] IDENTITY(1,1) NOT NULL,
	[LetterGuid] [uniqueidentifier] NOT NULL,
	[UserGuid] [uniqueidentifier] NOT NULL,
	[EmailAddress] [nvarchar](100) NULL,
	[UTC] [datetime] NOT NULL CONSTRAINT [DF_mp_LetterSendLog_UTC]  DEFAULT (getutcdate()),
	[ErrorOccurred] [bit] NOT NULL CONSTRAINT [DF_mp_LetterSendLog_ErrorOccurred]  DEFAULT ((0)),
	[ErrorMessage] [ntext] NULL,
 CONSTRAINT [PK_mp_LetterSendLog] PRIMARY KEY CLUSTERED 
(
	[RowID] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_LetterSubscriberHx]    Script Date: 11/10/2008 11:36:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_LetterSubscriberHx](
	[RowID] [int] IDENTITY(1,1) NOT NULL,
	[LetterInfoGuid] [uniqueidentifier] NOT NULL,
	[UserGuid] [uniqueidentifier] NOT NULL,
	[UseHtml] [bit] NOT NULL,
	[BeginUTC] [datetime] NOT NULL,
	[EndUTC] [datetime] NOT NULL CONSTRAINT [DF_mp_LetterSubscriberHx_EndUTC]  DEFAULT (getutcdate()),
 CONSTRAINT [PK_mp_LetterSubscriberHx] PRIMARY KEY CLUSTERED 
(
	[RowID] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_SiteFolders]    Script Date: 11/10/2008 11:37:16 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_SiteFolders](
	[Guid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_SiteFolders_Guid]  DEFAULT (newid()),
	[SiteGuid] [uniqueidentifier] NOT NULL,
	[FolderName] [nvarchar](255) NOT NULL,
 CONSTRAINT [PK_mp_SiteFolders] PRIMARY KEY NONCLUSTERED 
(
	[Guid] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
CREATE CLUSTERED INDEX [IX_mp_SiteFolders] ON [dbo].[mp_SiteFolders] 
(
	[FolderName] ASC
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_PageModules]    Script Date: 11/10/2008 11:36:46 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_PageModules](
	[PageID] [int] NOT NULL,
	[ModuleID] [int] NOT NULL,
	[PaneName] [nvarchar](50) NOT NULL,
	[ModuleOrder] [int] NOT NULL CONSTRAINT [DF_mp_PageModules_ModuleOrder]  DEFAULT ((3)),
	[PublishBeginDate] [datetime] NOT NULL CONSTRAINT [DF_mp_PageModules_PublishBeginDate]  DEFAULT (getdate()),
	[PublishEndDate] [datetime] NULL,
	[PageGuid] [uniqueidentifier] NULL,
	[ModuleGuid] [uniqueidentifier] NULL,
 CONSTRAINT [PK_mp_PageModules] PRIMARY KEY CLUSTERED 
(
	[PageID] ASC,
	[ModuleID] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_SitePaths]    Script Date: 11/10/2008 11:37:21 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_SitePaths](
	[PathID] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_SitePaths_PathID]  DEFAULT (newid()),
	[SiteID] [int] NOT NULL,
	[Path] [nvarchar](255) NOT NULL,
	[LoweredPath] [nvarchar](255) NOT NULL,
	[SiteGuid] [uniqueidentifier] NULL,
 CONSTRAINT [PK_mp_SitePaths] PRIMARY KEY NONCLUSTERED 
(
	[PathID] ASC
) ON [PRIMARY],
 CONSTRAINT [IX_mp_SitePaths] UNIQUE NONCLUSTERED 
(
	[SiteID] ASC,
	[Path] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_SchemaScriptHistory]    Script Date: 11/10/2008 11:37:13 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_SchemaScriptHistory](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ApplicationID] [uniqueidentifier] NOT NULL,
	[ScriptFile] [nvarchar](255) NOT NULL,
	[RunTime] [datetime] NOT NULL CONSTRAINT [DF_mp_SchemaScriptHistory_RunCompletedTime]  DEFAULT (getutcdate()),
	[ErrorOccurred] [bit] NOT NULL CONSTRAINT [DF_mp_SchemaScriptHistory_ErrorOccurred]  DEFAULT ((0)),
	[ErrorMessage] [ntext] NULL,
	[ScriptBody] [ntext] NULL,
 CONSTRAINT [PK_mp_SchemaScriptHistory] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_LetterSubscriber]    Script Date: 11/10/2008 11:36:24 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_LetterSubscriber](
	[LetterInfoGuid] [uniqueidentifier] NOT NULL,
	[UserGuid] [uniqueidentifier] NOT NULL,
	[BeginUTC] [datetime] NOT NULL CONSTRAINT [DF_mp_LetterSubscriber_BeginUTC]  DEFAULT (getutcdate()),
	[UseHtml] [bit] NOT NULL CONSTRAINT [DF_mp_LetterSubscriber_UseHtml]  DEFAULT ((1)),
 CONSTRAINT [PK_mp_LetterSubscriber] PRIMARY KEY CLUSTERED 
(
	[LetterInfoGuid] ASC,
	[UserGuid] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_Letter]    Script Date: 11/10/2008 11:36:11 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_Letter](
	[LetterGuid] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_Letter_LetterGuid]  DEFAULT (newid()),
	[LetterInfoGuid] [uniqueidentifier] NOT NULL,
	[Subject] [nvarchar](255) NOT NULL,
	[HtmlBody] [ntext] NOT NULL,
	[TextBody] [ntext] NOT NULL,
	[CreatedBy] [uniqueidentifier] NOT NULL,
	[CreatedUTC] [datetime] NOT NULL CONSTRAINT [DF_mp_Letter_CreatedUTC]  DEFAULT (getutcdate()),
	[LastModBy] [uniqueidentifier] NOT NULL,
	[LastModUTC] [datetime] NOT NULL CONSTRAINT [DF_mp_Letter_LastModUTC]  DEFAULT (getutcdate()),
	[IsApproved] [bit] NOT NULL,
	[ApprovedBy] [uniqueidentifier] NOT NULL CONSTRAINT [DF_mp_Letter_ApprovedBy]  DEFAULT ('00000000-0000-0000-0000-000000000000'),
	[SendClickedUTC] [datetime] NULL,
	[SendStartedUTC] [datetime] NULL,
	[SendCompleteUTC] [datetime] NULL,
	[SendCount] [int] NOT NULL CONSTRAINT [DF_mp_Letter_SendCount]  DEFAULT ((0)),
 CONSTRAINT [PK_mp_Letter] PRIMARY KEY CLUSTERED 
(
	[LetterGuid] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_ModuleSettings]    Script Date: 11/10/2008 11:36:43 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_ModuleSettings](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ModuleID] [int] NOT NULL,
	[SettingName] [nvarchar](50) NOT NULL,
	[SettingValue] [nvarchar](255) NOT NULL,
	[ControlType] [nvarchar](50) NULL,
	[RegexValidationExpression] [ntext] NULL,
	[SettingGuid] [uniqueidentifier] NULL,
	[ModuleGuid] [uniqueidentifier] NULL,
	[ControlSrc] [nvarchar](255) NULL,
	[SortOrder] [int] NOT NULL DEFAULT ((100)),
	[HelpKey] [nvarchar](255) NULL,
 CONSTRAINT [PK_mp_ModuleSettings] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_HtmlContent]    Script Date: 11/10/2008 11:35:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_HtmlContent](
	[ItemID] [int] IDENTITY(1,1) NOT NULL,
	[ModuleID] [int] NOT NULL,
	[Title] [nvarchar](255) NULL,
	[Excerpt] [ntext] NULL,
	[Body] [ntext] NOT NULL,
	[MoreLink] [nvarchar](255) NULL,
	[SortOrder] [int] NOT NULL CONSTRAINT [DF_mp_HtmlText_SortOrder]  DEFAULT ((500)),
	[BeginDate] [datetime] NOT NULL CONSTRAINT [DF_mp_HtmlText_BeginDate]  DEFAULT (((1)/(1))/(1901)),
	[EndDate] [datetime] NOT NULL CONSTRAINT [DF_mp_HtmlText_EndDate]  DEFAULT (((1)/(1))/(2200)),
	[CreatedDate] [datetime] NULL CONSTRAINT [DF_mp_HtmlText_CreatedDate]  DEFAULT (getdate()),
	[UserID] [int] NULL,
	[ItemGuid] [uniqueidentifier] NULL,
	[ModuleGuid] [uniqueidentifier] NULL,
	[UserGuid] [uniqueidentifier] NULL,
	[LastModUserGuid] [uniqueidentifier] NULL,
	[LastModUtc] [datetime] NULL,
 CONSTRAINT [PK_mp_HtmlText] PRIMARY KEY CLUSTERED 
(
	[ItemID] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_Modules]    Script Date: 11/10/2008 11:36:40 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_Modules](
	[ModuleID] [int] IDENTITY(0,1) NOT NULL,
	[SiteID] [int] NULL,
	[ModuleDefID] [int] NOT NULL,
	[ModuleTitle] [nvarchar](255) NULL,
	[AuthorizedEditRoles] [ntext] NULL,
	[CacheTime] [int] NOT NULL,
	[ShowTitle] [bit] NULL CONSTRAINT [DF_mp_Modules_ShowTitle]  DEFAULT ((1)),
	[EditUserID] [int] NOT NULL CONSTRAINT [DF_mp_Modules_EditUserID]  DEFAULT ((0)),
	[AvailableForMyPage] [bit] NOT NULL CONSTRAINT [DF_mp_Modules_AvailableForMyPage]  DEFAULT ((0)),
	[AllowMultipleInstancesOnMyPage] [bit] NOT NULL CONSTRAINT [DF_mp_Modules_AllowMultipleInstancesOnMyPage]  DEFAULT ((1)),
	[Icon] [nvarchar](255) NULL,
	[CreatedByUserID] [int] NULL CONSTRAINT [DF_mp_Modules_CreatedByUserID]  DEFAULT ((-1)),
	[CreatedDate] [datetime] NULL CONSTRAINT [DF_mp_Modules_CreatedDate]  DEFAULT (getdate()),
	[CountOfUseOnMyPage] [int] NOT NULL CONSTRAINT [DF_mp_Modules_CountOfUseOnMyPage]  DEFAULT ((0)),
	[Guid] [uniqueidentifier] NULL,
	[FeatureGuid] [uniqueidentifier] NULL,
	[SiteGuid] [uniqueidentifier] NULL,
	[EditUserGuid] [uniqueidentifier] NULL,
	[HideFromUnAuth] [bit] NOT NULL DEFAULT ((0)),
	[HideFromAuth] [bit] NOT NULL DEFAULT ((0)),
 CONSTRAINT [PK_Modules] PRIMARY KEY NONCLUSTERED 
(
	[ModuleID] ASC
) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [idxModulesFGuid] ON [dbo].[mp_Modules] 
(
	[FeatureGuid] ASC
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [idxModulesGuid] ON [dbo].[mp_Modules] 
(
	[Guid] ASC
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [idxModulesMDef] ON [dbo].[mp_Modules] 
(
	[ModuleDefID] ASC
) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [idxModulesSID] ON [dbo].[mp_Modules] 
(
	[SiteID] ASC
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mp_GeoZone]    Script Date: 11/10/2008 11:35:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mp_GeoZone](
	[Guid] [uniqueidentifier] NOT NULL,
	[CountryGuid] [uniqueidentifier] NOT NULL,
	[Name] [nvarchar](255) NOT NULL,
	[Code] [nvarchar](255) NOT NULL,
 CONSTRAINT [PK_mp_GeoZone] PRIMARY KEY NONCLUSTERED 
(
	[Guid] ASC
) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  ForeignKey [FK_HtmlText_Modules]    Script Date: 11/10/2008 11:35:42 ******/
ALTER TABLE [dbo].[mp_HtmlContent]  WITH NOCHECK ADD  CONSTRAINT [FK_HtmlText_Modules] FOREIGN KEY([ModuleID])
REFERENCES [dbo].[mp_Modules] ([ModuleID])
ON DELETE CASCADE
NOT FOR REPLICATION
GO
ALTER TABLE [dbo].[mp_HtmlContent] CHECK CONSTRAINT [FK_HtmlText_Modules]
GO
/****** Object:  ForeignKey [FK_mp_GeoZone_mp_GeoCountry]    Script Date: 11/10/2008 11:35:53 ******/
ALTER TABLE [dbo].[mp_GeoZone]  WITH CHECK ADD  CONSTRAINT [FK_mp_GeoZone_mp_GeoCountry] FOREIGN KEY([CountryGuid])
REFERENCES [dbo].[mp_GeoCountry] ([Guid])
GO
ALTER TABLE [dbo].[mp_GeoZone] CHECK CONSTRAINT [FK_mp_GeoZone_mp_GeoCountry]
GO
/****** Object:  ForeignKey [FK_mp_Letter_mp_LetterInfo]    Script Date: 11/10/2008 11:36:11 ******/
ALTER TABLE [dbo].[mp_Letter]  WITH CHECK ADD  CONSTRAINT [FK_mp_Letter_mp_LetterInfo] FOREIGN KEY([LetterInfoGuid])
REFERENCES [dbo].[mp_LetterInfo] ([LetterInfoGuid])
GO
ALTER TABLE [dbo].[mp_Letter] CHECK CONSTRAINT [FK_mp_Letter_mp_LetterInfo]
GO
/****** Object:  ForeignKey [FK_mp_LetterSubscriber_mp_LetterInfo]    Script Date: 11/10/2008 11:36:24 ******/
ALTER TABLE [dbo].[mp_LetterSubscriber]  WITH CHECK ADD  CONSTRAINT [FK_mp_LetterSubscriber_mp_LetterInfo] FOREIGN KEY([LetterInfoGuid])
REFERENCES [dbo].[mp_LetterInfo] ([LetterInfoGuid])
GO
ALTER TABLE [dbo].[mp_LetterSubscriber] CHECK CONSTRAINT [FK_mp_LetterSubscriber_mp_LetterInfo]
GO
/****** Object:  ForeignKey [FK_Modules_ModuleDefinitions]    Script Date: 11/10/2008 11:36:40 ******/
ALTER TABLE [dbo].[mp_Modules]  WITH NOCHECK ADD  CONSTRAINT [FK_Modules_ModuleDefinitions] FOREIGN KEY([ModuleDefID])
REFERENCES [dbo].[mp_ModuleDefinitions] ([ModuleDefID])
ON DELETE CASCADE
NOT FOR REPLICATION
GO
ALTER TABLE [dbo].[mp_Modules] CHECK CONSTRAINT [FK_Modules_ModuleDefinitions]
GO
/****** Object:  ForeignKey [FK_ModuleSettings_Modules]    Script Date: 11/10/2008 11:36:43 ******/
ALTER TABLE [dbo].[mp_ModuleSettings]  WITH NOCHECK ADD  CONSTRAINT [FK_ModuleSettings_Modules] FOREIGN KEY([ModuleID])
REFERENCES [dbo].[mp_Modules] ([ModuleID])
ON DELETE CASCADE
NOT FOR REPLICATION
GO
ALTER TABLE [dbo].[mp_ModuleSettings] CHECK CONSTRAINT [FK_ModuleSettings_Modules]
GO
/****** Object:  ForeignKey [FK_mp_PageModules_mp_Modules]    Script Date: 11/10/2008 11:36:46 ******/
ALTER TABLE [dbo].[mp_PageModules]  WITH CHECK ADD  CONSTRAINT [FK_mp_PageModules_mp_Modules] FOREIGN KEY([ModuleID])
REFERENCES [dbo].[mp_Modules] ([ModuleID])
GO
ALTER TABLE [dbo].[mp_PageModules] CHECK CONSTRAINT [FK_mp_PageModules_mp_Modules]
GO
/****** Object:  ForeignKey [FK_mp_PageModules_mp_PageModules]    Script Date: 11/10/2008 11:36:46 ******/
ALTER TABLE [dbo].[mp_PageModules]  WITH CHECK ADD  CONSTRAINT [FK_mp_PageModules_mp_PageModules] FOREIGN KEY([PageID])
REFERENCES [dbo].[mp_Pages] ([PageID])
GO
ALTER TABLE [dbo].[mp_PageModules] CHECK CONSTRAINT [FK_mp_PageModules_mp_PageModules]
GO
/****** Object:  ForeignKey [FK_Tabs_Portals]    Script Date: 11/10/2008 11:36:57 ******/
ALTER TABLE [dbo].[mp_Pages]  WITH NOCHECK ADD  CONSTRAINT [FK_Tabs_Portals] FOREIGN KEY([SiteID])
REFERENCES [dbo].[mp_Sites] ([SiteID])
ON DELETE CASCADE
NOT FOR REPLICATION
GO
ALTER TABLE [dbo].[mp_Pages] CHECK CONSTRAINT [FK_Tabs_Portals]
GO
/****** Object:  ForeignKey [FK_Roles_Portals]    Script Date: 11/10/2008 11:37:10 ******/
ALTER TABLE [dbo].[mp_Roles]  WITH NOCHECK ADD  CONSTRAINT [FK_Roles_Portals] FOREIGN KEY([SiteID])
REFERENCES [dbo].[mp_Sites] ([SiteID])
ON DELETE CASCADE
NOT FOR REPLICATION
GO
ALTER TABLE [dbo].[mp_Roles] CHECK CONSTRAINT [FK_Roles_Portals]
GO
/****** Object:  ForeignKey [FK_mp_SchemaScriptHistory_mp_SchemaVersion]    Script Date: 11/10/2008 11:37:13 ******/
ALTER TABLE [dbo].[mp_SchemaScriptHistory]  WITH CHECK ADD  CONSTRAINT [FK_mp_SchemaScriptHistory_mp_SchemaVersion] FOREIGN KEY([ApplicationID])
REFERENCES [dbo].[mp_SchemaVersion] ([ApplicationID])
GO
ALTER TABLE [dbo].[mp_SchemaScriptHistory] CHECK CONSTRAINT [FK_mp_SchemaScriptHistory_mp_SchemaVersion]
GO
/****** Object:  ForeignKey [FK_mp_SitePaths_mp_Sites]    Script Date: 11/10/2008 11:37:21 ******/
ALTER TABLE [dbo].[mp_SitePaths]  WITH NOCHECK ADD  CONSTRAINT [FK_mp_SitePaths_mp_Sites] FOREIGN KEY([SiteID])
REFERENCES [dbo].[mp_Sites] ([SiteID])
GO
ALTER TABLE [dbo].[mp_SitePaths] CHECK CONSTRAINT [FK_mp_SitePaths_mp_Sites]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE Function [dbo].[PersianDay](@Date DateTime)

returns bigint

 

as

begin

declare @d1 bigint

set @d1=365

 

declare @d4 bigint

set @d4=4*@d1 +1

 

declare @d33 bigint

set @d33=33*@d1 +8

 

declare @ret bigint

declare @y bigint

declare @m bigint

declare @d bigint

 

set @d=cast(@Date as bigint)+422506

set @y=(@d/@d33)*33+122

set @d=@d % @d33

 

if(@d>(7*@d4+@d1))

Begin

   set @y=@y+1

   set @d=@d-@d1

End

set @y=@y+(@d/@d4)*4

set @d=@d % @d4

 

declare @i bigint

set @i=@d/@d1

set @d=@d%@d1;

if(@i=4)

Begin

   set @i=@i-1

   set @d=@d+@d1

End

set @y=@y+@i

 

if(@d<186)

Begin

   set @m=(@d/31)+1

   set @d=(@d%31)+1

end

Else

Begin

   set @d=@d-186

   set @m=(@d/30)+7

   set @d=(@d%30)+1

End

set @ret=@d

return @ret

end
GO
/****** Object:  UserDefinedFunction [dbo].[PersianMonth]    Script Date: 11/10/2008 11:39:49 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE Function [dbo].[PersianMonth](@Date DateTime)

returns bigint

 

as

begin

declare @d1 bigint

set @d1=365

 

declare @d4 bigint

set @d4=4*@d1 +1

 

declare @d33 bigint

set @d33=33*@d1 +8

 

declare @ret bigint

declare @y bigint

declare @m bigint

declare @d bigint

 

set @d=cast(@Date as bigint)+422506

set @y=(@d/@d33)*33+122

set @d=@d % @d33

 

if(@d>(7*@d4+@d1))

Begin

   set @y=@y+1

   set @d=@d-@d1

End

set @y=@y+(@d/@d4)*4

set @d=@d % @d4

 

declare @i bigint

set @i=@d/@d1

set @d=@d%@d1;

if(@i=4)

Begin

   set @i=@i-1

   set @d=@d+@d1

End

set @y=@y+@i

 

if(@d<186)

Begin

   set @m=(@d/31)+1

   set @d=(@d%31)+1

end

Else

Begin

   set @d=@d-186

   set @m=(@d/30)+7

   set @d=(@d%30)+1

End

set @ret=@m

return @ret

end
GO
/****** Object:  UserDefinedFunction [dbo].[PersianYear]    Script Date: 11/10/2008 11:39:49 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE Function [dbo].[PersianYear](@Date DateTime)

returns bigint

 

as

begin

declare @d1 bigint

set @d1=365

 

declare @d4 bigint

set @d4=4*@d1 +1

 

declare @d33 bigint

set @d33=33*@d1 +8

 

declare @ret bigint

declare @y bigint

declare @m bigint

declare @d bigint

 

set @d=cast(@Date as bigint)+422506

set @y=(@d/@d33)*33+122

set @d=@d % @d33

 

if(@d>(7*@d4+@d1))

Begin

   set @y=@y+1

   set @d=@d-@d1

End

set @y=@y+(@d/@d4)*4

set @d=@d % @d4

 

declare @i bigint

set @i=@d/@d1

set @d=@d%@d1;

if(@i=4)

Begin

   set @i=@i-1

   set @d=@d+@d1

End

set @y=@y+@i

 

if(@d<186)

Begin

   set @m=(@d/31)+1

   set @d=(@d%31)+1

end

Else

Begin

   set @d=@d-186

   set @m=(@d/30)+7

   set @d=(@d%30)+1

End

set @ret=@y

return @ret

end
GO

/****** Object:  StoredProcedure [dbo].[mp_GoogleCheckoutLog_SelectPage]    Script Date: 11/10/2008 11:50:32 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GoogleCheckoutLog_SelectPage]

-- Author:   			
-- Created: 			2008-3-9
-- Last Modified: 		2008-3-9

@StoreGuid		uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
RowGuid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
RowGuid
)

SELECT
		[RowGuid]
		
FROM
		[dbo].[mp_GoogleCheckoutLog]
		
WHERE
		StoreGuid = @StoreGuid

ORDER BY
		CreatedUtc DESC

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_GoogleCheckoutLog] t1

JOIN			#PageIndex t2
ON			
		t1.[RowGuid] = t2.[RowGuid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_PayPalLog_SelectPage]    Script Date: 11/10/2008 11:51:14 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_PayPalLog_SelectPage]

-- Author:   			
-- Created: 			2008-3-9
-- Last Modified: 		2008-3-9

@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

/*
Note: temp tables use the server default for collation not the database default
so if adding character columns be sure and specify to use the database collation like this
to avoid collation errors:

CREATE TABLE #PageIndexForUsers
(
IndexID int IDENTITY (1, 1) NOT NULL,
UserName nvarchar(50) COLLATE DATABASE_DEFAULT,
LoginName nvarchar(50) COLLATE DATABASE_DEFAULT
) 


*/

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
RowGuid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
RowGuid
)

SELECT
		[RowGuid]
		
FROM
		[dbo].[mp_PayPalLog]
		
-- WHERE

-- ORDER BY

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_PayPalLog] t1

JOIN			#PageIndex t2
ON			
		t1.[RowGuid] = t2.[RowGuid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_AuthorizeNetLog_SelectPage]    Script Date: 11/10/2008 11:50:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_AuthorizeNetLog_SelectPage]

-- Author:   			
-- Created: 			2008-3-10
-- Last Modified: 		2008-3-10

@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

/*
Note: temp tables use the server default for collation not the database default
so if adding character columns be sure and specify to use the database collation like this
to avoid collation errors:

CREATE TABLE #PageIndexForUsers
(
IndexID int IDENTITY (1, 1) NOT NULL,
UserName nvarchar(50) COLLATE DATABASE_DEFAULT,
LoginName nvarchar(50) COLLATE DATABASE_DEFAULT
) 


*/

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
RowGuid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
RowGuid
)

SELECT
		[RowGuid]
		
FROM
		[dbo].[mp_AuthorizeNetLog]
		
-- WHERE

-- ORDER BY

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_AuthorizeNetLog] t1

JOIN			#PageIndex t2
ON			
		t1.[RowGuid] = t2.[RowGuid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_GoogleCheckoutLog_SelectPageByCart]    Script Date: 11/10/2008 11:50:33 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GoogleCheckoutLog_SelectPageByCart]

-- Author:   			
-- Created: 			2008-3-9
-- Last Modified: 		2008-3-9

@CartGuid		uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
RowGuid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
RowGuid
)

SELECT
		[RowGuid]
		
FROM
		[dbo].[mp_GoogleCheckoutLog]
		
WHERE
		CartGuid = @CartGuid

ORDER BY
		CreatedUtc DESC

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_GoogleCheckoutLog] t1

JOIN			#PageIndex t2
ON			
		t1.[RowGuid] = t2.[RowGuid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoCountry_SelectPage]    Script Date: 11/10/2008 11:50:27 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoCountry_SelectPage]

-- Author:   			
-- Created: 			2/16/2007
-- Last Modified: 		2/16/2007


@PageNumber 			int,
@PageSize 			int

AS
DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
Guid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
Guid
)

SELECT
		[Guid]
		
FROM
		[dbo].[mp_GeoCountry]
		
-- WHERE

ORDER BY [Name]

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1


SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_GeoCountry] t1

JOIN			#PageIndex t2
ON			
		t1.[Guid] = t2.[Guid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoZone_SelectPage]    Script Date: 11/10/2008 11:50:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoZone_SelectPage]

-- Author:   			
-- Created: 			2/16/2007
-- Last Modified: 		2/16/2007


@PageNumber 			int,
@PageSize 			int

AS
DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
Guid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
Guid
)

SELECT
		t1.[Guid]
		
FROM
		[dbo].[mp_GeoZone] t1

JOIN	mp_GeoCountry t3
ON		t1.CountryGuid = t3.Guid
		
-- WHERE

ORDER BY t3.[Name] asc, t1.[Name] asc

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1


SELECT
		t1.*,
		t3.[Name] As CountryName,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_GeoZone] t1

JOIN			#PageIndex t2
ON			
		t1.[Guid] = t2.[Guid]

JOIN	mp_GeoCountry t3
ON		t1.CountryGuid = t3.Guid
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID
DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_FriendlyUrls_SelectPage]    Script Date: 11/10/2008 11:50:25 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_FriendlyUrls_SelectPage]

-- Author:   			
-- Created: 			2008-6-15
-- Last Modified: 		2008-6-15

@SiteID	int,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1


CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
UrlID Int
)

BEGIN

INSERT INTO #PageIndex ( 
UrlID
)

SELECT
		[UrlID]
		
FROM
		[dbo].[mp_FriendlyUrls]
		
WHERE		SiteID = @SiteID

ORDER BY	FriendlyUrl

END



SELECT
		t1.*
		
FROM
		[dbo].[mp_FriendlyUrls] t1

JOIN			#PageIndex t2
ON			
		t1.[UrlID] = t2.[UrlID]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoZone_SelectPageByCountry]    Script Date: 11/10/2008 11:50:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoZone_SelectPageByCountry]

-- Author:   			
-- Created: 			2/17/2007
-- Last Modified: 		2/17/2007

@CountryGuid		uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS
DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
Guid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
Guid
)

SELECT
		t1.[Guid]
		
FROM
		[dbo].[mp_GeoZone] t1

JOIN	mp_GeoCountry t3
ON		t1.CountryGuid = t3.Guid
		
WHERE	t1.CountryGuid = @CountryGuid

ORDER BY t3.[Name] asc, t1.[Name] asc

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1


SELECT
		t1.*,
		t3.[Name] As CountryName,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_GeoZone] t1

JOIN			#PageIndex t2
ON			
		t1.[Guid] = t2.[Guid]

JOIN	mp_GeoCountry t3
ON		t1.CountryGuid = t3.Guid
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID
GO
/****** Object:  StoredProcedure [dbo].[mp_ContentRating_SelectPageByContent]    Script Date: 11/10/2008 11:50:20 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ContentRating_SelectPageByContent]

-- Author:   			
-- Created: 			2008-10-06
-- Last Modified: 		2008-10-06

@ContentGuid uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1



CREATE TABLE #PageIndex 
(
	[IndexID] int IDENTITY (1, 1) NOT NULL,
	[ItemGuid] UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ([ItemGuid])

SELECT
		[RowGuid]
		
FROM
		[dbo].[mp_ContentRating]
		
WHERE
		[ContentGuid] = @ContentGuid

ORDER BY CreatedUtc DESC

END


SELECT
		t1.*
		
FROM
		[dbo].[mp_ContentRating] t1

JOIN			#PageIndex t2
ON			
		t1.[ItemGuid] = t2.[RowGuid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_Language_SelectPage]    Script Date: 11/10/2008 11:50:39 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Language_SelectPage]

-- Author:   			
-- Created: 			2/17/2007
-- Last Modified: 		2/17/2007

@PageNumber 			int,
@PageSize 			int

AS
DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
Guid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
Guid
)

SELECT
		[Guid]
		
FROM
		[dbo].[mp_Language]
		
-- WHERE

ORDER BY  [Name]

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1


SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_Language] t1

JOIN			#PageIndex t2
ON			
		t1.[Guid] = t2.[Guid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_SelectPage]    Script Date: 11/10/2008 11:51:38 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_SelectPage]

-- Author:   			
-- Created: 			2007-12-29
-- Last Modified: 		2007-12-29

@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1



CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
Guid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
Guid
)

SELECT
		[Guid]
		
FROM
		[dbo].[mp_TaskQueue]
		
-- WHERE

ORDER BY
		[QueuedUTC] DESC

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_TaskQueue] t1

JOIN			#PageIndex t2
ON			
		t1.[Guid] = t2.[Guid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_SelectPageBySite]    Script Date: 11/10/2008 11:51:39 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_SelectPageBySite]

-- Author:   			
-- Created: 			2007-12-29
-- Last Modified: 		2007-12-29

@SiteGuid	uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1



CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
Guid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
Guid
)

SELECT
		[Guid]
		
FROM
		[dbo].[mp_TaskQueue]
		
WHERE
		[SiteGuid] = @SiteGuid

ORDER BY
		[QueuedUTC] DESC

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_TaskQueue] t1

JOIN			#PageIndex t2
ON			
		t1.[Guid] = t2.[Guid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_SelectPageIncompleteBySite]    Script Date: 11/10/2008 11:51:39 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_SelectPageIncompleteBySite]

-- Author:   			
-- Created: 			2007-12-29
-- Last Modified: 		2007-12-29

@SiteGuid	uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1



CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
Guid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
Guid
)

SELECT
		[Guid]
		
FROM
		[dbo].[mp_TaskQueue]
		
WHERE
		[SiteGuid] = @SiteGuid
		AND CompleteUTC IS NULL

ORDER BY
		[QueuedUTC] 

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_TaskQueue] t1

JOIN			#PageIndex t2
ON			
		t1.[Guid] = t2.[Guid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_SelectPageIncomplete]    Script Date: 11/10/2008 11:51:39 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_SelectPageIncomplete]

-- Author:   			
-- Created: 			2007-12-29
-- Last Modified: 		2007-12-29


@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1



CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
Guid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
Guid
)

SELECT
		[Guid]
		
FROM
		[dbo].[mp_TaskQueue]
		
WHERE
		
		CompleteUTC IS NULL

ORDER BY
		[QueuedUTC] 

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_TaskQueue] t1

JOIN			#PageIndex t2
ON			
		t1.[Guid] = t2.[Guid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_UserLocation_SelectPageBySite]    Script Date: 11/10/2008 11:51:48 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserLocation_SelectPageBySite]

-- Author:   			
-- Created: 			2008-1-4
-- Last Modified: 		2008-1-4

@SiteGuid		uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1


CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
RowID UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
RowID
)

SELECT
		[RowID]
		
FROM
		[dbo].[mp_UserLocation]
		
WHERE
		[SiteGuid] = @SiteGuid

ORDER BY
		[IPAddressLong]

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_UserLocation] t1

JOIN			#PageIndex t2
ON			
		t1.[RowID] = t2.[RowID]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_UserLocation_SelectPageByUser]    Script Date: 11/10/2008 11:51:49 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserLocation_SelectPageByUser]

-- Author:   			
-- Created: 			2008-1-4
-- Last Modified: 		2008-1-4

@UserGuid		uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1


CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
RowID UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
RowID
)

SELECT
		[RowID]
		
FROM
		[dbo].[mp_UserLocation]
		
WHERE
		[UserGuid] = @UserGuid

ORDER BY
		[IPAddressLong]

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_UserLocation] t1

JOIN			#PageIndex t2
ON			
		t1.[RowID] = t2.[RowID]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_Modules_SelectPage]    Script Date: 11/10/2008 11:50:59 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Modules_SelectPage]

/*
Author:			
Created:		5/16/2006
Last Modified:	5/20/2006

*/

@SiteID			int,
@PageNumber 	int,
@PageSize 		int,
@SortByModuleType	bit,
@SortByAuthor	bit



AS
DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1



CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
	ModuleID int
)	


 IF @SortByModuleType = 1
	BEGIN
	    	INSERT INTO 	#PageIndex (ModuleID)

	    	SELECT 			m.ModuleID 
			FROM 			mp_Modules m
			JOIN			mp_ModuleDefinitions md
			ON				md.ModuleDefID = m.ModuleDefID
			WHERE 			m.SiteID = @SiteID
							AND md.IsAdmin = 0
				
			ORDER BY 		md.FeatureName, m.ModuleTitle

	END
 Else IF @SortByAuthor = 1
	BEGIN
		INSERT INTO 	#PageIndex (ModuleID)

	    	SELECT 			m.ModuleID 
			FROM 			mp_Modules m
			JOIN			mp_ModuleDefinitions md
			ON				md.ModuleDefID = m.ModuleDefID
			LEFT OUTER JOIN	mp_Users u
			ON				m.CreatedByUserID = u.UserID
			WHERE 			m.SiteID = @SiteID
							AND md.IsAdmin = 0
				
			ORDER BY 		u.[Name], m.ModuleTitle
	END
 ELSE
	BEGIN
	    	INSERT INTO 	#PageIndex (ModuleID)

	    	SELECT 			m.ModuleID 
			FROM 			mp_Modules m
			JOIN			mp_ModuleDefinitions md
			ON				md.ModuleDefID = m.ModuleDefID
			WHERE 			m.SiteID = @SiteID
							AND md.IsAdmin = 0
				
			ORDER BY 		m.ModuleTitle

	END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1


SELECT		m.*,
			md.FeatureName,
			md.ControlSrc,
			md.ResourceFile,
			u.[Name] As CreatedBy,
			'TotalPages' = @TotalPages

FROM			mp_Modules m

JOIN			mp_ModuleDefinitions md
ON				md.ModuleDefID = m.ModuleDefID

LEFT OUTER JOIN	mp_Users u
ON				m.CreatedByUserID = u.UserID

JOIN			#PageIndex p
ON				m.ModuleID = p.ModuleID

WHERE 		
			p.IndexID > @PageLowerBound 
			AND p.IndexID < @PageUpperBound

ORDER BY		p.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_Pages_SelectTreeForModule]    Script Date: 11/10/2008 11:51:09 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Pages_SelectTreeForModule]

/*
Author:			
Created:		5/18/2006
Last Modified:	5/18/2006

*/
        
@SiteID int,
@ModuleID	int

AS
CREATE TABLE #PageTree
(
        [PageID] [int],
        [PageName] [nvarchar] (100),
        [ParentID] [int],
        [PageOrder] [int],
        [NestLevel] [int],
        [TreeOrder] [nvarchar] (1000)
)

SET NOCOUNT ON  
DECLARE @LastLevel smallint
SET @LastLevel = 0
-- First, the parent levels
INSERT INTO     	#PageTree

SELECT  		PageID,
        			PageName,
        			ParentID,
        			PageOrder,
       			0,
        			CAST( 100000000 + PageOrder as nvarchar(20) )

FROM   		mp_Pages

WHERE   		ParentID IS NULL  OR ParentID = -1
			AND SiteID = @SiteID

ORDER BY 		PageOrder

-- Next, the children levels
WHILE (@@rowcount > 0)
BEGIN
  SET @LastLevel = @LastLevel + 1
  INSERT        #PageTree 
	(
		PageID, 
		PageName, 
		ParentID, 
		PageOrder, 
		NestLevel, 
		TreeOrder
	) 
                
    SELECT  	p.PageID,
                        	Replicate('-', @LastLevel *2) + p.PageName,
                        	p.ParentID,
                        	p.PageOrder,
                        	@LastLevel,
                        	CAST(t.TreeOrder as nvarchar) + '.' + CAST(100000000 + p.PageOrder as nvarchar)

      FROM    	mp_Pages p
 
      join 		#PageTree t
      on 		p.ParentID= t.PageID

      WHERE   	EXISTS (SELECT 'X' FROM #PageTree WHERE PageID = p.ParentID AND NestLevel = @LastLevel - 1)
                 	AND SiteID = @SiteID

      ORDER BY 	t.PageOrder


END
--Get the Orphans
  INSERT        	#PageTree 
		(
		PageID, 
		PageName, 
		ParentID, 
		PageOrder, 
		NestLevel, 
		TreeOrder
		) 
                

   SELECT  	p.PageID,
                        	'(Orphan)' + p.PageName,
                        	p.ParentID,
                        	p.PageOrder,
                        	999999999,
                        	'999999999'
                
    FROM    	mp_Pages p 

    WHERE   	NOT EXISTS (SELECT 'X' FROM #PageTree WHERE PageID = p.PageID)
                         	AND SiteID  = @SiteID


-- Reorder the Pages by using a 2nd Temp table and an identity field to keep them straight.
SELECT 	IDENTITY(int,1,2) as ord , 
		CAST(PageID as nvarchar) as PageID 

INTO 		#Pages

FROM 		#PageTree

ORDER BY 	NestLevel, TreeOrder

-- Change the taborder in the sirt temp table so that tabs are ordered in sequence
/*
UPDATE 	#PageTree 

SET 		PageOrder = (SELECT ord FROM #Pages WHERE CAST(#Pages.PageID as int) = #PageTree.PageID) 
*/

-- Return Temporary Table
SELECT 	pt.PageID, 
		pt.ParentID, 
		pt.PageName, 
		pt.PageOrder, 
		pt.NestLevel,
		p.PageTitle,
		p.AuthorizedRoles,
		p.EditRoles,
		p.CreateChildPageRoles,
		'IsPublished' = CONVERT(bit,ISNULL(pm.ModuleID + 1,0)),
		pm.PaneName,
		pm.ModuleOrder,
		pm.PublishBeginDate,
		pm.PublishEndDate

FROM 		#PageTree  pt

JOIN		mp_Pages p
ON		p.PageID = pt.PageID

LEFT OUTER JOIN	mp_PageModules pm
ON		pm.PageID = p.PageID
		AND pm.ModuleID = @ModuleID

ORDER BY 	pt.TreeOrder

DROP TABLE #Pages
DROP TABLE #PageTree
GO
/****** Object:  StoredProcedure [dbo].[mp_SitePersonalizationAdministration_FindState]    Script Date: 11/10/2008 11:51:25 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SitePersonalizationAdministration_FindState] 


@SiteID			int,
@Path 				nvarchar(255) = NULL,
@AllUsersScope 		bit,
@UserID 			uniqueidentifier = NULL,
@InactiveSinceDate 		datetime = NULL,
@PageIndex              		int,
@PageSize               		int



AS

BEGIN
   

    -- Set the page bounds
    DECLARE @PageLowerBound INT
    DECLARE @PageUpperBound INT
    DECLARE @TotalRecords   INT
    SET @PageLowerBound = @PageSize * @PageIndex
    SET @PageUpperBound = @PageSize - 1 + @PageLowerBound

    -- Create a temp table to store the selected results
    CREATE TABLE #PageIndex (
        IndexId int IDENTITY (0, 1) NOT NULL,
        ItemId UNIQUEIDENTIFIER
    )

    IF (@AllUsersScope = 1)
    BEGIN
        -- Insert into our temp table
        INSERT INTO 	#PageIndex (ItemId)

        SELECT 		Paths.PathID
        FROM 		mp_SitePaths Paths,
             			(
			(SELECT 		Paths.PathID
               		FROM 			mp_SitePersonalizationAllUsers AllUsers, mp_SitePaths Paths
               		WHERE 		Paths.SiteID = @SiteID
                      					AND AllUsers.PathID = Paths.PathID
                      					AND (@Path IS NULL OR Paths.LoweredPath LIKE LOWER(@Path))
              			) AS SharedDataPerPath
       			FULL OUTER JOIN
             		 (		SELECT DISTINCT 	Paths.PathID
               			FROM 			mp_SitePersonalizationPerUser PerUser, mp_SitePaths Paths
               			WHERE 		Paths.SiteID = @SiteID
                      						AND PerUser.PathID = Paths.PathID
                      						AND (@Path IS NULL OR Paths.LoweredPath LIKE LOWER(@Path))
              			) AS UserDataPerPath
      			ON SharedDataPerPath.PathID = UserDataPerPath.PathID
             		)

        WHERE 		Paths.PathID = SharedDataPerPath.PathID 
			OR Paths.PathID = UserDataPerPath.PathID

        ORDER BY 	Paths.Path ASC

        SELECT @TotalRecords = @@ROWCOUNT

        SELECT 			Paths.Path,
               			SharedDataPerPath.LastUpdate,
               			SharedDataPerPath.DataSize,
               			UserDataPerPath.UserDataLength,
               			UserDataPerPath.UserCount,
				@TotalRecords As TotalRecords

        FROM 			mp_SitePaths Paths,
             (
		(		SELECT 		PageIndex.ItemId AS PathID,
                      						AllUsers.LastUpdatedDate AS LastUpdatedDate,
                      						DATALENGTH(AllUsers.PageSettings) AS DataSize
               			FROM 			mp_SitePersonalizationAllUsers AllUsers, #PageIndex PageIndex
               			WHERE 		AllUsers.PathID = PageIndex.ItemId
                     						AND PageIndex.IndexId >= @PageLowerBound 
							AND PageIndex.IndexId <= @PageUpperBound
              	) 		AS SharedDataPerPath
              
				FULL OUTER JOIN

              	(		SELECT 		PageIndex.ItemId AS PathID,
                      						SUM(DATALENGTH(PerUser.PageSettings)) AS UserDataLength,
                      						COUNT(*) AS UserCount

               			FROM 			mp_SitePersonalizationPerUser PerUser, #PageIndex PageIndex
               			WHERE 		PerUser.PathID = PageIndex.ItemId
                     						AND PageIndex.IndexId >= @PageLowerBound 
							AND PageIndex.IndexId <= @PageUpperBound

               			GROUP BY 		PageIndex.ItemId

              	) 		AS UserDataPerPath

              			ON SharedDataPerPath.PathID = UserDataPerPath.PathID
             )

        WHERE 			Paths.PathID = SharedDataPerPath.PathID 
				OR Paths.PathID = UserDataPerPath.PathID

        ORDER BY 		Paths.Path ASC

    END
    ELSE
    BEGIN
        -- Insert into our temp table
        INSERT INTO 		#PageIndex (ItemId)

        SELECT 			PerUser.[ID]

        FROM 			mp_SitePersonalizationPerUser PerUser, mp_Users Users, mp_SitePaths Paths

        WHERE 			Paths.SiteID = @SiteID
              			AND PerUser.UserID = Users.UserGuid
              			AND PerUser.PathID = Paths.PathID
              			AND (@Path IS NULL OR Paths.LoweredPath LIKE LOWER(@Path))
				AND (@UserID = '{00000000-0000-0000-0000-000000000000}' OR Users.UserGuid = @UserID)
             
              			AND (@InactiveSinceDate IS NULL OR Users.LastActivityDate <= @InactiveSinceDate)

        ORDER BY 		Paths.Path ASC, Users.LoginName ASC

        SELECT @TotalRecords = @@ROWCOUNT

        SELECT 			Paths.Path, 
				PerUser.LastUpdate, 
				DATALENGTH(PerUser.PageSettings) As DataSize, 
				Users.LoginName, 
				Users.LastActivityDate,
				@TotalRecords As TotalRecords
        
        FROM 			mp_SitePersonalizationPerUser PerUser, mp_Users Users, mp_SitePaths Paths, #PageIndex PageIndex
        
        WHERE 			PerUser.[ID] = PageIndex.ItemId
              			AND PerUser.UserID = Users.UserGuid
              			AND PerUser.PathID = Paths.PathID
              			AND PageIndex.IndexId >= @PageLowerBound 
				AND PageIndex.IndexId <= @PageUpperBound

        ORDER BY 		Paths.Path ASC, Users.LoginName ASC

    END

    --RETURN @TotalRecords
END
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterHtmlTemplate_SelectPage]    Script Date: 11/10/2008 11:50:44 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterHtmlTemplate_SelectPage]

-- Author:   			
-- Created: 			2007-12-27
-- Last Modified: 		2007-12-27

@SiteGuid		uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1



CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
[Guid] UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
Guid
)

SELECT
		[Guid]
		
FROM
		[dbo].[mp_LetterHtmlTemplate]
		
WHERE
	[SiteGuid] = @SiteGuid

ORDER BY
	[Title]

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_LetterHtmlTemplate] t1

JOIN			#PageIndex t2
ON			
		t1.[Guid] = t2.[Guid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SelectPage]    Script Date: 11/10/2008 11:52:00 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_SelectPage]

/*
Author:			
Created:		2004-10-3
Last Modified:	2007-07-14

*/

@PageNumber 			int,
@PageSize 			int,
@UserNameBeginsWith 		nvarchar(50),
@SiteID			int


AS
DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

--SET @PageLowerBound = @PageSize * @PageNumber
--SET @PageUpperBound = @PageLowerBound + @PageSize + 1


CREATE TABLE #PageIndexForUsers 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
	UserName nvarchar(50) COLLATE DATABASE_DEFAULT,
	LoginName nvarchar(50) COLLATE DATABASE_DEFAULT
)	


 IF @UserNameBeginsWith IS NULL OR @UserNameBeginsWith = ''
	BEGIN
	    	INSERT INTO 	#PageIndexForUsers (UserName, LoginName)

	    	SELECT 	[Name], LoginName
		FROM 		mp_Users 
		WHERE 	ProfileApproved = 1
				 AND DisplayInMemberList = 1  
				AND SiteID = @SiteID
				AND IsDeleted = 0
		ORDER BY 	[Name]
	END
ELSE
	BEGIN
	    	INSERT INTO 	#PageIndexForUsers (UserName, LoginName)

	    	SELECT 	[Name] , LoginName
		FROM 		mp_Users 
		WHERE 	ProfileApproved = 1 
				AND DisplayInMemberList = 1  
				AND SiteID = @SiteID
				AND IsDeleted = 0
				AND [Name]  LIKE @UserNameBeginsWith + '%' 
		ORDER BY 	[Name]

	END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndexForUsers)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1


SELECT		*,
			'TotalPages' = @TotalPages

FROM			mp_Users u

JOIN			#PageIndexForUsers p
ON			u.LoginName = p.LoginName

WHERE 		u.ProfileApproved = 1 
			AND u.SiteID = @SiteID
			AND u.IsDeleted = 0
			AND p.IndexID > @PageLowerBound 
			AND p.IndexID < @PageUpperBound

ORDER BY		p.IndexID

DROP TABLE #PageIndexForUsers
GO
/****** Object:  StoredProcedure [dbo].[mp_Letter_SelectPage]    Script Date: 11/10/2008 11:50:42 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Letter_SelectPage]

-- Author:   			
-- Created: 			2007-09-22
-- Last Modified: 		2008-01-08

@LetterInfoGuid uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
LetterGuid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
LetterGuid
)

SELECT
		[LetterGuid]
		
FROM
		[dbo].[mp_Letter]
		
WHERE
		[LetterInfoGuid] = @LetterInfoGuid
		AND [SendClickedUTC] IS NOT NULL

ORDER BY
		[SendClickedUTC] DESC

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_Letter] t1

JOIN			#PageIndex t2
ON			
		t1.[LetterGuid] = t2.[LetterGuid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_Pages_SelectTree]    Script Date: 11/10/2008 11:51:09 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Pages_SelectTree]

/*
Author:			
Created:		11/6/2004
Last Modified:		9/10/2005

*/
        
@SiteID int

AS
CREATE TABLE #PageTree
(
        [PageID] [int],
        [PageName] [nvarchar] (100),
        [ParentID] [int],
        [PageOrder] [int],
        [NestLevel] [int],
        [TreeOrder] [nvarchar] (1000)
)

SET NOCOUNT ON  
DECLARE @LastLevel smallint
SET @LastLevel = 0
-- First, the parent levels
INSERT INTO     	#PageTree

SELECT  		PageID,
        			PageName,
        			ParentID,
        			PageOrder,
       			0,
        			CAST( 100000000 + PageOrder as nvarchar(20) )

FROM   		mp_Pages

WHERE   		ParentID IS NULL  OR ParentID = -1
			AND SiteID = @SiteID

ORDER BY 		PageOrder

-- Next, the children levels
WHILE (@@rowcount > 0)
BEGIN
  SET @LastLevel = @LastLevel + 1
  INSERT        #PageTree 
	(
		PageID, 
		PageName, 
		ParentID, 
		PageOrder, 
		NestLevel, 
		TreeOrder
	) 
                
    SELECT  	p.PageID,
                        	Replicate('-', @LastLevel *2) + p.PageName,
                        	p.ParentID,
                        	p.PageOrder,
                        	@LastLevel,
                        	CAST(t.TreeOrder as nvarchar) + '.' + CAST(100000000 + p.PageOrder as nvarchar)

      FROM    	mp_Pages p
 
      join 		#PageTree t
      on 		p.ParentID= t.PageID

      WHERE   	EXISTS (SELECT 'X' FROM #PageTree WHERE PageID = p.ParentID AND NestLevel = @LastLevel - 1)
                 	AND SiteID = @SiteID

      ORDER BY 	t.PageOrder


END
--Get the Orphans
  INSERT        	#PageTree 
		(
		PageID, 
		PageName, 
		ParentID, 
		PageOrder, 
		NestLevel, 
		TreeOrder
		) 
                

   SELECT  	p.PageID,
                        	'(Orphan)' + p.PageName,
                        	p.ParentID,
                        	p.PageOrder,
                        	999999999,
                        	'999999999'
                
    FROM    	mp_Pages p 

    WHERE   	NOT EXISTS (SELECT 'X' FROM #PageTree WHERE PageID = p.PageID)
                         	AND SiteID  = @SiteID


-- Reorder the Pages by using a 2nd Temp table and an identity field to keep them straight.
SELECT 	IDENTITY(int,1,2) as ord , 
		CAST(PageID as nvarchar) as PageID 

INTO 		#Pages

FROM 		#PageTree

ORDER BY 	NestLevel, TreeOrder

-- Change the taborder in the sirt temp table so that tabs are ordered in sequence
/*
UPDATE 	#PageTree 

SET 		PageOrder = (SELECT ord FROM #Pages WHERE CAST(#Pages.PageID as int) = #PageTree.PageID) 
*/

-- Return Temporary Table
SELECT 	pt.PageID, 
		pt.ParentID, 
		pt.PageName, 
		pt.PageOrder, 
		pt.NestLevel,
		p.PageTitle,
		p.AuthorizedRoles,
		p.EditRoles,
		p.CreateChildPageRoles

FROM 		#PageTree  pt

JOIN		mp_Pages p
ON		p.PageID = pt.PageID

ORDER BY 	pt.TreeOrder

DROP TABLE #Pages
DROP TABLE #PageTree
GO
/****** Object:  StoredProcedure [dbo].[mp_WebParts_SelectPage]    Script Date: 11/10/2008 11:52:07 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_WebParts_SelectPage]

/*
Author:			
Created:		6/7/2006
Last Modified:	6/7/2006

*/

@SiteID			int,
@PageNumber 	int,
@PageSize 		int,
@SortByClassName	bit,
@SortByAssemblyName	bit



AS
DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1



CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
	WebPartID uniqueidentifier
)	


 IF @SortByClassName = 1
	BEGIN
	    	INSERT INTO 	#PageIndex (WebPartID)

	    	SELECT 			w.WebPartID 
			FROM 			mp_WebParts w
			WHERE 			w.SiteID = @SiteID
			ORDER BY 		w.ClassName, w.Title

	END
 Else IF @SortByAssemblyName = 1
	BEGIN
		INSERT INTO 	#PageIndex (WebPartID)

	    	SELECT 			w.WebPartID 
			FROM 			mp_WebParts w
			WHERE 			w.SiteID = @SiteID
			ORDER BY 		w.AssemblyName, w.Title
	END
 ELSE
	BEGIN
	    	INSERT INTO 	#PageIndex (WebPartID)

	    	SELECT 			w.WebPartID 
			FROM 			mp_WebParts w
			WHERE 			w.SiteID = @SiteID
			ORDER BY 		w.Title, w.ClassName

	END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1


SELECT		w.*,
			'TotalPages' = @TotalPages

FROM			mp_WebParts w

JOIN			#PageIndex p
ON				w.WebPartID = p.WebPartID

WHERE 		
			p.IndexID > @PageLowerBound 
			AND p.IndexID < @PageUpperBound

ORDER BY		p.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterInfo_SelectPage]    Script Date: 11/10/2008 11:50:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterInfo_SelectPage]

-- Author:   			
-- Created: 			9/22/2007
-- Last Modified: 		9/22/2007

@SiteGuid		uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
LetterInfoGuid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
LetterInfoGuid
)

SELECT
		[LetterInfoGuid]
		
FROM
		[dbo].[mp_LetterInfo]
		
 WHERE		[SiteGuid] = @SiteGuid

-- ORDER BY

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_LetterInfo] t1

JOIN			#PageIndex t2
ON			
		t1.[LetterInfoGuid] = t2.[LetterInfoGuid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSubscriber_SelectPage]    Script Date: 11/10/2008 11:50:52 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterSubscriber_SelectPage]

-- Author:   			
-- Created: 			9/22/2007
-- Last Modified: 		9/22/2007

@LetterInfoGuid			uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
LetterInfoGuid uniqueidentifier,
UserGuid uniqueidentifier
)

BEGIN

INSERT INTO #PageIndex ( 
LetterInfoGuid, UserGuid
)

SELECT
		ls.[LetterInfoGuid],
		ls.[UserGuid]
		
FROM
		[dbo].[mp_LetterSubscriber] ls

JOIN		mp_Users u
ON		ls.UserGuid = u.UserGuid
		
WHERE		ls.[LetterInfoGuid] = @LetterInfoGuid

ORDER BY	u.[Name]

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		u.[Name],
		u.[Email],
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_LetterSubscriber] t1
		
JOIN		mp_Users u
ON		t1.UserGuid = u.UserGuid

JOIN			#PageIndex t2
ON			
		t1.[UserGuid] = t2.[UserGuid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_Letter_SelectDraftsPage]    Script Date: 11/10/2008 11:50:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Letter_SelectDraftsPage]

-- Author:   			
-- Created: 			2007-12-12
-- Last Modified: 		2007-12-12

@LetterInfoGuid uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
LetterGuid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
LetterGuid
)

SELECT
		[LetterGuid]
		
FROM
		[dbo].[mp_Letter]
		
WHERE
		[LetterInfoGuid] = @LetterInfoGuid
		AND [SendClickedUTC] IS NULL

ORDER BY
	[CreatedUTC]

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_Letter] t1

JOIN			#PageIndex t2
ON			
		t1.[LetterGuid] = t2.[LetterGuid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSendLog_SelectPage]    Script Date: 11/10/2008 11:50:50 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterSendLog_SelectPage]

-- Author:   			
-- Created: 			2008-1-8
-- Last Modified: 		2008-1-8

@LetterGuid		uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
RowID Int
)

BEGIN

INSERT INTO #PageIndex ( 
RowID
)

SELECT
		[RowID]
		
FROM
		[dbo].[mp_LetterSendLog]
		
WHERE
		[LetterGuid] = @LetterGuid

ORDER BY
		[EmailAddress]

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1

SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_LetterSendLog] t1

JOIN			#PageIndex t2
ON			
		t1.[RowID] = t2.[RowID]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_BannedIPAddresses_SelectPage]    Script Date: 11/10/2008 11:50:18 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_BannedIPAddresses_SelectPage]

-- Author:   			
-- Created: 			9/22/2007
-- Last Modified: 		9/22/2007

-- need to modify this before using it, thats why its commented out



-- add criteria input params
@PageNumber 			int,
@PageSize 			int

AS

DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
RowID Int
)

BEGIN

INSERT INTO #PageIndex ( 
RowID
)

SELECT
		[RowID]
		
FROM
		[dbo].[mp_BannedIPAddresses]
		
-- WHERE

ORDER BY	[BannedIP]

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1


SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_BannedIPAddresses] t1

JOIN			#PageIndex t2
ON			
		t1.[RowID] = t2.[RowID]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_TaxClass_SelectPage]    Script Date: 11/10/2008 11:51:42 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_TaxClass_SelectPage]

-- Author:   			
-- Created: 			2/17/2007
-- Last Modified: 		2/17/2007

@SiteGuid		uniqueidentifier,
@PageNumber 			int,
@PageSize 			int

AS
DECLARE @PageLowerBound int
DECLARE @PageUpperBound int


SET @PageLowerBound = (@PageSize * @PageNumber) - @PageSize
SET @PageUpperBound = @PageLowerBound + @PageSize + 1

CREATE TABLE #PageIndex 
(
	IndexID int IDENTITY (1, 1) NOT NULL,
Guid UniqueIdentifier
)

BEGIN

INSERT INTO #PageIndex ( 
Guid
)

SELECT
		[Guid]
		
FROM
		[dbo].[mp_TaxClass]
		
WHERE [SiteGuid] = @SiteGuid

ORDER BY [Title]

END

DECLARE @TotalRows int
DECLARE @TotalPages int
DECLARE @Remainder int

SET @TotalRows = (SELECT Count(*) FROM #PageIndex)
SET @TotalPages = @TotalRows / @PageSize
SET @Remainder = @TotalRows % @PageSize
IF @Remainder > 0 
SET @TotalPages = @TotalPages + 1


SELECT
		t1.*,
		'TotalPages' = @TotalPages
		
FROM
		[dbo].[mp_TaxClass] t1

JOIN			#PageIndex t2
ON			
		t1.[Guid] = t2.[Guid]
		
WHERE
		t2.IndexID > @PageLowerBound 
		AND t2.IndexID < @PageUpperBound
		
ORDER BY t2.IndexID

DROP TABLE #PageIndex
GO
/****** Object:  StoredProcedure [dbo].[mp_BannedIPAddresses_Exists]    Script Date: 11/10/2008 11:50:17 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_BannedIPAddresses_Exists]

/*
Author:   			
Created: 			2008-08-13
Last Modified: 		2008-08-13
*/

@BannedIP nvarchar(50)

AS

SELECT COUNT(*) 
FROM [dbo].[mp_BannedIPAddresses]
WHERE BannedIP = @BannedIP
GO
/****** Object:  StoredProcedure [dbo].[mp_BannedIPAddresses_SelectOne]    Script Date: 11/10/2008 11:50:18 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_BannedIPAddresses_SelectOne]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@RowID int

AS


SELECT
		[RowID],
		[BannedIP],
		[BannedUTC],
		[BannedReason]
		
FROM
		[dbo].[mp_BannedIPAddresses]
		
WHERE
		[RowID] = @RowID
GO
/****** Object:  StoredProcedure [dbo].[mp_BannedIPAddresses_Delete]    Script Date: 11/10/2008 11:50:17 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_BannedIPAddresses_Delete]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@RowID int

AS

DELETE FROM [dbo].[mp_BannedIPAddresses]
WHERE
	[RowID] = @RowID
GO
/****** Object:  StoredProcedure [dbo].[mp_BannedIPAddresses_Insert]    Script Date: 11/10/2008 11:50:17 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_BannedIPAddresses_Insert]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@BannedIP nvarchar(50),
@BannedUTC datetime,
@BannedReason nvarchar(255)

	
AS

INSERT INTO 	[dbo].[mp_BannedIPAddresses] 
(
				[BannedIP],
				[BannedUTC],
				[BannedReason]
) 

VALUES 
(
				@BannedIP,
				@BannedUTC,
				@BannedReason
				
)
SELECT @@IDENTITY
GO
/****** Object:  StoredProcedure [dbo].[mp_BannedIPAddresses_SelectAll]    Script Date: 11/10/2008 11:50:17 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_BannedIPAddresses_SelectAll]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

AS


SELECT
		[RowID],
		[BannedIP],
		[BannedUTC],
		[BannedReason]
		
FROM
		[dbo].[mp_BannedIPAddresses]
GO
/****** Object:  StoredProcedure [dbo].[mp_BannedIPAddresses_Update]    Script Date: 11/10/2008 11:50:18 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_BannedIPAddresses_Update]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/
	
@RowID int, 
@BannedIP nvarchar(50), 
@BannedUTC datetime, 
@BannedReason nvarchar(255) 


AS

UPDATE 		[dbo].[mp_BannedIPAddresses] 

SET
			[BannedIP] = @BannedIP,
			[BannedUTC] = @BannedUTC,
			[BannedReason] = @BannedReason
			
WHERE
			[RowID] = @RowID
GO
/****** Object:  StoredProcedure [dbo].[mp_BannedIPAddresses_GetCount]    Script Date: 11/10/2008 11:50:17 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_BannedIPAddresses_GetCount]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

AS

SELECT COUNT(*) FROM [dbo].[mp_BannedIPAddresses]
GO
/****** Object:  StoredProcedure [dbo].[mp_Sites_Delete]    Script Date: 11/10/2008 11:51:27 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Sites_Delete]

/*
Author:   			
Created: 			2005-03-07
Last Modified: 		2008-11-12

*/

@SiteID int

AS


DELETE FROM mp_WebParts WHERE SiteID = @SiteID

DELETE FROM mp_PageModules
WHERE PageID IN (SELECT PageID FROM mp_Pages WHERE SiteID = @SiteID)

DELETE FROM mp_ModuleSettings
WHERE ModuleID IN (SELECT ModuleID FROM mp_Modules WHERE SiteID = @SiteID)


DELETE FROM mp_Modules WHERE SiteID = @SiteID

DELETE FROM mp_SiteModuleDefinitions WHERE SiteID = @SiteID


DELETE FROM mp_UserProperties
WHERE UserGuid IN (SELECT UserGuid FROM mp_Users WHERE SiteID = @SiteID)

DELETE FROM mp_UserRoles
WHERE UserID IN (SELECT UserID FROM mp_Users WHERE SiteID = @SiteID)

DELETE FROM mp_UserLocation 
WHERE UserGuid IN (SELECT UserGuid FROM mp_Users WHERE SiteID = @SiteID)

DELETE FROM mp_FriendlyUrls WHERE SiteID = @SiteID

DELETE FROM mp_UserPages WHERE SiteID = @SiteID

DELETE FROM mp_Users WHERE SiteID = @SiteID

DELETE FROM mp_Pages WHERE SiteID = @SiteID

DELETE FROM mp_Roles WHERE SiteID = @SiteID

DELETE FROM mp_SiteHosts WHERE SiteID = @SiteID

DELETE FROM mp_SiteSettingsEx WHERE SiteID = @SiteID

DELETE FROM mp_SitePersonalizationAllUsers
WHERE PathID IN (SELECT PathID FROM mp_SitePaths WHERE SiteID = @SiteID)

DELETE FROM mp_SitePersonalizationPerUser
WHERE PathID IN (SELECT PathID FROM mp_SitePaths WHERE SiteID = @SiteID)

DELETE FROM mp_SitePaths WHERE SiteID = @SiteID

DELETE FROM mp_SiteFolders
WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID)

DELETE FROM mp_AuthorizeNetLog
WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID)

DELETE FROM mp_GoogleCheckoutLog
WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID)

DELETE FROM mp_LetterSendLog
WHERE LetterGuid IN (SELECT LetterGuid FROM mp_Letter
					WHERE LetterInfoGuid IN (SELECT LetterInfoGuid 
						FROM mp_LetterInfo
						WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID)))

DELETE FROM mp_LetterSubscriberHx
WHERE LetterInfoGuid IN (SELECT LetterInfoGuid 
						FROM mp_LetterInfo
						WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID))

DELETE FROM mp_LetterSubscriber
WHERE LetterInfoGuid IN (SELECT LetterInfoGuid 
						FROM mp_LetterInfo
						WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID))



DELETE FROM mp_Letter
WHERE LetterInfoGuid IN (SELECT LetterInfoGuid 
						FROM mp_LetterInfo
						WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID))

DELETE FROM mp_LetterHtmlTemplate
WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID)

DELETE FROM mp_LetterInfo
WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID)

DELETE FROM mp_PayPalLog
WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID)

DELETE FROM mp_RedirectList
WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID)

DELETE FROM mp_TaskQueue
WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID)

DELETE FROM mp_TaxClass
WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID)

DELETE FROM mp_TaxRateHistory
WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID)

DELETE FROM mp_TaxRate
WHERE SiteGuid IN (SELECT SiteGuid FROM mp_Sites WHERE SiteID = @SiteID)



DELETE FROM [dbo].[mp_Sites]
WHERE
	[SiteID] = @SiteID
GO
/****** Object:  StoredProcedure [dbo].[mp_GoogleCheckoutLog_Delete]    Script Date: 11/10/2008 11:50:29 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GoogleCheckoutLog_Delete]

/*
Author:   			
Created: 			2008-3-9
Last Modified: 		2008-3-9
*/

@RowGuid uniqueidentifier

AS

DELETE FROM [dbo].[mp_GoogleCheckoutLog]
WHERE
	[RowGuid] = @RowGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_GoogleCheckoutLog_SelectMostRecentByOrder]    Script Date: 11/10/2008 11:50:32 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GoogleCheckoutLog_SelectMostRecentByOrder]

/*
Author:   			
Created: 			2008-3-9
Last Modified: 		2008-3-25
*/

@OrderNumber nvarchar(50)

AS


SELECT TOP 1 *
		
FROM
		[dbo].[mp_GoogleCheckoutLog]
		
WHERE
		[OrderNumber] = @OrderNumber
		AND CartGuid <> '00000000-0000-0000-0000-000000000000'
		AND NotificationType = 'NewOrderNotification'
		
ORDER BY
		CreatedUtc desc
GO
/****** Object:  StoredProcedure [dbo].[mp_GoogleCheckoutLog_SelectOne]    Script Date: 11/10/2008 11:50:32 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GoogleCheckoutLog_SelectOne]

/*
Author:   			
Created: 			2008-3-9
Last Modified: 		2008-3-9
*/

@RowGuid uniqueidentifier

AS


SELECT
		*
		
FROM
		[dbo].[mp_GoogleCheckoutLog]
		
WHERE
		[RowGuid] = @RowGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_GoogleCheckoutLog_GetCount]    Script Date: 11/10/2008 11:50:30 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GoogleCheckoutLog_GetCount]

/*
Author:   			
Created: 			2008-3-9
Last Modified: 		2008-3-9
*/

@StoreGuid uniqueidentifier


AS

SELECT COUNT(*) FROM [dbo].[mp_GoogleCheckoutLog]

WHERE StoreGuid = @StoreGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_GoogleCheckoutLog_Update]    Script Date: 11/10/2008 11:50:34 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GoogleCheckoutLog_Update]

/*
Author:   			
Created: 			2008-3-9
Last Modified: 		2008-4-4
*/
	
@RowGuid uniqueidentifier, 
@CreatedUtc datetime, 
@SiteGuid uniqueidentifier, 
@UserGuid uniqueidentifier, 
@StoreGuid uniqueidentifier, 
@CartGuid uniqueidentifier, 
@NotificationType nvarchar(255), 
@RawResponse ntext, 
@SerialNumber nvarchar(50), 
@GTimestamp datetime, 
@OrderNumber nvarchar(50), 
@BuyerId nvarchar(50), 
@FullfillState nvarchar(50), 
@FinanceState nvarchar(50), 
@EmailListOptIn bit, 
@AvsResponse nvarchar(5), 
@CvnResponse nvarchar(5), 
@AuthExpDate datetime, 
@AuthAmt decimal(15, 4), 
@DiscountTotal decimal(15, 4), 
@ShippingTotal decimal(15, 4), 
@TaxTotal decimal(15, 4), 
@OrderTotal decimal(15, 4), 
@LatestChgAmt decimal(15, 4), 
@TotalChgAmt decimal(15, 4), 
@LatestRefundAmt decimal(15, 4), 
@TotalRefundAmt decimal(15, 4), 
@LatestChargeback decimal(15, 4), 
@TotalChargeback decimal(15, 4),
@CartXml ntext


AS

UPDATE 		[dbo].[mp_GoogleCheckoutLog] 

SET
			[CreatedUtc] = @CreatedUtc,
			[SiteGuid] = @SiteGuid,
			[UserGuid] = @UserGuid,
			[StoreGuid] = @StoreGuid,
			[CartGuid] = @CartGuid,
			[NotificationType] = @NotificationType,
			[RawResponse] = @RawResponse,
			[SerialNumber] = @SerialNumber,
			[GTimestamp] = @GTimestamp,
			[OrderNumber] = @OrderNumber,
			[BuyerId] = @BuyerId,
			[FullfillState] = @FullfillState,
			[FinanceState] = @FinanceState,
			[EmailListOptIn] = @EmailListOptIn,
			[AvsResponse] = @AvsResponse,
			[CvnResponse] = @CvnResponse,
			[AuthExpDate] = @AuthExpDate,
			[AuthAmt] = @AuthAmt,
			[DiscountTotal] = @DiscountTotal,
			[ShippingTotal] = @ShippingTotal,
			[TaxTotal] = @TaxTotal,
			[OrderTotal] = @OrderTotal,
			[LatestChgAmt] = @LatestChgAmt,
			[TotalChgAmt] = @TotalChgAmt,
			[LatestRefundAmt] = @LatestRefundAmt,
			[TotalRefundAmt] = @TotalRefundAmt,
			[LatestChargeback] = @LatestChargeback,
			[TotalChargeback] = @TotalChargeback,
			[CartXml] = @CartXml
			
WHERE
			[RowGuid] = @RowGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_GoogleCheckoutLog_SelectAll]    Script Date: 11/10/2008 11:50:32 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GoogleCheckoutLog_SelectAll]

/*
Author:   			
Created: 			2008-3-9
Last Modified: 		2008-3-9
*/

AS


SELECT
		*
		
FROM
		[dbo].[mp_GoogleCheckoutLog]
GO
/****** Object:  StoredProcedure [dbo].[mp_GoogleCheckoutLog_Insert]    Script Date: 11/10/2008 11:50:31 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GoogleCheckoutLog_Insert]

/*
Author:   			
Created: 			2008-3-9
Last Modified: 		2008-4-4
*/

@RowGuid uniqueidentifier,
@CreatedUtc datetime,
@SiteGuid uniqueidentifier,
@UserGuid uniqueidentifier,
@StoreGuid uniqueidentifier,
@CartGuid uniqueidentifier,
@NotificationType nvarchar(255),
@RawResponse ntext,
@SerialNumber nvarchar(50),
@GTimestamp datetime,
@OrderNumber nvarchar(50),
@BuyerId nvarchar(50),
@FullfillState nvarchar(50),
@FinanceState nvarchar(50),
@EmailListOptIn bit,
@AvsResponse nvarchar(5),
@CvnResponse nvarchar(5),
@AuthExpDate datetime,
@AuthAmt decimal(15, 4),
@DiscountTotal decimal(15, 4),
@ShippingTotal decimal(15, 4),
@TaxTotal decimal(15, 4),
@OrderTotal decimal(15, 4),
@LatestChgAmt decimal(15, 4),
@TotalChgAmt decimal(15, 4),
@LatestRefundAmt decimal(15, 4),
@TotalRefundAmt decimal(15, 4),
@LatestChargeback decimal(15, 4),
@TotalChargeback decimal(15, 4),
@CartXml ntext,
@ProviderName nvarchar(255)

	
AS

INSERT INTO 	[dbo].[mp_GoogleCheckoutLog] 
(
				[RowGuid],
				[CreatedUtc],
				[SiteGuid],
				[UserGuid],
				[StoreGuid],
				[CartGuid],
				[NotificationType],
				[RawResponse],
				[SerialNumber],
				[GTimestamp],
				[OrderNumber],
				[BuyerId],
				[FullfillState],
				[FinanceState],
				[EmailListOptIn],
				[AvsResponse],
				[CvnResponse],
				[AuthExpDate],
				[AuthAmt],
				[DiscountTotal],
				[ShippingTotal],
				[TaxTotal],
				[OrderTotal],
				[LatestChgAmt],
				[TotalChgAmt],
				[LatestRefundAmt],
				[TotalRefundAmt],
				[LatestChargeback],
				[TotalChargeback],
				[CartXml],
				ProviderName
) 

VALUES 
(
				@RowGuid,
				@CreatedUtc,
				@SiteGuid,
				@UserGuid,
				@StoreGuid,
				@CartGuid,
				@NotificationType,
				@RawResponse,
				@SerialNumber,
				@GTimestamp,
				@OrderNumber,
				@BuyerId,
				@FullfillState,
				@FinanceState,
				@EmailListOptIn,
				@AvsResponse,
				@CvnResponse,
				@AuthExpDate,
				@AuthAmt,
				@DiscountTotal,
				@ShippingTotal,
				@TaxTotal,
				@OrderTotal,
				@LatestChgAmt,
				@TotalChgAmt,
				@LatestRefundAmt,
				@TotalRefundAmt,
				@LatestChargeback,
				@TotalChargeback,
				@CartXml,
				@ProviderName
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_GoogleCheckoutLog_GetCountByCart]    Script Date: 11/10/2008 11:50:30 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GoogleCheckoutLog_GetCountByCart]

/*
Author:   			
Created: 			2008-3-9
Last Modified: 		2008-3-9
*/

@CartGuid uniqueidentifier


AS

SELECT COUNT(*) FROM [dbo].[mp_GoogleCheckoutLog]

WHERE CartGuid = @CartGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_SitePaths_CreatePath]    Script Date: 11/10/2008 11:51:24 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SitePaths_CreatePath]

@SiteGuid		uniqueidentifier,
@SiteID	int,
@Path           nvarchar(255),
@PathID         UNIQUEIDENTIFIER OUTPUT

AS

BEGIN
    BEGIN TRANSACTION
    IF (NOT EXISTS(SELECT * FROM mp_SitePaths WHERE LoweredPath = LOWER(@Path) AND SiteID = @SiteID))
    BEGIN
        INSERT mp_SitePaths 
(
SiteGuid,
SiteID, 
[Path], 
LoweredPath) 
VALUES 
(
@SiteGuid,
@SiteID, 
@Path, 
LOWER(@Path)
)
    END
    COMMIT TRANSACTION
    SELECT @PathID = PathID FROM mp_SitePaths WHERE LOWER(@Path) = LoweredPath AND SiteID = @SiteID
END
GO
/****** Object:  StoredProcedure [dbo].[mp_SitePersonalizationPerUser_GetPageSettings]    Script Date: 11/10/2008 11:51:26 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SitePersonalizationPerUser_GetPageSettings] 
(
   
@SiteID		int,
@Path             	NVARCHAR(255),
@UserID        	UNIQUEIDENTIFIER


)

AS
BEGIN
   
    DECLARE @PathID UNIQUEIDENTIFIER
    SELECT @PathID = NULL
    
    SELECT @PathID = u.PathID 
    FROM mp_SitePaths u WHERE u.SiteID = @SiteID AND u.LoweredPath = LOWER(@Path)
    IF (@PathID IS NULL)
    BEGIN
        RETURN
    END


    SELECT p.PageSettings 
	FROM mp_SitePersonalizationPerUser p 
	WHERE p.PathID = @PathId AND p.UserID = @UserID

END
GO
/****** Object:  StoredProcedure [dbo].[mp_SitePersonalizationPerUser_ResetPageSettings]    Script Date: 11/10/2008 11:51:26 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SitePersonalizationPerUser_ResetPageSettings]
 (
    @SiteID		int,
    @Path             	NVARCHAR(255),
    @UserID        	UNIQUEIDENTIFIER

)
AS
BEGIN
    
    DECLARE @PathID UNIQUEIDENTIFIER
    SELECT @PathID = NULL
   

    SELECT @PathID = u.PathID FROM mp_SitePaths u WHERE u.SiteID = @SiteID AND u.LoweredPath = LOWER(@Path)
    IF (@PathID IS NULL)
    BEGIN
        RETURN
    END


    DELETE FROM mp_SitePersonalizationPerUser WHERE PathID = @PathId AND UserID = @UserID
    RETURN 0
END
GO
/****** Object:  StoredProcedure [dbo].[mp_SitePersonalizationAllUsers_GetPageSettings]    Script Date: 11/10/2008 11:51:26 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SitePersonalizationAllUsers_GetPageSettings] 
(
    
@SiteID	int,
@Path              nvarchar(255)

)

AS

BEGIN
    
    DECLARE @PathID UNIQUEIDENTIFIER

    SELECT @PathID = NULL

   
    SELECT @PathID = u.PathID FROM mp_SitePaths u WHERE u.SiteID = @SiteID AND u.LoweredPath = LOWER(@Path)
    IF (@PathID IS NULL)
    BEGIN
        RETURN
    END

    SELECT p.PageSettings FROM mp_SitePersonalizationAllUsers p WHERE p.PathID = @PathID
END
GO
/****** Object:  StoredProcedure [dbo].[mp_SitePersonalizationAdministration_GetCountOfState]    Script Date: 11/10/2008 11:51:25 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SitePersonalizationAdministration_GetCountOfState] 

@SiteID		int,
@Path 			nvarchar(255) = NULL,
@AllUsersScope 	bit,
@UserID 		uniqueidentifier ,
@InactiveSinceDate 	datetime = NULL


AS

BEGIN

    
        IF (@AllUsersScope = 1)
            SELECT 		COUNT(*)
            FROM 			mp_SitePersonalizationAllUsers spa
	JOIN			mp_SitePaths sp
	ON 			spa.PathID = sp.PathID
            	WHERE 		sp.SiteID = @SiteID
                  			AND (@Path IS NULL OR sp.LoweredPath LIKE LOWER(@Path))
        ELSE
            	SELECT 		COUNT(*)
            	FROM 			mp_SitePersonalizationPerUser spu
	JOIN	 		mp_SitePaths sp
	ON 			spu.PathID = sp.PathID
	LEFT OUTER JOIN	mp_Users u
	ON 			spu.UserID = u.UserGuid

            WHERE 		sp.SiteID = @SiteID
                  			AND (@Path IS NULL OR sp.LoweredPath LIKE LOWER(@Path))
                  			AND (@UserID = '{00000000-0000-0000-0000-000000000000}' OR u.UserGuid = @UserID)
                 			 AND (@InactiveSinceDate IS NULL OR u.LastActivityDate <= @InactiveSinceDate)
END
GO
/****** Object:  StoredProcedure [dbo].[mp_UserPages_SelectOne]    Script Date: 11/10/2008 11:51:51 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserPages_SelectOne]

/*
Author:   			
Created: 			6/12/2006
Last Modified: 		6/12/2006
*/

@UserPageID uniqueidentifier

AS
SELECT
		*
		
FROM
		[dbo].[mp_UserPages]
		
WHERE
		[UserPageID] = @UserPageID
GO
/****** Object:  StoredProcedure [dbo].[mp_UserPages_Delete]    Script Date: 11/10/2008 11:51:50 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserPages_Delete]

/*
Author:   			
Created: 			6/12/2006
Last Modified: 		6/12/2006
*/

@UserPageID uniqueidentifier

AS

DELETE FROM [dbo].[mp_UserPages]
WHERE
	[UserPageID] = @UserPageID
GO
/****** Object:  StoredProcedure [dbo].[mp_UserPages_SelectByUser]    Script Date: 11/10/2008 11:51:51 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserPages_SelectByUser]

/*
Author:   			
Created: 			6/12/2006
Last Modified: 		6/12/2006
*/

@UserGuid uniqueidentifier

AS


SELECT
		*
		
FROM
		[dbo].[mp_UserPages]
		
WHERE
		[UserGuid] = @UserGuid

ORDER BY PageOrder
GO
/****** Object:  StoredProcedure [dbo].[mp_UserPages_Update]    Script Date: 11/10/2008 11:51:51 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserPages_Update]

/*
Author:   			
Created: 			6/12/2006
Last Modified: 		6/12/2006
*/
	
@UserPageID uniqueidentifier, 
@PageName nvarchar(255), 
@PageOrder int 


AS

UPDATE 		[dbo].[mp_UserPages] 

SET
			[PageName] = @PageName,
			[PageOrder] = @PageOrder
			
WHERE
			[UserPageID] = @UserPageID
GO
/****** Object:  StoredProcedure [dbo].[mp_UserPages_UpdatePageOrder]    Script Date: 11/10/2008 11:51:51 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserPages_UpdatePageOrder]
(
    @UserPageID       uniqueidentifier,
    @PageOrder        int
)
AS
UPDATE
    mp_UserPages

SET
    PageOrder = @PageOrder

WHERE
    UserPageID = @UserPageID
GO
/****** Object:  StoredProcedure [dbo].[mp_UserPages_Insert]    Script Date: 11/10/2008 11:51:50 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserPages_Insert]

/*
Author:   			
Created: 			6/12/2006
Last Modified: 		2008-01-28
*/

@UserPageID	uniqueidentifier,
@SiteGuid	uniqueidentifier,
@SiteID int,
@UserGuid uniqueidentifier,
@PageName nvarchar(255),
@PagePath nvarchar(255),
@PageOrder int

	
AS
INSERT INTO 	[dbo].[mp_UserPages] 
(
				[UserPageID],
				SiteGuid,
				[SiteID],
				[UserGuid],
				[PageName],
				PagePath,
				PageOrder
) 

VALUES 
(
				@UserPageID,
				@SiteGuid,
				@SiteID,
				@UserGuid,
				@PageName,
				@PagePath,
				@PageOrder
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_UserPages_GetNextPageOrder]    Script Date: 11/10/2008 11:51:50 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_UserPages_GetNextPageOrder]

/*
Author:			
Created:		11/7/2004
Last Modified:		11/7/2004

*/

@UserGuid uniqueidentifier

AS
SELECT	COALESCE(MAX(PageOrder), -1) + 2

FROM		mp_UserPages

WHERE	UserGuid = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Roles_SelectRolesUserIsNotIn]    Script Date: 11/10/2008 11:51:17 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Roles_SelectRolesUserIsNotIn]

@SiteID	int,
@UserID  int

AS

SELECT  r.*

FROM		mp_Roles r
    		
    
LEFT OUTER JOIN 		
		mp_UserRoles ur

ON 		r.RoleID = ur.RoleID
		AND ur.UserID = @UserID

WHERE		r.SiteID = @SiteID
			AND ur.UserID IS NULL

ORDER BY	r.[DisplayName]
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_GetUserRoles]    Script Date: 11/10/2008 11:51:57 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Users_GetUserRoles]



@SiteID	int,
@UserID       	int

AS

SELECT  
    		mp_Roles.RoleName,
    		mp_Roles.RoleID

FROM		 mp_UserRoles
  
INNER JOIN 	mp_Users 
ON 		mp_UserRoles.UserID = mp_Users.UserID

INNER JOIN 	mp_Roles 
ON 		mp_UserRoles.RoleID = mp_Roles.RoleID


WHERE   	mp_Users.SiteID = @SiteID
		AND mp_UserRoles.UserID = @UserID
GO
/****** Object:  StoredProcedure [dbo].[mp_Roles_Select]    Script Date: 11/10/2008 11:51:16 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Roles_Select]

/*
Last Modified:		2008-08-26 

*/
    
@SiteID  int

AS

SELECT  *

FROM		mp_Roles

WHERE   	SiteID = @SiteID

ORDER BY DisplayName
GO
/****** Object:  StoredProcedure [dbo].[mp_Roles_RoleExists]    Script Date: 11/10/2008 11:51:16 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Roles_RoleExists]

/*
Author:			
Created:		5/19/2005
Last Modified:		5/19/2005

*/
    
@SiteID  	int,
@RoleName	nvarchar(50)

AS

IF EXISTS (	SELECT 	RoleID
		FROM		mp_Roles
		WHERE	SiteID = @SiteID
				AND (RoleName = @RoleName OR DisplayName = @RoleName))
SELECT 1
ELSE
SELECT 0
GO
/****** Object:  StoredProcedure [dbo].[mp_Roles_SelectOneByName]    Script Date: 11/10/2008 11:51:17 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Roles_SelectOneByName]

/*
Auhor:			
Created:		5/21/2005
Last Modified:		5/21/2005

*/



@SiteID	int,
@RoleName	nvarchar(50)



AS


SELECT *

FROM		mp_Roles

WHERE	SiteID = @SiteID
		AND RoleName = @RoleName
GO
/****** Object:  StoredProcedure [dbo].[mp_Roles_Update]    Script Date: 11/10/2008 11:51:17 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Roles_Update]

/*
Last Modified:		5/19/2005 

*/

    
@RoleID      int,
@RoleName    nvarchar(50)

AS

UPDATE		mp_Roles

SET
    			DisplayName = @RoleName

WHERE
    			RoleID = @RoleID
GO
/****** Object:  StoredProcedure [dbo].[mp_Roles_SelectOne]    Script Date: 11/10/2008 11:51:17 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Roles_SelectOne]
(
    @RoleID int
)
AS

SELECT
    *

FROM
    mp_Roles

WHERE
    RoleID = @RoleID
GO
/****** Object:  StoredProcedure [dbo].[mp_Roles_Insert]    Script Date: 11/10/2008 11:51:16 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Roles_Insert]

/*
Author:			
Created:		7/19/2004
Last Modified:	2008-01-27

*/

@RoleGuid	uniqueidentifier,
@SiteGuid	uniqueidentifier,
@SiteID    		int,
@RoleName    nvarchar(50)

AS

INSERT INTO mp_Roles
(
			RoleGuid,
			SiteGuid,
    		SiteID,
    		RoleName,
    		DisplayName
)

VALUES
(
		@RoleGuid,
		@SiteGuid,
    	@SiteID,
    	@RoleName,
	@RoleName
)

SELECT  @@Identity As RoleID
GO
/****** Object:  StoredProcedure [dbo].[mp_Roles_Delete]    Script Date: 11/10/2008 11:51:16 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Roles_Delete]

/*
Last Modified:		2007-06-15
don't allow delete of admins role

*/
    
@RoleID int

AS

DELETE FROM	mp_Roles

WHERE	RoleID = @RoleID 
	AND RoleName  <> 'Admins' 
	AND RoleName <> 'Content Administrators' 
	AND RoleName <> 'Authenticated Users'
	AND RoleName <> 'Role Admins'
GO
/****** Object:  StoredProcedure [dbo].[mp_Pages_UpdateTimeStamp]    Script Date: 11/10/2008 11:51:11 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Pages_UpdateTimeStamp]
(
    @PageID           int,
    @LastModifiedUTC datetime
)
AS

UPDATE
    mp_Pages

SET
    LastModifiedUTC = @LastModifiedUTC

WHERE
    PageID = @PageID
GO
/****** Object:  StoredProcedure [dbo].[mp_Pages_Delete]    Script Date: 11/10/2008 11:51:05 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Pages_Delete]
(
    @PageID int
)
AS

DELETE FROM
    mp_Pages

WHERE
    PageID = @PageID
GO
/****** Object:  StoredProcedure [dbo].[mp_Pages_SelectOneByGuid]    Script Date: 11/10/2008 11:51:08 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Pages_SelectOneByGuid]

/*
Author:				
Created:			2007-08-07
Last Modified:		2007-08-07

*/

@PageGuid uniqueidentifier


AS
SELECT TOP 1	*

FROM		mp_Pages

WHERE	PageGuid = @PageGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Pages_SelectOne]    Script Date: 11/10/2008 11:51:08 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Pages_SelectOne]

/*
Author:				
Created:			11/7/2004
Last Modified:		8/27/2006

*/

@SiteID		int,
@PageID		int


AS
SELECT TOP 1	*

FROM		mp_Pages

WHERE	(PageID = @PageID OR @PageID = -1)
		AND SiteID = @SiteID 
ORDER BY ParentID, PageOrder
GO
/****** Object:  StoredProcedure [dbo].[mp_Pages_SelectChildPages]    Script Date: 11/10/2008 11:51:08 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Pages_SelectChildPages]

/*
Author:				
Created:			2/20/2005
Last Modified:			2/27/2005

*/


@ParentID		int


AS


SELECT	*

FROM		mp_Pages

WHERE	ParentID = @ParentID

ORDER BY PageOrder
GO

/****** Object:  StoredProcedure [dbo].[mp_Pages_GetNextPageOrder]    Script Date: 11/10/2008 11:51:06 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Pages_GetNextPageOrder]

/*
Author:			
Created:		11/7/2004
Last Modified:	04/29/2007

*/

@SiteID int,
@ParentID		int

AS

SELECT	COALESCE(MAX(PageOrder), -1) + 2

FROM		mp_Pages

WHERE	SiteID = @SiteID
		AND ParentID = @ParentID
GO
/****** Object:  StoredProcedure [dbo].[mp_Pages_UpdatePageOrder]    Script Date: 11/10/2008 11:51:11 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Pages_UpdatePageOrder]
(
    @PageID           int,
    @PageOrder        int
)
AS

UPDATE
    mp_Pages

SET
    PageOrder = @PageOrder

WHERE
    PageID = @PageID
GO
/****** Object:  StoredProcedure [dbo].[mp_Pages_Update]    Script Date: 11/10/2008 11:51:11 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Pages_Update]

/*
Author:			
Last Modified:		2008-01-27

*/


@SiteID        		int,
@PageID           	int,
@ParentID		int,
@PageOrder        	int,
@PageName         	nvarchar(50),
@AuthorizedRoles 	ntext,
@EditRoles		ntext,
@CreateChildPageRoles ntext,
@RequireSSL		bit,
@ShowBreadcrumbs	bit,
@ShowChildPageBreadcrumbs bit,
@PageKeyWords	nvarchar(255),
@PageDescription	nvarchar(255),
@PageEncoding	nvarchar(255),
@AdditionalMetaTags	nvarchar(255),
@UseUrl		bit,
@Url			nvarchar(255),
@OpenInNewWindow	bit,
@ShowChildPageMenu	bit,
@HideMainMenu	bit,
@Skin			nvarchar(100),
@IncludeInMenu	bit,
@MenuImage			nvarchar(50),
@PageTitle         	nvarchar(255),
@AllowBrowserCache	bit,
@ChangeFrequency	nvarchar(20),
@SiteMapPriority			nvarchar(10),
@LastModifiedUTC			datetime,
@ParentGuid uniqueidentifier,
@HideAfterLogin bit,
@CompiledMeta		ntext,
@CompiledMetaUtc	datetime


AS

UPDATE
    mp_Pages

SET
	ParentID = @ParentID,
    	PageOrder = @PageOrder,
    	PageName = @PageName,
		PageTitle = @PageTitle,
    	AuthorizedRoles = @AuthorizedRoles,
	EditRoles = @EditRoles,
	CreateChildPageRoles = @CreateChildPageRoles,
    	RequireSSL = @RequireSSL,
	AllowBrowserCache = @AllowBrowserCache,
	ShowBreadcrumbs = @ShowBreadcrumbs,
	ShowChildBreadCrumbs = @ShowChildPageBreadcrumbs,
	PageKeyWords = @PageKeyWords,
	PageDescription = @PageDescription,
	PageEncoding = @PageEncoding,
	AdditionalMetaTags = @AdditionalMetaTags,
	UseUrl = @UseUrl,
	Url = @Url,
	OpenInNewWindow = @OpenInNewWindow,
	ShowChildPageMenu = @ShowChildPageMenu,
	HideMainMenu = @HideMainMenu,
	Skin = @Skin,
	IncludeInMenu = @IncludeInMenu,
	MenuImage = @MenuImage,
	ChangeFrequency = @ChangeFrequency,
	SiteMapPriority = @SiteMapPriority,
	LastModifiedUTC = @LastModifiedUTC,
	ParentGuid = @ParentGuid,
	HideAfterLogin = @HideAfterLogin,
	CompiledMeta = @CompiledMeta,
	CompiledMetaUtc = @CompiledMetaUtc

WHERE
    PageID = @PageID
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteSettings_GetPageList]    Script Date: 11/10/2008 11:51:34 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SiteSettings_GetPageList]

/*
Author:				
Created:			7/27/2004
Last Modified:			3/19/2005

*/

@SiteID			int



AS
SELECT  
    				*
    
FROM    
    				mp_Pages
    
WHERE   
    				SiteID = @SiteID
					

ORDER BY			ParentID, PageOrder, PageName
GO
/****** Object:  StoredProcedure [dbo].[mp_HtmlContent_SelectByPage]    Script Date: 11/10/2008 11:50:36 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_HtmlContent_SelectByPage]

/*
Author:			Joe Audettte
Created:		6/26/2005
Last Modified:		09/02/2007

*/


@SiteID		int,
@PageID		int

AS
SELECT  	h.*,
		m.ModuleTitle,
		md.FeatureName

FROM		mp_HtmlContent h

JOIN		mp_Modules m
ON		h.ModuleID = m.ModuleID

JOIN		mp_ModuleDefinitions md
ON		m.ModuleDefID = md.ModuleDefID

JOIN		mp_PageModules pm
ON			pm.ModuleID = m.ModuleID

JOIN		mp_Pages p
ON		p.PageID = pm.PageID

WHERE	p.SiteID = @SiteID
		AND pm.PageID = @PageID

		-- AND pm.PublishBeginDate < GetDate()
		-- AND (pm.PublishEndDate IS NULL OR pm.PublishEndDate > GetDate())
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteSettings_SelectDefaultPageByID]    Script Date: 11/10/2008 11:51:34 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SiteSettings_SelectDefaultPageByID]

/*
Author:				
Created:			3/7/2005
Last Modified:			1/8/2006

*/

@SiteID int

AS
SELECT TOP 1
        			s.SiteID,
         			s.SiteName,
			s.Skin,
			s.Logo,
			s.Icon,
			s.AllowNewRegistration,
			s.AllowUserSkins,
			s.AllowPageSkins,
			s.AllowHideMenuOnPages,
			s.UseSecureRegistration,
			s.UseSSLOnAllPages,
			'MetaKeyWords' = COALESCE(s.DefaultPageKeyWords,  ''),
			'MetaDescription' = COALESCE(s.DefaultPageDescription,  ''),
			'MetaEncoding' = COALESCE(s.DefaultPageEncoding,  ''),
			'MetaAdditional' = COALESCE(s.DefaultAdditionalMetaTags,  ''),
			'PageMetaKeyWords' = COALESCE(p.PageKeyWords, ''),
			'PageMetaDescription' = COALESCE(p.PageDescription, ''),
			'PageMetaEncoding' = COALESCE(p.PageEncoding, ''),
			'PageMetaAdditional' = COALESCE(p.AdditionalMetaTags, ''),
			s.IsServerAdminSite,
			s.UseLdapAuth,
			s.AutoCreateLdapUserOnFirstLogin,
			s.LdapServer,
			s.LdapPort,
			s.LdapDomain,
			s.LdapRootDN,
			s.LdapUserDNKey,
			s.ReallyDeleteUsers,
			s.UseEmailForLogin,
			s.AllowUserFullNameChange,
			s.EditorSkin,
			s.DefaultFriendlyUrlPatternEnum,
			s.EnableMyPageFeature,
        			p.PageID,
			p.ParentID,
         			p.PageOrder,
        			p.PageName,
					p.PageTitle,
			p.MenuImage,
         			p.RequireSSL,
        			p.AuthorizedRoles,
			p.EditRoles,
			p.CreateChildPageRoles,
        			p.ShowBreadcrumbs,
			p.ShowChildPageMenu,
			p.ShowChildBreadCrumbs,
			p.HideMainMenu,
			'PageSkin' = p.Skin


FROM			mp_Pages p
    
INNER JOIN		mp_Sites  s
ON 			p.SiteID = s.SiteID
        
    
WHERE
        			s.SiteID = @SiteID
        
ORDER BY
        			p.ParentID, p.PageOrder
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteSettings_SelectPage]    Script Date: 11/10/2008 11:51:34 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SiteSettings_SelectPage]

/*
Author:				
Created:			7/27/2004
Last Modified:			1/8/2006

*/

@PageID		int,
@HostName		nvarchar(255)

AS
DECLARE @SiteID int

SET @SiteID = COALESCE(	(SELECT TOP 1 SiteID FROM mp_SiteHosts WHERE HostName = @HostName),
				 (SELECT TOP 1 SiteID FROM mp_Sites ORDER BY SiteID)
			)


 SELECT TOP 1
        			s.SiteID,
         			s.SiteName,
			s.Skin,
			s.Logo,
			s.Icon,
			s.AllowNewRegistration,
			s.AllowUserSkins,
			s.AllowPageSkins,
			s.AllowHideMenuOnPages,
			s.UseSecureRegistration,
			s.UseSSLOnAllPages,
			'MetaKeyWords' = COALESCE(s.DefaultPageKeyWords,  ''),
			'MetaDescription' = COALESCE(s.DefaultPageDescription,  ''),
			'MetaEncoding' = COALESCE(s.DefaultPageEncoding,  ''),
			'MetaAdditional' = COALESCE(s.DefaultAdditionalMetaTags,  ''),
			'PageMetaKeyWords' = COALESCE(p.PageKeyWords, ''),
			'PageMetaDescription' = COALESCE(p.PageDescription, ''),
			'PageMetaEncoding' = COALESCE(p.PageEncoding, ''),
			'PageMetaAdditional' = COALESCE(p.AdditionalMetaTags, ''),
			s.IsServerAdminSite,
			s.UseLdapAuth,
			s.AutoCreateLdapUserOnFirstLogin,
			s.LdapServer,
			s.LdapPort,
			s.LdapDomain,
			s.LdapRootDN,
			s.LdapUserDNKey,
			s.ReallyDeleteUsers,
			s.UseEmailForLogin,
			s.AllowUserFullNameChange,
			s.EditorSkin,
			s.DefaultFriendlyUrlPatternEnum,
			s.EnableMyPageFeature,
        			p.PageID,
			p.ParentID,
         			p.PageOrder,
        			p.PageName,
			p.PageTitle,
			p.MenuImage,
         			p.RequireSSL,
        			p.AuthorizedRoles,
			p.EditRoles,
			p.CreateChildPageRoles,
        			p.ShowBreadcrumbs,
			p.ShowChildPageMenu,
			p.ShowChildBreadCrumbs,
			p.HideMainMenu,
			'PageSkin' = p.Skin


FROM			mp_Pages p
    
INNER JOIN		mp_Sites  s
ON 			p.SiteID = s.SiteID
        
    
WHERE		s.SiteID = @SiteID
        			AND p.PageID = @PageID
        
ORDER BY
        			p.PageOrder
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteSettings_SelectDefaultPage]    Script Date: 11/10/2008 11:51:34 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SiteSettings_SelectDefaultPage]

/*
Author:				
Created:			7/27/2004
Last Modified:			1/8/2006

*/

@HostName		nvarchar(255)

AS
DECLARE @SiteID int

SET @SiteID = COALESCE(	(SELECT TOP 1 SiteID FROM mp_SiteHosts WHERE HostName = @HostName),
				 (SELECT TOP 1 SiteID FROM mp_Sites ORDER BY SiteID)
			)


 SELECT TOP 1
        			s.SiteID,
         			s.SiteName,
			s.Skin,
			s.Logo,
			s.Icon,
			s.AllowNewRegistration,
			s.AllowUserSkins,
			s.AllowPageSkins,
			s.AllowHideMenuOnPages,
			s.UseSecureRegistration,
			s.UseSSLOnAllPages,
			'MetaKeyWords' = COALESCE(s.DefaultPageKeyWords,  ''),
			'MetaDescription' = COALESCE(s.DefaultPageDescription,  ''),
			'MetaEncoding' = COALESCE(s.DefaultPageEncoding,  ''),
			'MetaAdditional' = COALESCE(s.DefaultAdditionalMetaTags,  ''),
			'PageMetaKeyWords' = COALESCE(p.PageKeyWords, ''),
			'PageMetaDescription' = COALESCE(p.PageDescription, ''),
			'PageMetaEncoding' = COALESCE(p.PageEncoding, ''),
			'PageMetaAdditional' = COALESCE(p.AdditionalMetaTags, ''),
			s.IsServerAdminSite,
			s.UseLdapAuth,
			s.AutoCreateLdapUserOnFirstLogin,
			s.LdapServer,
			s.LdapPort,
			s.LdapDomain,
			s.LdapRootDN,
			s.LdapUserDNKey,
			s.ReallyDeleteUsers,
			s.UseEmailForLogin,
			s.AllowUserFullNameChange,
			s.EditorSkin,
			s.DefaultFriendlyUrlPatternEnum,
			s.EnableMyPageFeature,
        			p.PageID,
			p.ParentID,
         			p.PageOrder,
        			p.PageName,
					p.PageTitle,
					p.MenuImage,
         			p.RequireSSL,
        			p.AuthorizedRoles,
			p.EditRoles,
			p.CreateChildPageRoles,
        			p.ShowBreadcrumbs,
			p.ShowChildPageMenu,
			p.ShowChildBreadCrumbs,
			p.HideMainMenu,
			'PageSkin' = p.Skin


FROM			mp_Pages p
    
INNER JOIN		mp_Sites  s
ON 			p.SiteID = s.SiteID
        
    
WHERE
        			s.SiteID = @SiteID
        
ORDER BY
        			p.ParentID, p.PageOrder
GO
/****** Object:  StoredProcedure [dbo].[mp_Pages_CleanupOrphans]    Script Date: 11/10/2008 11:51:05 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Pages_CleanupOrphans]

AS

UPDATE mp_Pages

SET ParentGuid = '00000000-0000-0000-0000-000000000000',
	ParentID = -1

WHERE ParentID <> -1
AND ParentID NOT IN (SELECT PageID FROM mp_Pages)
GO
/****** Object:  StoredProcedure [dbo].[mp_Pages_Insert]    Script Date: 11/10/2008 11:51:08 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Pages_Insert]

/*
Author:			
Created:		2004-11-17
Last Modified:	2008-01-27

*/

@SiteID   		int,
@ParentID		int,
@PageName    		nvarchar(50),
@PageOrder   		int,
@AuthorizedRoles 	ntext,
@EditRoles		ntext,
@CreateChildPageRoles ntext,
@RequireSSL		bit,
@ShowBreadcrumbs 	bit,
@ShowChildPageBreadcrumbs 	bit,
@PageKeyWords	nvarchar(255),
@PageDescription	nvarchar(255),
@PageEncoding	nvarchar(255),
@AdditionalMetaTags	nvarchar(255),
@UseUrl		bit,
@Url			nvarchar(255),
@OpenInNewWindow	bit,
@ShowChildPageMenu	bit,
@HideMainMenu	bit,
@Skin			nvarchar(100),
@IncludeInMenu	bit,
@MenuImage			nvarchar(50),
@PageTitle    		nvarchar(255),
@AllowBrowserCache	bit,
@ChangeFrequency	nvarchar(20),
@SiteMapPriority			nvarchar(10),
@LastModifiedUTC			datetime,
@PageGuid	uniqueidentifier,
@ParentGuid uniqueidentifier,
@HideAfterLogin	bit,
@SiteGuid	uniqueidentifier,
@CompiledMeta		ntext,
@CompiledMetaUtc	datetime

AS
INSERT INTO 		mp_Pages
(
    			SiteID,
			ParentID,
    			PageName,
				PageTitle,
    			PageOrder,
			AuthorizedRoles,
			EditRoles,
			CreateChildPageRoles,
    			RequireSSL,
			AllowBrowserCache,
    			ShowBreadcrumbs,
			ShowChildBreadCrumbs,
    			PageKeyWords,
			PageDescription,
			PageEncoding,
			AdditionalMetaTags,
			UseUrl,
			Url,
			OpenInNewWindow,
			ShowChildPageMenu,
			HideMainMenu,
			Skin,
			IncludeInMenu,
			MenuImage,
			ChangeFrequency,
			SiteMapPriority,
			LastModifiedUTC,
			PageGuid,
			ParentGuid,
			HideAfterLogin,
			SiteGuid,
			CompiledMeta,
			CompiledMetaUtc
)

VALUES
(
    			@SiteID,
			@ParentID,
    			@PageName,
				@PageTitle,
    			@PageOrder,
			@AuthorizedRoles,
			@EditRoles,
			@CreateChildPageRoles,
    			@RequireSSL,
			@AllowBrowserCache,
    			@ShowBreadcrumbs,
			@ShowChildPageBreadcrumbs,
			@PageKeyWords,
			@PageDescription,
			@PageEncoding,
			@AdditionalMetaTags,
			@UseUrl,
			@Url,
			@OpenInNewWindow,
			@ShowChildPageMenu,
			@HideMainMenu,
			@Skin,
			@IncludeInMenu,
			@MenuImage,
			@ChangeFrequency,
			@SiteMapPriority,
			@LastModifiedUTC,
			@PageGuid,
			@ParentGuid,
			@HideAfterLogin,
			@SiteGuid,
			@CompiledMeta,
			@CompiledMetaUtc
)

SELECT  @@Identity As PageID
GO
/****** Object:  StoredProcedure [dbo].[mp_Pages_SelectList]    Script Date: 11/10/2008 11:51:08 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Pages_SelectList]

/*
Author:				
Created:			7/27/2004
Last Modified:			7/27/2004

*/

@SiteID			int



AS

SELECT  			*
    				
    
FROM    
    				mp_Pages
    
WHERE   
    				SiteID = @SiteID

ORDER BY			ParentID,  PageName
GO
/****** Object:  StoredProcedure [dbo].[mp_Modules_Insert]    Script Date: 11/10/2008 11:50:58 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Modules_Insert]

/*
Author:   			
Created: 			2004-12-26
Last Modified: 		2008-07-24

*/

@PageID int,
@SiteID		int,
@ModuleDefID int,
@ModuleOrder int,
@PaneName nvarchar(50),
@ModuleTitle nvarchar(255),
@AuthorizedEditRoles ntext,
@CacheTime int,
@ShowTitle bit,
@AvailableForMyPage	bit,
@CreatedByUserID	int,
@CreatedDate		datetime,
@AllowMultipleInstancesOnMyPage	bit,
@Icon	nvarchar(255),
@Guid	uniqueidentifier,
@FeatureGuid uniqueidentifier,
@SiteGuid	uniqueidentifier,
@HideFromAuth bit,
@HideFromUnAuth bit

	
AS
DECLARE @ModuleID int

INSERT INTO 	[dbo].[mp_Modules] 
(
				SiteID,
				SiteGuid,
				[ModuleDefID],
				[ModuleTitle],
				[AuthorizedEditRoles],
				[CacheTime],
				[ShowTitle],
				AvailableForMyPage,
				AllowMultipleInstancesOnMyPage,
				Icon,
				CreatedByUserID,
				CreatedDate,
				[Guid],
				FeatureGuid,
				HideFromAuth,
				HideFromUnAuth
) 

VALUES 
(
				@SiteID,
				@SiteGuid,
				@ModuleDefID,
				@ModuleTitle,
				@AuthorizedEditRoles,
				@CacheTime,
				@ShowTitle,
				@AvailableForMyPage,
				@AllowMultipleInstancesOnMyPage,
				@Icon,
				@CreatedByUserID,
				@CreatedDate,
				@Guid,
				@FeatureGuid,
				@HideFromAuth,
				@HideFromUnAuth
				
)
SELECT @ModuleID =  @@IDENTITY

IF @PageID > -1
BEGIN

DECLARE @PageGuid uniqueidentifier
SET @PageGuid = (SELECT TOP 1 PageGuid FROM mp_Pages WHERE PageID = @PageID)

INSERT INTO 	[dbo].[mp_PageModules] 
(
				[PageID],
				[ModuleID],
				[ModuleOrder],
				[PaneName],
				[PublishBeginDate],
				PageGuid,
				ModuleGuid
				
) 

VALUES 
(
				@PageID,
				@ModuleID,
				@ModuleOrder,
				@PaneName,
				@CreatedDate,
				@PageGuid,
				@Guid
				
				
)
END


SELECT @ModuleID
GO
/****** Object:  StoredProcedure [dbo].[mp_Modules_UpdatePage]    Script Date: 11/10/2008 11:51:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Modules_UpdatePage]

	
@OldPageID				int,
@NewPageID			int,
@ModuleID           int
    

AS
UPDATE
    mp_PageModules

SET
    PageID = @NewPageID,
	PageGuid = (SELECT TOP 1 PageGuid FROM mp_Pages WHERE PageID = @NewPageID)

WHERE
    ModuleID = @ModuleID
	AND PageID = @OldPageID
GO
/****** Object:  StoredProcedure [dbo].[mp_Pages_GetAuthRoles]    Script Date: 11/10/2008 11:51:05 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Pages_GetAuthRoles]
(
    @SiteID    int,
    @ModuleID    int,
    @AccessRoles nvarchar (256) OUTPUT,
    @EditRoles   nvarchar (256) OUTPUT
)
AS
SELECT  
    @AccessRoles = p.AuthorizedRoles,
    @EditRoles   = m.AuthorizedEditRoles
    
FROM    
    mp_Modules m
INNER JOIN mp_PageModules pm
ON	pm.ModuleID = m.ModuleID
  INNER JOIN
    mp_Pages p
ON pm.PageID = p.PageID
    
WHERE   
    m.ModuleID = @ModuleID
  AND
    p.SiteID = @SiteID
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteSettingsEx_Save]    Script Date: 11/10/2008 11:51:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[mp_SiteSettingsEx_Save]
(
	@SiteID int
	,@SiteGuid uniqueidentifier
	,@KeyName nvarchar(128)
	,@KeyValue ntext
	,@GroupName nvarchar(255)
)
AS
	
	if exists(select [KeyName] from mp_SiteSettingsEx 
			where SiteID = @SiteID and [KeyName] = @KeyName)
	begin
		update mp_SiteSettingsEx set KeyValue = @KeyValue 
		where SiteID = @SiteID and [KeyName] = @KeyName 
	end
	else
	begin
		insert into mp_SiteSettingsEx(SiteID,SiteGuid,[KeyName],KeyValue,[GroupName])
		values(@SiteID,@SiteGuid,@KeyName,@KeyValue,@GroupName)
	end
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteSettingsEx_SelectAll]    Script Date: 11/10/2008 11:51:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[mp_SiteSettingsEx_SelectAll]
(
@SiteID int
)
AS
select e.* 

from 

mp_SiteSettingsEx e

JOIN

mp_SiteSettingsExDef d
ON
e.[KeyName] = d.[KeyName]
AND e.[GroupName] = d.[GroupName]

where e.SiteID =  @SiteID 
 
order by d.[GroupName], d.[SortOrder]
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteSettingsEx_EnsureDefinitions]    Script Date: 11/10/2008 11:51:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SiteSettingsEx_EnsureDefinitions]

/*
Author:   			
Created: 			2008-09-11
Last Modified: 		2008-09-11
*/

AS

INSERT INTO [dbo].[mp_SiteSettingsEx]
(
	SiteID,
	SiteGuid,
	[KeyName],
	[KeyValue],
	[GroupName]
)

SELECT 
		t.SiteID,
		t.SiteGuid,
		t.[KeyName],
		t.[DefaultValue],
		t.[GroupName] 
FROM
(
SELECT
		s.SiteID,
		s.SiteGuid,
		d.[KeyName],
		d.[DefaultValue],
		d.[GroupName]

FROM
		mp_Sites s,
		mp_SiteSettingsExDef d
) t

LEFT OUTER JOIN
		mp_SiteSettingsEx e
ON
		e.SiteID = t.SiteID
		AND e.[KeyName] = t.[KeyName]

WHERE
		e.SiteID IS NULL
GO
/****** Object:  StoredProcedure [dbo].[mp_Sites_SelectOneByGuid]    Script Date: 11/10/2008 11:51:30 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Sites_SelectOneByGuid]

/*
Author:   			
Created: 			5/11/2007
Last Modified: 		5/11/2007

*/

@SiteGuid uniqueidentifier

AS


SELECT
		*
		
FROM
		[dbo].[mp_Sites]
		
WHERE
		[SiteGuid] = @SiteGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Sites_SelectOne]    Script Date: 11/10/2008 11:51:30 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Sites_SelectOne]

/*
Author:   			
Created: 			3/7/2005
Last Modified: 			5/29/2005

*/

@SiteID int

AS


SELECT
		*
		
FROM
		[dbo].[mp_Sites]
		
WHERE
		[SiteID] = @SiteID
GO
/****** Object:  StoredProcedure [dbo].[mp_Sites_SelectAll]    Script Date: 11/10/2008 11:51:30 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Sites_SelectAll]

/*
Author:   			
Created: 			3/7/2005
Last Modified: 			3/7/2005

*/

AS
SELECT
		*
		
FROM
		[dbo].[mp_Sites]
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteFolders_SelectSiteGuidByFolder]    Script Date: 11/10/2008 11:51:22 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SiteFolders_SelectSiteGuidByFolder]

/*
Author:   			
Created: 			5/11/2007
Last Modified: 		5/11/2007

*/

@FolderName		nvarchar(255)

AS



SELECT COALESCE(	
	(SELECT TOP 1 SiteGuid 
		FROM mp_SiteFolders 
		WHERE FolderName = @FolderName),
				 
		(SELECT TOP 1 SiteGuid FROM mp_Sites ORDER BY SiteID)
			)
GO
/****** Object:  StoredProcedure [dbo].[mp_Sites_UpdateExtendedProperties]    Script Date: 11/10/2008 11:51:34 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[mp_Sites_UpdateExtendedProperties] 
	-- Add the parameters for the stored procedure here

@SiteID							int,
@AllowPasswordRetrieval			bit,
@AllowPasswordReset				bit,
@RequiresQuestionAndAnswer		bit,
@MaxInvalidPasswordAttempts		int,
@PasswordAttemptWindowMinutes	int,
@RequiresUniqueEmail			bit,
@PasswordFormat					int,
@MinRequiredPasswordLength		int,
@MinRequiredNonAlphanumericCharacters	int,
@PasswordStrengthRegularExpression	ntext,
@DefaultEmailFromAddress		nvarchar(100)

AS

UPDATE			mp_Sites

SET				AllowPasswordRetrieval = @AllowPasswordRetrieval,
				AllowPasswordReset = @AllowPasswordReset,
				RequiresQuestionAndAnswer = @RequiresQuestionAndAnswer,
				MaxInvalidPasswordAttempts = @MaxInvalidPasswordAttempts,
				PasswordAttemptWindowMinutes = @PasswordAttemptWindowMinutes,
				RequiresUniqueEmail = @RequiresUniqueEmail,
				PasswordFormat = @PasswordFormat,
				MinRequiredPasswordLength  = @MinRequiredPasswordLength,
				MinReqNonAlphaChars = @MinRequiredNonAlphanumericCharacters,
				PwdStrengthRegex = @PasswordStrengthRegularExpression,
				DefaultEmailFromAddress = @DefaultEmailFromAddress



WHERE			SiteID = @SiteID
GO
/****** Object:  StoredProcedure [dbo].[mp_FriendlyUrls_SelectByHost]    Script Date: 11/10/2008 11:50:24 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_FriendlyUrls_SelectByHost]

/*
Author:   			
Created: 			6/1/2005
Last Modified: 		2008-01-27
*/

@HostName		varchar(100)

AS

SELECT
		*
		
FROM
		[dbo].[mp_FriendlyUrls]

WHERE	SiteID = COALESCE(
					(SELECT TOP 1 SiteID From mp_SiteHosts WHERE HostName = @HostName),

					(SELECT TOP 1 SiteID From mp_Sites ORDER BY SiteID )
					)
GO
/****** Object:  StoredProcedure [dbo].[mp_FriendlyUrls_SelectOneByUrl]    Script Date: 11/10/2008 11:50:25 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_FriendlyUrls_SelectOneByUrl]

/*
Author:   			
Created: 			6/16/2005
Last Modified: 		2008-01-27
*/

@HostName		varchar(100),
@FriendlyUrl		varchar(255)

AS

SELECT TOP 1
		u.*
		
FROM
		[dbo].[mp_FriendlyUrls] u



WHERE	u.FriendlyUrl = @FriendlyUrl
		AND u.SiteID = COALESCE(
					(SELECT TOP 1 SiteID From mp_SiteHosts WHERE HostName = @HostName),

					(SELECT TOP 1 SiteID From mp_Sites ORDER BY SiteID )
					)
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteModuleDefinitions_EnsureForAdminSites]    Script Date: 11/10/2008 11:51:24 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SiteModuleDefinitions_EnsureForAdminSites]

/*
Author:			
Created:		2007-08-06
Last Modified:	2008-01-26

*/


AS

INSERT INTO mp_SiteModuleDefinitions
(
	SiteID,
	ModuleDefID,
	SiteGuid,
	FeatureGuid
)

SELECT
	s.SiteID,
	md.ModuleDefID,
	s.SiteGuid,
	md.Guid

FROM
	mp_Sites s

CROSS JOIN
	mp_ModuleDefinitions md

WHERE	s.IsServerAdminSite = 1
AND md.Guid NOT IN
(SELECT sd.FeatureGuid FROM mp_SiteModuleDefinitions sd
	WHERE sd.SiteGuid = s.SiteGuid)
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteModuleDefinitions_Insert]    Script Date: 11/10/2008 11:51:24 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SiteModuleDefinitions_Insert]

/*
Author:			
Created:		3/12/2005
Last Modified:		2008-01-26

*/


@SiteGuid		uniqueidentifier,
@FeatureGuid	uniqueidentifier



AS

DECLARE @SiteID	int
DECLARE @ModuleDefID int

SET @SiteID = (SELECT TOP 1 SiteID FROM mp_Sites WHERE SiteGuid = @SiteGuid)
SET @ModuleDefID = (SELECT TOP 1 ModuleDefID FROM mp_ModuleDefinitions WHERE Guid = @FeatureGuid)

IF NOT EXISTS (SELECT SiteID FROM mp_SiteModuleDefinitions WHERE SiteID = @SiteID AND ModuleDefID = @ModuleDefID)
INSERT INTO mp_SiteModuleDefinitions (SiteID, ModuleDefID, SiteGuid, FeatureGuid)

VALUES	(@SiteID, @ModuleDefID, @SiteGuid, @FeatureGuid)
GO
/****** Object:  StoredProcedure [dbo].[mp_Sites_Insert]    Script Date: 11/10/2008 11:51:30 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Sites_Insert]

/*
Author:   			
Created: 			2005/03/07
Last Modified: 		2008-01-27

*/


@SiteName 				nvarchar(255),
@Skin 					nvarchar(100),
@Logo 					nvarchar(50),
@Icon 					nvarchar(50),
@AllowUserSkins 			bit,
@AllowNewRegistration 			bit,
@UseSecureRegistration 		bit,
@UseSSLOnAllPages 			bit,
@DefaultPageKeyWords 		nvarchar(255),
@DefaultPageDescription 		nvarchar(255),
@DefaultPageEncoding 			nvarchar(255),
@DefaultAdditionalMetaTags 		nvarchar(255),
@IsServerAdminSite 			bit,
@AllowPageSkins			bit,
@AllowHideMenuOnPages		bit,
@UseLdapAuth				bit,
@AutoCreateLdapUserOnFirstLogin	bit,
@LdapServer				nvarchar(255),
@LdapPort				int,
@LdapDomain				nvarchar(255),
@LdapRootDN				nvarchar(255),
@LdapUserDNKey			nvarchar(10),
@AllowUserFullNameChange		bit,
@UseEmailForLogin			bit,
@ReallyDeleteUsers			bit,
@EditorSkin				nvarchar(50),
@DefaultFriendlyUrlPatternEnum		nvarchar(50),
@SiteGuid					uniqueidentifier,
@EnableMyPageFeature 			bit,
@EditorProvider				nvarchar(255),
@DatePickerProvider				nvarchar(255),
@CaptchaProvider				nvarchar(255),
@RecaptchaPrivateKey				nvarchar(255),
@RecaptchaPublicKey				nvarchar(255),
@WordpressAPIKey				nvarchar(255),
@WindowsLiveAppID				nvarchar(255),
@WindowsLiveKey				nvarchar(255),
@AllowOpenIDAuth			bit,
@AllowWindowsLiveAuth		bit,
@GmapApiKey 				nvarchar(255),
@ApiKeyExtra1 				nvarchar(255),
@ApiKeyExtra2 				nvarchar(255),
@ApiKeyExtra3 				nvarchar(255),
@ApiKeyExtra4 				nvarchar(255),
@ApiKeyExtra5 				nvarchar(255)


	
AS
INSERT INTO 	[dbo].[mp_Sites] 
(
				
				[SiteName],
				[Skin],
				[Logo],
				[Icon],
				[AllowUserSkins],
				[AllowNewRegistration],
				[UseSecureRegistration],
				[UseSSLOnAllPages],
				[DefaultPageKeyWords],
				[DefaultPageDescription],
				[DefaultPageEncoding],
				[DefaultAdditionalMetaTags],
				[IsServerAdminSite],
				AllowPageSkins,
				AllowHideMenuOnPages,
				UseLdapAuth,
				AutoCreateLdapUserOnFirstLogin,
				LdapServer,
				LdapPort,
				LdapDomain,
				LdapRootDN,
				LdapUserDNKey,
				ReallyDeleteUsers,
				UseEmailForLogin,
				AllowUserFullNameChange,
				EditorSkin,
				DefaultFriendlyUrlPatternEnum,
				SiteGuid,
				EnableMyPageFeature,
				EditorProvider,
				DatePickerProvider,
				CaptchaProvider,
				RecaptchaPrivateKey,
				RecaptchaPublicKey,
				WordpressAPIKey,
				WindowsLiveAppID,
				WindowsLiveKey,
				AllowOpenIDAuth,
				AllowWindowsLiveAuth,
				GmapApiKey,
				ApiKeyExtra1,
				ApiKeyExtra2,
				ApiKeyExtra3,
				ApiKeyExtra4,
				ApiKeyExtra5
) 

VALUES 
(
				
				@SiteName,
				@Skin,
				@Logo,
				@Icon,
				@AllowUserSkins,
				@AllowNewRegistration,
				@UseSecureRegistration,
				@UseSSLOnAllPages,
				@DefaultPageKeyWords,
				@DefaultPageDescription,
				@DefaultPageEncoding,
				@DefaultAdditionalMetaTags,
				@IsServerAdminSite,
				@AllowPageSkins,
				@AllowHideMenuOnPages,
				@UseLdapAuth,
				@AutoCreateLdapUserOnFirstLogin,
				@LdapServer,
				@LdapPort,
				@LdapDomain,
				@LdapRootDN,
				@LdapUserDNKey,
				@ReallyDeleteUsers,
				@UseEmailForLogin,
				@AllowUserFullNameChange,
				@EditorSkin,
				@DefaultFriendlyUrlPatternEnum,
				@SiteGuid,
				@EnableMyPageFeature,
				@EditorProvider,
				@DatePickerProvider,
				@CaptchaProvider,
				@RecaptchaPrivateKey,
				@RecaptchaPublicKey,
				@WordpressAPIKey,
				@WindowsLiveAppID,
				@WindowsLiveKey,
				@AllowOpenIDAuth,
				@AllowWindowsLiveAuth,
				@GmapApiKey,
				@ApiKeyExtra1,
				@ApiKeyExtra2,
				@ApiKeyExtra3,
				@ApiKeyExtra4,
				@ApiKeyExtra5
				
)
SELECT @@IDENTITY
GO
/****** Object:  StoredProcedure [dbo].[mp_Sites_Count]    Script Date: 11/10/2008 11:51:27 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Sites_Count]

/*
Author:		
Created:	3/13/2005
Last Modified:	3/13/2005

*/

AS

SELECT Count(*) FROM mp_Sites
GO
/****** Object:  StoredProcedure [dbo].[mp_Sites_Update]    Script Date: 11/10/2008 11:51:33 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Sites_Update]

/*
Author:		
Last Modified:	2008-01-27

*/

@SiteID           			int,
@SiteName         		nvarchar(128),
@Skin				nvarchar(100),
@Logo				nvarchar(50),
@Icon				nvarchar(50),
@AllowNewRegistration		bit,
@AllowUserSkins		bit,
@UseSecureRegistration	bit,
@UseSSLOnAllPages		bit,
@DefaultPageKeywords		nvarchar(255),
@DefaultPageDescription	nvarchar(255),
@DefaultPageEncoding		nvarchar(255),
@DefaultAdditionalMetaTags	nvarchar(255),
@IsServerAdminSite		bit,
@AllowPageSkins		bit,
@AllowHideMenuOnPages	bit,
@UseLdapAuth				bit,
@AutoCreateLdapUserOnFirstLogin	bit,
@LdapServer				nvarchar(255),
@LdapPort				int,
@LdapRootDN				nvarchar(255),
@LdapUserDNKey			nvarchar(10),
@AllowUserFullNameChange		bit,
@UseEmailForLogin			bit,
@ReallyDeleteUsers			bit,
@EditorSkin				nvarchar(50),
@DefaultFriendlyUrlPatternEnum		nvarchar(50),
@EnableMyPageFeature		bit,
@LdapDomain				nvarchar(255),
@EditorProvider				nvarchar(255),
@DatePickerProvider				nvarchar(255),
@CaptchaProvider				nvarchar(255),
@RecaptchaPrivateKey				nvarchar(255),
@RecaptchaPublicKey				nvarchar(255),
@WordpressAPIKey				nvarchar(255),
@WindowsLiveAppID				nvarchar(255),
@WindowsLiveKey				nvarchar(255),
@AllowOpenIDAuth			bit,
@AllowWindowsLiveAuth		bit,
@GmapApiKey 				nvarchar(255),
@ApiKeyExtra1 				nvarchar(255),
@ApiKeyExtra2 				nvarchar(255),
@ApiKeyExtra3 				nvarchar(255),
@ApiKeyExtra4 				nvarchar(255),
@ApiKeyExtra5 				nvarchar(255)
	
AS
UPDATE	mp_Sites

SET
    	SiteName = @SiteName,
	Skin = @Skin,
	Logo = @Logo,
	Icon = @Icon,
	AllowNewRegistration = @AllowNewRegistration,
	AllowUserSkins = @AllowUserSkins,
	UseSecureRegistration = @UseSecureRegistration,
	UseSSLOnAllPages = @UseSSLOnAllPages,
	DefaultPageKeywords = @DefaultPageKeywords,
	DefaultPageDescription = @DefaultPageDescription,
	DefaultPageEncoding = @DefaultPageEncoding,
	DefaultAdditionalMetaTags = @DefaultAdditionalMetaTags,
	IsServerAdminSite = @IsServerAdminSite,
	AllowPageSkins = @AllowPageSkins,
	AllowHideMenuOnPages = @AllowHideMenuOnPages,
	UseLdapAuth = @UseLdapAuth,
	AutoCreateLdapUserOnFirstLogin = @AutoCreateLdapUserOnFirstLogin,
	LdapServer = @LdapServer,
	LdapPort = @LdapPort,
    LdapDomain = @LdapDomain,
	LdapRootDN = @LdapRootDN,
	LdapUserDNKey = @LdapUserDNKey,
	AllowUserFullNameChange = @AllowUserFullNameChange,
	UseEmailForLogin = @UseEmailForLogin,
	ReallyDeleteUsers = @ReallyDeleteUsers,
	EditorSkin = @EditorSkin,
	DefaultFriendlyUrlPatternEnum = @DefaultFriendlyUrlPatternEnum,
	EnableMyPageFeature = @EnableMyPageFeature,
	EditorProvider = @EditorProvider,
	DatePickerProvider = @DatePickerProvider,
	CaptchaProvider = @CaptchaProvider,
	RecaptchaPrivateKey = @RecaptchaPrivateKey,
	RecaptchaPublicKey = @RecaptchaPublicKey,
	WordpressAPIKey = @WordpressAPIKey,
	WindowsLiveAppID = @WindowsLiveAppID,
	WindowsLiveKey = @WindowsLiveKey,
	AllowOpenIDAuth = @AllowOpenIDAuth,
	AllowWindowsLiveAuth = @AllowWindowsLiveAuth,
	GmapApiKey = @GmapApiKey,
	ApiKeyExtra1 = @ApiKeyExtra1,
	ApiKeyExtra2 = @ApiKeyExtra2,
	ApiKeyExtra3 = @ApiKeyExtra3,
	ApiKeyExtra4 = @ApiKeyExtra4,
	ApiKeyExtra5 = @ApiKeyExtra5

WHERE
    	SiteID = @SiteID
GO
/****** Object:  StoredProcedure [dbo].[mp_Sites_SelectOneByHost]    Script Date: 11/10/2008 11:51:30 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Sites_SelectOneByHost]

/*
Author:   			
Created: 			8/27/2006
Last Modified: 		8/27/2006

*/

@HostName		nvarchar(255)

AS

DECLARE @SiteID int

SET @SiteID = COALESCE(	(SELECT TOP 1 SiteID FROM mp_SiteHosts WHERE HostName = @HostName),
				 (SELECT TOP 1 SiteID FROM mp_Sites ORDER BY SiteID)
			)

SELECT
		*
		
FROM
		[dbo].[mp_Sites]
		
WHERE
		[SiteID] = @SiteID
GO
/****** Object:  StoredProcedure [dbo].[mp_SchemaVersion_SelectAll]    Script Date: 11/10/2008 11:51:20 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SchemaVersion_SelectAll]

/*
Author:   			
Created: 			1/29/2007
Last Modified: 		1/29/2007
*/

AS


SELECT
		[ApplicationID],
		[ApplicationName],
		[Major],
		[Minor],
		[Build],
		[Revision]
		
FROM
		[dbo].[mp_SchemaVersion]
GO
/****** Object:  StoredProcedure [dbo].[mp_SchemaVersion_Insert]    Script Date: 11/10/2008 11:51:19 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SchemaVersion_Insert]

/*
Author:   			
Created: 			1/29/2007
Last Modified: 		1/29/2007
*/

@ApplicationID uniqueidentifier,
@ApplicationName nvarchar(255),
@Major int,
@Minor int,
@Build int,
@Revision int

	
AS

INSERT INTO 	[dbo].[mp_SchemaVersion] 
(
				[ApplicationID],
				[ApplicationName],
				[Major],
				[Minor],
				[Build],
				[Revision]
) 

VALUES 
(
				@ApplicationID,
				@ApplicationName,
				@Major,
				@Minor,
				@Build,
				@Revision
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_SchemaVersion_SelectOne]    Script Date: 11/10/2008 11:51:20 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SchemaVersion_SelectOne]

/*
Author:   			
Created: 			1/29/2007
Last Modified: 		1/29/2007
*/

@ApplicationID uniqueidentifier

AS


SELECT
		[ApplicationID],
		[ApplicationName],
		[Major],
		[Minor],
		[Build],
		[Revision]
		
FROM
		[dbo].[mp_SchemaVersion]
		
WHERE
		[ApplicationID] = @ApplicationID
GO
/****** Object:  StoredProcedure [dbo].[mp_SchemaVersion_Delete]    Script Date: 11/10/2008 11:51:19 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SchemaVersion_Delete]

/*
Author:   			
Created: 			1/29/2007
Last Modified: 		1/29/2007
*/

@ApplicationID uniqueidentifier

AS

DELETE FROM [dbo].[mp_SchemaVersion]
WHERE
	[ApplicationID] = @ApplicationID
GO
/****** Object:  StoredProcedure [dbo].[mp_SchemaVersion_Update]    Script Date: 11/10/2008 11:51:20 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SchemaVersion_Update]

/*
Author:   			
Created: 			1/29/2007
Last Modified: 		1/29/2007
*/
	
@ApplicationID uniqueidentifier, 
@ApplicationName nvarchar(255), 
@Major int, 
@Minor int, 
@Build int, 
@Revision int 


AS

UPDATE 		[dbo].[mp_SchemaVersion] 

SET
			[ApplicationName] = @ApplicationName,
			[Major] = @Major,
			[Minor] = @Minor,
			[Build] = @Build,
			[Revision] = @Revision
			
WHERE
			[ApplicationID] = @ApplicationID
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoZone_GetCountByCountry]    Script Date: 11/10/2008 11:50:27 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoZone_GetCountByCountry]

/*
Author:   			
Created: 			2008-06-22
Last Modified: 		2008-06-22
*/

@CountryGuid uniqueidentifier

AS


SELECT COUNT(*)
		
FROM
		[dbo].[mp_GeoZone]
		
WHERE
		[CountryGuid] = @CountryGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoZone_Insert]    Script Date: 11/10/2008 11:50:28 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoZone_Insert]

/*
Author:   			
Created: 			2/16/2007
Last Modified: 		2/16/2007
*/

@Guid uniqueidentifier,
@CountryGuid uniqueidentifier,
@Name nvarchar(255),
@Code nvarchar(255)

	
AS

INSERT INTO 	[dbo].[mp_GeoZone] 
(
				[Guid],
				[CountryGuid],
				[Name],
				[Code]
) 

VALUES 
(
				@Guid,
				@CountryGuid,
				@Name,
				@Code
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoZone_SelectByCode]    Script Date: 11/10/2008 11:50:28 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoZone_SelectByCode]

/*
Author:   			
Created: 			2008-07-08
Last Modified: 		2008-07-08
*/

@CountryGuid uniqueidentifier,
@Code	nvarchar(255)

AS


SELECT TOP 1 *
		
FROM
		[dbo].[mp_GeoZone]
		
WHERE
		[CountryGuid] = @CountryGuid
		AND [Code] = @Code
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoZone_Update]    Script Date: 11/10/2008 11:50:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoZone_Update]

/*
Author:   			
Created: 			2/16/2007
Last Modified: 		2/16/2007
*/
	
@Guid uniqueidentifier, 
@CountryGuid uniqueidentifier, 
@Name nvarchar(255), 
@Code nvarchar(255) 


AS

UPDATE 		[dbo].[mp_GeoZone] 

SET
			[CountryGuid] = @CountryGuid,
			[Name] = @Name,
			[Code] = @Code
			
WHERE
			[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoZone_SelectByCountry]    Script Date: 11/10/2008 11:50:28 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoZone_SelectByCountry]

/*
Author:   			
Created: 			2/16/2007
Last Modified: 		2/16/2007
*/

@CountryGuid uniqueidentifier

AS


SELECT
		[Guid],
		[CountryGuid],
		[Name],
		[Code]
		
FROM
		[dbo].[mp_GeoZone]

WHERE CountryGuid = @CountryGuid

ORDER BY [Name]
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoZone_SelectOne]    Script Date: 11/10/2008 11:50:28 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoZone_SelectOne]

/*
Author:   			
Created: 			2/16/2007
Last Modified: 		2/16/2007
*/

@Guid uniqueidentifier

AS


SELECT
		[Guid],
		[CountryGuid],
		[Name],
		[Code]
		
FROM
		[dbo].[mp_GeoZone]
		
WHERE
		[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoZone_Delete]    Script Date: 11/10/2008 11:50:27 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoZone_Delete]

/*
Author:   			
Created: 			2/16/2007
Last Modified: 		2/16/2007
*/

@Guid uniqueidentifier

AS

DELETE FROM [dbo].[mp_GeoZone]
WHERE
	[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterInfo_SelectOne]    Script Date: 11/10/2008 11:50:47 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterInfo_SelectOne]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterInfoGuid uniqueidentifier

AS


SELECT
		[LetterInfoGuid],
		[SiteGuid],
		[Title],
		[Description],
		[AvailableToRoles],
		[Enabled],
		[AllowUserFeedback],
		[AllowAnonFeedback],
		[FromAddress],
		[FromName],
		[ReplyToAddress],
		[SendMode],
		[EnableViewAsWebPage],
		[EnableSendLog],
		[RolesThatCanEdit],
		[RolesThatCanApprove],
		[RolesThatCanSend],
		[SubscriberCount],
		[CreatedUTC],
		[CreatedBy],
		[LastModUTC],
		[LastModBy]
		
FROM
		[dbo].[mp_LetterInfo]
		
WHERE
		[LetterInfoGuid] = @LetterInfoGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterInfo_UpdateSubscriberCount]    Script Date: 11/10/2008 11:50:48 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterInfo_UpdateSubscriberCount]

/*
Author:   			
Created: 			2008-01-07
Last Modified: 		2008-01-07
*/

@LetterInfoGuid uniqueidentifier

	
AS

UPDATE	[dbo].[mp_LetterInfo]
SET SubscriberCount = (SELECT COUNT(*) FROM [dbo].[mp_LetterSubscriber] WHERE LetterInfoGuid = @LetterInfoGuid)
WHERE LetterInfoGuid = @LetterInfoGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterInfo_Update]    Script Date: 11/10/2008 11:50:48 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterInfo_Update]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/
	
@LetterInfoGuid uniqueidentifier, 
@SiteGuid uniqueidentifier, 
@Title nvarchar(255), 
@Description ntext, 
@AvailableToRoles ntext, 
@Enabled bit, 
@AllowUserFeedback bit, 
@AllowAnonFeedback bit, 
@FromAddress nvarchar(255), 
@FromName nvarchar(255), 
@ReplyToAddress nvarchar(255), 
@SendMode int, 
@EnableViewAsWebPage bit, 
@EnableSendLog bit, 
@RolesThatCanEdit ntext, 
@RolesThatCanApprove ntext, 
@RolesThatCanSend ntext, 
@CreatedUTC datetime, 
@CreatedBy uniqueidentifier, 
@LastModUTC datetime, 
@LastModBy uniqueidentifier 


AS

UPDATE 		[dbo].[mp_LetterInfo] 

SET
			[SiteGuid] = @SiteGuid,
			[Title] = @Title,
			[Description] = @Description,
			[AvailableToRoles] = @AvailableToRoles,
			[Enabled] = @Enabled,
			[AllowUserFeedback] = @AllowUserFeedback,
			[AllowAnonFeedback] = @AllowAnonFeedback,
			[FromAddress] = @FromAddress,
			[FromName] = @FromName,
			[ReplyToAddress] = @ReplyToAddress,
			[SendMode] = @SendMode,
			[EnableViewAsWebPage] = @EnableViewAsWebPage,
			[EnableSendLog] = @EnableSendLog,
			[RolesThatCanEdit] = @RolesThatCanEdit,
			[RolesThatCanApprove] = @RolesThatCanApprove,
			[RolesThatCanSend] = @RolesThatCanSend,
			[CreatedUTC] = @CreatedUTC,
			[CreatedBy] = @CreatedBy,
			[LastModUTC] = @LastModUTC,
			[LastModBy] = @LastModBy
			
WHERE
			[LetterInfoGuid] = @LetterInfoGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterInfo_SelectAll]    Script Date: 11/10/2008 11:50:46 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterInfo_SelectAll]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@SiteGuid	uniqueidentifier

AS


SELECT
		[LetterInfoGuid],
		[SiteGuid],
		[Title],
		[Description],
		[AvailableToRoles],
		[Enabled],
		[AllowUserFeedback],
		[AllowAnonFeedback],
		[FromAddress],
		[FromName],
		[ReplyToAddress],
		[SendMode],
		[EnableViewAsWebPage],
		[EnableSendLog],
		[RolesThatCanEdit],
		[RolesThatCanApprove],
		[RolesThatCanSend],
		[CreatedUTC],
		[CreatedBy],
		[LastModUTC],
		[LastModBy],
		[SubscriberCount]
		
FROM
		[dbo].[mp_LetterInfo]

WHERE
		[SiteGuid] = @SiteGuid

ORDER BY	[Title]
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterInfo_GetCount]    Script Date: 11/10/2008 11:50:45 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterInfo_GetCount]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@SiteGuid uniqueidentifier

AS

SELECT COUNT(*) FROM [dbo].[mp_LetterInfo]
WHERE [SiteGuid] = @SiteGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterInfo_Delete]    Script Date: 11/10/2008 11:50:45 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterInfo_Delete]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterInfoGuid uniqueidentifier

AS

DELETE FROM [dbo].[mp_LetterInfo]
WHERE
	[LetterInfoGuid] = @LetterInfoGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterInfo_Insert]    Script Date: 11/10/2008 11:50:46 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterInfo_Insert]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterInfoGuid uniqueidentifier,
@SiteGuid uniqueidentifier,
@Title nvarchar(255),
@Description ntext,
@AvailableToRoles ntext,
@Enabled bit,
@AllowUserFeedback bit,
@AllowAnonFeedback bit,
@FromAddress nvarchar(255),
@FromName nvarchar(255),
@ReplyToAddress nvarchar(255),
@SendMode int,
@EnableViewAsWebPage bit,
@EnableSendLog bit,
@RolesThatCanEdit ntext,
@RolesThatCanApprove ntext,
@RolesThatCanSend ntext,
@CreatedUTC datetime,
@CreatedBy uniqueidentifier,
@LastModUTC datetime,
@LastModBy uniqueidentifier

	
AS

INSERT INTO 	[dbo].[mp_LetterInfo] 
(
				[LetterInfoGuid],
				[SiteGuid],
				[Title],
				[Description],
				[AvailableToRoles],
				[Enabled],
				[AllowUserFeedback],
				[AllowAnonFeedback],
				[FromAddress],
				[FromName],
				[ReplyToAddress],
				[SendMode],
				[EnableViewAsWebPage],
				[EnableSendLog],
				[RolesThatCanEdit],
				[RolesThatCanApprove],
				[RolesThatCanSend],
				[CreatedUTC],
				[CreatedBy],
				[LastModUTC],
				[LastModBy]
) 

VALUES 
(
				@LetterInfoGuid,
				@SiteGuid,
				@Title,
				@Description,
				@AvailableToRoles,
				@Enabled,
				@AllowUserFeedback,
				@AllowAnonFeedback,
				@FromAddress,
				@FromName,
				@ReplyToAddress,
				@SendMode,
				@EnableViewAsWebPage,
				@EnableSendLog,
				@RolesThatCanEdit,
				@RolesThatCanApprove,
				@RolesThatCanSend,
				@CreatedUTC,
				@CreatedBy,
				@LastModUTC,
				@LastModBy
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_ContentRating_GetCountByContentAndIPAddress]    Script Date: 11/10/2008 11:52:10 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ContentRating_GetCountByContentAndIPAddress]

/*
Author:   			
Created: 			2008-10-07
Last Modified: 		2008-10-07
*/

@ContentGuid uniqueidentifier,
@IpAddress nvarchar(50),
@BeginUtc datetime

AS

SELECT COUNT(*) 
FROM [dbo].[mp_ContentRating]
WHERE [ContentGuid] = @ContentGuid
		AND [UserGuid] = '00000000-0000-0000-0000-000000000000'
		AND [IpAddress] = @IpAddress
		AND CreatedUtc > @BeginUtc
GO
/****** Object:  StoredProcedure [dbo].[mp_ContentRating_SelectOneByContentAndUser]    Script Date: 11/10/2008 11:50:20 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ContentRating_SelectOneByContentAndUser]

/*
Author:   			
Created: 			2008-10-06
Last Modified: 		2008-10-06
*/

@ContentGuid uniqueidentifier,
@UserGuid uniqueidentifier

AS


SELECT *
		
FROM
		[dbo].[mp_ContentRating]
		
WHERE
		[ContentGuid] = @ContentGuid
		AND [UserGuid] = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_ContentRating_DeleteBySite]    Script Date: 11/10/2008 11:52:09 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ContentRating_DeleteBySite]

/*
Author:   			
Created: 			2008-10-06
Last Modified: 		2008-10-06
*/

@SiteGuid uniqueidentifier

AS

DELETE FROM [dbo].[mp_ContentRating]
WHERE
	[SiteGuid] = @SiteGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_ContentRating_DeleteByUser]    Script Date: 11/10/2008 11:52:09 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ContentRating_DeleteByUser]

/*
Author:   			
Created: 			2008-10-06
Last Modified: 		2008-10-06
*/

@UserGuid uniqueidentifier

AS

DELETE FROM [dbo].[mp_ContentRating]
WHERE
	[UserGuid] = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_ContentRating_DeleteByContent]    Script Date: 11/10/2008 11:52:09 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ContentRating_DeleteByContent]

/*
Author:   			
Created: 			2008-10-06
Last Modified: 		2008-10-06
*/

@ContentGuid uniqueidentifier

AS

DELETE FROM [dbo].[mp_ContentRating]
WHERE
	[ContentGuid] = @ContentGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_ContentRating_GetCountByContentAndUser]    Script Date: 11/10/2008 11:50:18 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ContentRating_GetCountByContentAndUser]

/*
Author:   			
Created: 			2008-10-06
Last Modified: 		2008-10-06
*/

@ContentGuid uniqueidentifier,
@UserGuid uniqueidentifier

AS

SELECT COUNT(*) 
FROM [dbo].[mp_ContentRating]
WHERE [ContentGuid] = @ContentGuid
		AND [UserGuid] = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_ContentRating_Insert]    Script Date: 11/10/2008 11:50:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ContentRating_Insert]

/*
Author:   			
Created: 			2008-10-06
Last Modified: 		2008-10-06
*/

@RowGuid uniqueidentifier,
@SiteGuid uniqueidentifier,
@ContentGuid uniqueidentifier,
@UserGuid uniqueidentifier,
@EmailAddress nvarchar(100),
@Rating int,
@Comments ntext,
@IpAddress nvarchar(50),
@CreatedUtc datetime,
@LastModUtc datetime

	
AS

INSERT INTO 	[dbo].[mp_ContentRating] 
(
				[RowGuid],
				[SiteGuid],
				[ContentGuid],
				[UserGuid],
				[EmailAddress],
				[Rating],
				[Comments],
				[IpAddress],
				[CreatedUtc],
				[LastModUtc]
) 

VALUES 
(
				@RowGuid,
				@SiteGuid,
				@ContentGuid,
				@UserGuid,
				@EmailAddress,
				@Rating,
				@Comments,
				@IpAddress,
				@CreatedUtc,
				@LastModUtc
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_ContentRating_Delete]    Script Date: 11/10/2008 11:52:09 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ContentRating_Delete]

/*
Author:   			
Created: 			2008-10-06
Last Modified: 		2008-10-06
*/

@RowGuid uniqueidentifier

AS

DELETE FROM [dbo].[mp_ContentRating]
WHERE
	[RowGuid] = @RowGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_ContentRating_GetCountByContent]    Script Date: 11/10/2008 11:52:09 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ContentRating_GetCountByContent]

/*
Author:   			
Created: 			2008-10-06
Last Modified: 		2008-10-06
*/

@ContentGuid uniqueidentifier

AS

SELECT COUNT(*) 
FROM [dbo].[mp_ContentRating]
WHERE [ContentGuid] = @ContentGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_ContentRating_GetStatsByContent]    Script Date: 11/10/2008 11:50:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ContentRating_GetStatsByContent]

/*
Author:   			
Created: 			2008-10-06
Last Modified: 		2008-10-06
*/

@ContentGuid uniqueidentifier

AS

SELECT 
COALESCE(AVG(Rating),0) As CurrentRating,
Count(*) As TotalRatings

FROM [dbo].[mp_ContentRating]

WHERE [ContentGuid] = @ContentGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_ContentRating_SelectOne]    Script Date: 11/10/2008 11:50:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ContentRating_SelectOne]

/*
Author:   			
Created: 			2008-10-06
Last Modified: 		2008-10-06
*/

@RowGuid uniqueidentifier

AS


SELECT *
		
FROM
		[dbo].[mp_ContentRating]
		
WHERE
		[RowGuid] = @RowGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_ContentRating_Update]    Script Date: 11/10/2008 11:50:20 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ContentRating_Update]

/*
Author:   			
Created: 			2008-10-06
Last Modified: 		2008-10-06
*/
	
@RowGuid uniqueidentifier, 
@EmailAddress nvarchar(100), 
@Rating int, 
@Comments ntext, 
@IpAddress nvarchar(50), 
@LastModUtc datetime 


AS

UPDATE 		[dbo].[mp_ContentRating] 

SET
			
			[EmailAddress] = @EmailAddress,
			[Rating] = @Rating,
			[Comments] = @Comments,
			[IpAddress] = @IpAddress,
			[LastModUtc] = @LastModUtc
			
WHERE
			[RowGuid] = @RowGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_SchemaScriptHistory_Insert]    Script Date: 11/10/2008 11:51:18 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SchemaScriptHistory_Insert]

/*
Author:   			
Created: 			1/30/2007
Last Modified: 		1/30/2007
*/

@ApplicationID uniqueidentifier,
@ScriptFile nvarchar(255),
@RunTime datetime,
@ErrorOccurred bit,
@ErrorMessage ntext,
@ScriptBody ntext

	
AS

INSERT INTO 	[dbo].[mp_SchemaScriptHistory] 
(
				[ApplicationID],
				[ScriptFile],
				[RunTime],
				[ErrorOccurred],
				[ErrorMessage],
				[ScriptBody]
) 

VALUES 
(
				@ApplicationID,
				@ScriptFile,
				@RunTime,
				@ErrorOccurred,
				@ErrorMessage,
				@ScriptBody
				
)
SELECT @@IDENTITY
GO
/****** Object:  StoredProcedure [dbo].[mp_SchemaScriptHistory_Delete]    Script Date: 11/10/2008 11:51:18 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SchemaScriptHistory_Delete]

/*
Author:   			
Created: 			1/30/2007
Last Modified: 		1/30/2007
*/

@ID int

AS

DELETE FROM [dbo].[mp_SchemaScriptHistory]
WHERE
	[ID] = @ID
GO
/****** Object:  StoredProcedure [dbo].[mp_SchemaScriptHistory_SelectOne]    Script Date: 11/10/2008 11:51:19 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SchemaScriptHistory_SelectOne]

/*
Author:   			
Created: 			1/30/2007
Last Modified: 		1/30/2007
*/

@ID int

AS


SELECT
		[ID],
		[ApplicationID],
		[ScriptFile],
		[RunTime],
		[ErrorOccurred],
		[ErrorMessage],
		[ScriptBody]
		
FROM
		[dbo].[mp_SchemaScriptHistory]
		
WHERE
		[ID] = @ID
GO
/****** Object:  StoredProcedure [dbo].[mp_SchemaScriptHistory_SelectByApp]    Script Date: 11/10/2008 11:51:18 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SchemaScriptHistory_SelectByApp]

/*
Author:   			
Created: 			1/30/2007
Last Modified: 		1/30/2007
*/

@ApplicationID uniqueidentifier

AS


SELECT
		[ID],
		[ApplicationID],
		[ScriptFile],
		[RunTime],
		[ErrorOccurred],
		[ErrorMessage],
		[ScriptBody]
		
FROM
		[dbo].[mp_SchemaScriptHistory]

WHERE 
		[ApplicationID] = @ApplicationID
		-- AND [ErrorOccurred] = 0

ORDER BY [ID]
GO
/****** Object:  StoredProcedure [dbo].[mp_SchemaScriptHistory_Exists]    Script Date: 11/10/2008 11:51:18 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SchemaScriptHistory_Exists]

/*
Author:			
Created:		1/30/2007
Last Modified:	1/30/2007

*/
    
@ApplicationID uniqueidentifier,
@ScriptFile		nvarchar(255)

AS
IF EXISTS (	SELECT 	[ID]
		FROM		mp_SchemaScriptHistory
		WHERE	[ApplicationID] = @ApplicationID
				AND [ScriptFile] = @ScriptFile )
SELECT 1
ELSE
SELECT 0
GO
/****** Object:  StoredProcedure [dbo].[mp_SchemaScriptHistory_SelectErrorsByApp]    Script Date: 11/10/2008 11:51:19 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SchemaScriptHistory_SelectErrorsByApp]

/*
Author:   			
Created: 			1/30/2007
Last Modified: 		1/30/2007
*/

@ApplicationID uniqueidentifier

AS


SELECT
		[ID],
		[ApplicationID],
		[ScriptFile],
		[RunTime],
		[ErrorOccurred],
		[ErrorMessage],
		[ScriptBody]
		
FROM
		[dbo].[mp_SchemaScriptHistory]

WHERE 
		[ApplicationID] = @ApplicationID
		AND [ErrorOccurred] = 1

ORDER BY [ID]
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSubscriber_DeleteByLetter]    Script Date: 11/10/2008 11:50:51 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterSubscriber_DeleteByLetter]

/*
Author:   			
Created: 			2008-10-07
Last Modified: 		2008-10-07
*/

@LetterInfoGuid uniqueidentifier

AS

DELETE
		
FROM
		[dbo].[mp_LetterSubscriber]
		
WHERE
		[LetterInfoGuid] = @LetterInfoGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSubscriber_SelectByLetter]    Script Date: 11/10/2008 11:50:51 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterSubscriber_SelectByLetter]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterInfoGuid uniqueidentifier

AS

SELECT
		ls.[LetterInfoGuid],
		ls.[UserGuid],
		ls.[UseHtml],
		ls.[BeginUTC],
		u.[Email],
		u.[Name]
		
FROM
		[dbo].[mp_LetterSubscriber] ls

JOIN
		[dbo].[mp_Users] u
ON		
		u.[UserGuid] = ls.[UserGuid]
		
WHERE
		ls.[LetterInfoGuid] = @LetterInfoGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSubscriber_SelectByUser]    Script Date: 11/10/2008 11:50:52 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterSubscriber_SelectByUser]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@UserGuid uniqueidentifier

AS


SELECT
		ls.[LetterInfoGuid],
		ls.[UserGuid],
		ls.[UseHtml],
		ls.[BeginUTC],
		u.[Email],
		u.[Name]
		
FROM
		[dbo].[mp_LetterSubscriber] ls

JOIN
		[dbo].[mp_Users] u
ON		
		u.[UserGuid] = ls.[UserGuid]
		
WHERE
		ls.[UserGuid] = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSubscriber_CountByLetter]    Script Date: 11/10/2008 11:50:50 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterSubscriber_CountByLetter]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterInfoGuid uniqueidentifier

AS


SELECT Count(*)
		
FROM
		[dbo].[mp_LetterSubscriber]
		
WHERE
		[LetterInfoGuid] = @LetterInfoGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSubscriber_Delete]    Script Date: 11/10/2008 11:50:51 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterSubscriber_Delete]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterInfoGuid uniqueidentifier,
@UserGuid uniqueidentifier

AS

DELETE
		
FROM
		[dbo].[mp_LetterSubscriber]
		
WHERE
		[LetterInfoGuid] = @LetterInfoGuid
		AND [UserGuid] = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSubscriber_Insert]    Script Date: 11/10/2008 11:50:51 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterSubscriber_Insert]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterInfoGuid uniqueidentifier,
@UserGuid uniqueidentifier,
@UseHtml bit,
@BeginUTC datetime

	
AS

INSERT INTO 	[dbo].[mp_LetterSubscriber] 
(
				[LetterInfoGuid],
				[UserGuid],
				[UseHtml],
				[BeginUTC]
) 

VALUES 
(
				@LetterInfoGuid,
				@UserGuid,
				@UseHtml,
				@BeginUTC
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSubscriber_SelectUnsentByLetter]    Script Date: 11/10/2008 11:50:52 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterSubscriber_SelectUnsentByLetter]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterGuid uniqueidentifier,
@LetterInfoGuid uniqueidentifier

AS


SELECT
		ls.[LetterInfoGuid],
		ls.[UserGuid],
		ls.[UseHtml],
		ls.[BeginUTC],
		u.[Email],
		u.[Name]
		
FROM
		[dbo].[mp_LetterSubscriber] ls

JOIN
		[dbo].[mp_Users] u
ON		
		u.[UserGuid] = ls.[UserGuid]
		
WHERE
		ls.[LetterInfoGuid] = @LetterInfoGuid
		AND ls.[UserGuid] NOT IN ( SELECT [UserGuid]
									FROM	[dbo].[mp_LetterSendLog]
									WHERE [LetterGuid] = @LetterGuid )
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSubscriber_SelectOne]    Script Date: 11/10/2008 11:50:52 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterSubscriber_SelectOne]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterInfoGuid uniqueidentifier,
@UserGuid uniqueidentifier

AS


SELECT
		ls.[LetterInfoGuid],
		ls.[UserGuid],
		ls.[UseHtml],
		ls.[BeginUTC],
		u.[Email],
		u.[Name]
		
FROM
		[dbo].[mp_LetterSubscriber] ls

JOIN
		[dbo].[mp_Users] u
ON		
		u.[UserGuid] = ls.[UserGuid]
		
WHERE
		ls.[LetterInfoGuid] = @LetterInfoGuid
		AND ls.[UserGuid] = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_IndexingQueue_Insert]    Script Date: 11/10/2008 11:50:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_IndexingQueue_Insert]

/*
Author:   			
Created: 			2008-6-18
Last Modified: 		2008-6-18
*/

@IndexPath nvarchar(255),
@SerializedItem ntext,
@ItemKey nvarchar(255),
@RemoveOnly bit

	
AS

INSERT INTO 	[dbo].[mp_IndexingQueue] 
(
				[IndexPath],
				[SerializedItem],
				[ItemKey],
				[RemoveOnly]
) 

VALUES 
(
				@IndexPath,
				@SerializedItem,
				@ItemKey,
				@RemoveOnly
				
)
SELECT @@IDENTITY
GO
/****** Object:  StoredProcedure [dbo].[mp_IndexingQueue_GetCount]    Script Date: 11/10/2008 11:50:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_IndexingQueue_GetCount]

/*
Author:   			
Created: 			2008-6-20
Last Modified: 		2008-6-20
*/

AS

SELECT COUNT(*) FROM [dbo].[mp_IndexingQueue]
GO
/****** Object:  StoredProcedure [dbo].[mp_IndexingQueue_SelectDistinctPaths]    Script Date: 11/10/2008 11:50:38 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_IndexingQueue_SelectDistinctPaths]

/*
Author:   			
Created: 			2008-6-18
Last Modified: 		2008-6-18
*/

AS


SELECT DISTINCT
		
		[IndexPath]
		
FROM
		[dbo].[mp_IndexingQueue]
		
ORDER BY [IndexPath]
GO
/****** Object:  StoredProcedure [dbo].[mp_IndexingQueue_SelectByPath]    Script Date: 11/10/2008 11:50:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_IndexingQueue_SelectByPath]

/*
Author:   			
Created: 			2008-6-18
Last Modified: 		2008-6-18
*/

@IndexPath nvarchar(255)

AS


SELECT *
		
FROM
		[dbo].[mp_IndexingQueue]
		
WHERE
		[IndexPath] = @IndexPath

ORDER BY RowId
GO
/****** Object:  StoredProcedure [dbo].[mp_IndexingQueue_Delete]    Script Date: 11/10/2008 11:50:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_IndexingQueue_Delete]

/*
Author:   			
Created: 			2008-6-18
Last Modified: 		2008-6-18
*/

@RowId bigint

AS

DELETE FROM [dbo].[mp_IndexingQueue]
WHERE
	[RowId] = @RowId
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleSettings_SyncDefinitions]    Script Date: 11/10/2008 11:51:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleSettings_SyncDefinitions]

AS

UPDATE mp_ModuleSettings
SET ControlSrc = (SELECT TOP 1 mds.ControlSrc
				FROM mp_ModuleDefinitionSettings mds
				WHERE mds.ModuleDefId IN (SELECT ModuleDefId
										FROM mp_Modules m
										WHERE m.ModuleID = mp_ModuleSettings.ModuleID)
				AND mds.SettingName = mp_ModuleSettings.SettingName
				)

UPDATE mp_ModuleSettings
SET ControlType = (SELECT TOP 1 mds.ControlType
				FROM mp_ModuleDefinitionSettings mds
				WHERE mds.ModuleDefId IN (SELECT ModuleDefId
										FROM mp_Modules m
										WHERE m.ModuleID = mp_ModuleSettings.ModuleID)
				AND mds.SettingName = mp_ModuleSettings.SettingName
				)

UPDATE mp_ModuleSettings
SET SortOrder = (SELECT TOP 1 mds.SortOrder
				FROM mp_ModuleDefinitionSettings mds
				WHERE mds.ModuleDefId IN (SELECT ModuleDefId
										FROM mp_Modules m
										WHERE m.ModuleID = mp_ModuleSettings.ModuleID)
				AND mds.SettingName = mp_ModuleSettings.SettingName
				)

UPDATE ms
SET ms.RegexValidationExpression = mds.RegexValidationExpression
FROM mp_ModuleSettings ms
JOIN mp_Modules m
ON ms.ModuleID = m.ModuleID
JOIN mp_ModuleDefinitionSettings mds
ON ms.SettingName = mds.SettingName
AND m.ModuleDefId = mds.ModuleDefId


UPDATE mp_ModuleSettings
SET HelpKey = (SELECT TOP 1 mds.HelpKey
				FROM mp_ModuleDefinitionSettings mds
				WHERE mds.ModuleDefId IN (SELECT ModuleDefId
										FROM mp_Modules m
										WHERE m.ModuleID = mp_ModuleSettings.ModuleID)
				AND mds.SettingName = mp_ModuleSettings.SettingName
				)
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleSettings_Select]    Script Date: 11/10/2008 11:51:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleSettings_Select]
(
    @ModuleID int
)
AS

DECLARE @ModuleDefID int
SELECT @ModuleDefID = ModuleDefID 
FROM mp_Modules 
WHERE ModuleID = @ModuleID

SELECT 	ms.*,
		mds.FeatureGuid,
		mds.ResourceFile

FROM		mp_ModuleSettings ms

JOIN		mp_ModuleDefinitionSettings mds
ON			mds.ModuleDefID = @ModuleDefID
			AND mds.SettingName = ms.SettingName

WHERE	ms.ModuleID = @ModuleID

ORDER BY ms.SortOrder
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleSettings_CreateDefaultSettings]    Script Date: 11/10/2008 11:51:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_ModuleSettings_CreateDefaultSettings]

/*
Author:			
Created:		1/1/2005
Last Modified:	2008-01-29

*/



@ModuleID		int


AS

INSERT INTO 	mp_ModuleSettings
(
			ModuleID,
			SettingName,
			SettingValue,
			ControlType,
			RegexValidationExpression,
			ModuleGuid,
			SettingGuid,
			ControlSrc,
			HelpKey,
			SortOrder
)

SELECT		m.ModuleID,
			ds.SettingName,
			ds.SettingValue,
			ds.ControlType,
			ds.RegexValidationExpression,
			m.[Guid],
			newid(),
			ds.ControlSrc,
			ds.HelpKey,
			ds.SortOrder


FROM			mp_Modules m

JOIN			mp_ModuleDefinitionSettings ds
ON			ds.ModuleDefID = m.ModuleDefID

WHERE		m.ModuleID = @ModuleID

ORDER BY		ds.[ID]
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleDefinitionSettings_SelectOne]    Script Date: 11/10/2008 11:50:55 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleDefinitionSettings_SelectOne]
(
    @FeatureGuid uniqueidentifier,
	@SettingName nvarchar(50)
	
)
AS

SELECT
    *

FROM
    mp_ModuleDefinitionSettings

WHERE
    FeatureGuid = @FeatureGuid
	AND SettingName = @SettingName
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleDefinitionSettings_Select]    Script Date: 11/10/2008 11:50:55 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleDefinitionSettings_Select]
(
    @ModuleDefID int
)
AS

SELECT
    *

FROM
    mp_ModuleDefinitionSettings

WHERE
    ModuleDefID = @ModuleDefID

ORDER BY SortOrder
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleDefinitionSettings_UpdateByID]    Script Date: 11/10/2008 11:50:57 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleDefinitionSettings_UpdateByID]

@ID						int,
@ModuleDefID      		int,
@SettingName   		nvarchar(50),
@SettingValue  			nvarchar(255),
@ControlType   			nvarchar(50),
@RegexValidationExpression 	ntext,
@ResourceFile nvarchar(255),
@ControlSrc	nvarchar(255),
@HelpKey	nvarchar(255),
@SortOrder	int

AS

UPDATE
    mp_ModuleDefinitionSettings

SET
    ResourceFile = @ResourceFile,
	SettingName = @SettingName,
    SettingValue = @SettingValue,
	ControlType = @ControlType,
	RegexValidationExpression = @RegexValidationExpression,
	ControlSrc = @ControlSrc,
	HelpKey = @HelpKey,
	SortOrder = @SortOrder

WHERE
    ID = @ID AND ModuleDefID = @ModuleDefID
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleDefinitionSettings_DeleteByID]    Script Date: 11/10/2008 11:50:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleDefinitionSettings_DeleteByID]

    
@ID int

AS
DELETE FROM
    mp_ModuleDefinitionSettings

WHERE
    ID = @ID
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleDefinitionSettings_Update]    Script Date: 11/10/2008 11:50:56 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleDefinitionSettings_Update]

@ModuleDefID      		int,
@SettingName   		nvarchar(50),
@SettingValue  			nvarchar(255),
@ControlType   			nvarchar(50),
@RegexValidationExpression 	ntext,
@FeatureGuid uniqueidentifier,
@ResourceFile nvarchar(255),
@ControlSrc	nvarchar(255),
@HelpKey	nvarchar(255),
@SortOrder	int

AS

IF NOT EXISTS (
    SELECT 
        * 
    FROM 
        mp_ModuleDefinitionSettings 
    WHERE 
        (ModuleDefID = @ModuleDefID OR FeatureGuid = @FeatureGuid)
      AND
        SettingName = @SettingName
)
INSERT INTO mp_ModuleDefinitionSettings (
	FeatureGuid,
    ModuleDefID,
	ResourceFile,
    SettingName,
    SettingValue,
	ControlType,
	RegexValidationExpression,
	ControlSrc,
	HelpKey,
	SortOrder
) 
VALUES (
	@FeatureGuid,
    @ModuleDefID,
	@ResourceFile,
    @SettingName,
    @SettingValue,
	@ControlType,
	@RegexValidationExpression,
	@ControlSrc,
	@HelpKey,
	@SortOrder
)
ELSE
UPDATE
    mp_ModuleDefinitionSettings

SET
	FeatureGuid = @FeatureGuid,
    SettingValue = @SettingValue,
	ControlType = @ControlType,
	RegexValidationExpression = @RegexValidationExpression,
	ResourceFile = @ResourceFile,
	ControlSrc = @ControlSrc,
	HelpKey = @HelpKey,
	SortOrder = @SortOrder

WHERE
    (ModuleDefID = @ModuleDefID OR FeatureGuid = @FeatureGuid)
  AND
    SettingName = @SettingName
GO
/****** Object:  StoredProcedure [dbo].[mp_Letter_Insert]    Script Date: 11/10/2008 11:50:41 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Letter_Insert]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterGuid uniqueidentifier,
@LetterInfoGuid uniqueidentifier,
@Subject nvarchar(255),
@HtmlBody ntext,
@TextBody ntext,
@CreatedBy uniqueidentifier,
@CreatedUTC datetime,
@LastModBy uniqueidentifier,
@LastModUTC datetime,
@IsApproved bit,
@ApprovedBy uniqueidentifier

	
AS

INSERT INTO 	[dbo].[mp_Letter] 
(
				[LetterGuid],
				[LetterInfoGuid],
				[Subject],
				[HtmlBody],
				[TextBody],
				[CreatedBy],
				[CreatedUTC],
				[LastModBy],
				[LastModUTC],
				[IsApproved],
				[ApprovedBy]
) 

VALUES 
(
				@LetterGuid,
				@LetterInfoGuid,
				@Subject,
				@HtmlBody,
				@TextBody,
				@CreatedBy,
				@CreatedUTC,
				@LastModBy,
				@LastModUTC,
				@IsApproved,
				@ApprovedBy
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_Letter_UpdateSendComplete]    Script Date: 11/10/2008 11:50:43 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Letter_UpdateSendComplete]

/*
Author:   			
Created: 			2007-09-22
Last Modified: 		2007-12-13
*/
	
@LetterGuid uniqueidentifier, 
@SendCompleteUTC datetime,
@SendCount	int


AS

UPDATE 		[dbo].[mp_Letter] 

SET
			[SendCompleteUTC] = @SendCompleteUTC,
			[SendCount] = @SendCount
			
				
WHERE
			[LetterGuid] = @LetterGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Letter_UpdateSendClicked]    Script Date: 11/10/2008 11:50:42 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Letter_UpdateSendClicked]

/*
Author:   			
Created: 			2007-09-22
Last Modified: 		2007-12-13
*/
	
@LetterGuid uniqueidentifier, 
@SendClickedUTC datetime


AS

UPDATE 		[dbo].[mp_Letter] 

SET
			[SendClickedUTC] = @SendClickedUTC
			
				
WHERE
			[LetterGuid] = @LetterGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Letter_SelectAll]    Script Date: 11/10/2008 11:50:41 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Letter_SelectAll]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterInfoGuid uniqueidentifier

AS


SELECT
		[LetterGuid],
		[LetterInfoGuid],
		[Subject],
		[HtmlBody],
		[TextBody],
		[CreatedBy],
		[CreatedUTC],
		[LastModBy],
		[LastModUTC],
		[IsApproved],
		[ApprovedBy],
		[SendClickedUTC],
		[SendStartedUTC],
		[SendCompleteUTC],
		[SendCount]
		
FROM
		[dbo].[mp_Letter]

WHERE  [LetterInfoGuid] = @LetterInfoGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Letter_GetCountDrafts]    Script Date: 11/10/2008 11:50:40 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Letter_GetCountDrafts]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterInfoGuid uniqueidentifier

AS

SELECT COUNT(*) 
FROM [dbo].[mp_Letter]
WHERE	[LetterInfoGuid] = @LetterInfoGuid
	AND [SendClickedUTC] IS NULL
GO
/****** Object:  StoredProcedure [dbo].[mp_Letter_UpdateSendStarted]    Script Date: 11/10/2008 11:50:43 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Letter_UpdateSendStarted]

/*
Author:   			
Created: 			2007-09-22
Last Modified: 		2007-12-13
*/
	
@LetterGuid uniqueidentifier, 
@SendStartedUTC datetime


AS

UPDATE 		[dbo].[mp_Letter] 

SET
			[SendStartedUTC] = @SendStartedUTC
			
				
WHERE
			[LetterGuid] = @LetterGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Letter_Update]    Script Date: 11/10/2008 11:50:42 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Letter_Update]

/*
Author:   			
Created: 			2007-09-22
Last Modified: 		2007-12-13
*/
	
@LetterGuid uniqueidentifier, 
@LetterInfoGuid uniqueidentifier, 
@Subject nvarchar(255), 
@HtmlBody ntext, 
@TextBody ntext, 
@LastModBy uniqueidentifier, 
@LastModUTC datetime, 
@IsApproved bit,
@ApprovedBy uniqueidentifier


AS

UPDATE 		[dbo].[mp_Letter] 

SET
			[LetterInfoGuid] = @LetterInfoGuid,
			[Subject] = @Subject,
			[HtmlBody] = @HtmlBody,
			[TextBody] = @TextBody,
			[LastModBy] = @LastModBy,
			[LastModUTC] = @LastModUTC,
			[IsApproved] = @IsApproved,
			[ApprovedBy] = @ApprovedBy
			
			
WHERE
			[LetterGuid] = @LetterGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Letter_SelectOne]    Script Date: 11/10/2008 11:50:41 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Letter_SelectOne]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterGuid uniqueidentifier

AS


SELECT
		[LetterGuid],
		[LetterInfoGuid],
		[Subject],
		[HtmlBody],
		[TextBody],
		[CreatedBy],
		[CreatedUTC],
		[LastModBy],
		[LastModUTC],
		[IsApproved],
		[ApprovedBy],
		[SendClickedUTC],
		[SendStartedUTC],
		[SendCompleteUTC],
		[SendCount]
		
FROM
		[dbo].[mp_Letter]
		
WHERE
		[LetterGuid] = @LetterGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Letter_GetCount]    Script Date: 11/10/2008 11:50:40 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Letter_GetCount]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterInfoGuid uniqueidentifier

AS

SELECT COUNT(*) 
FROM [dbo].[mp_Letter]
WHERE	[LetterInfoGuid] = @LetterInfoGuid
	AND [SendClickedUTC] IS NOT NULL
GO
/****** Object:  StoredProcedure [dbo].[mp_Letter_Delete]    Script Date: 11/10/2008 11:50:39 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Letter_Delete]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterGuid uniqueidentifier

AS

DELETE FROM [dbo].[mp_Letter]
WHERE
	[LetterGuid] = @LetterGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Letter_DeleteByLetterInfo]    Script Date: 11/10/2008 11:50:40 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Letter_DeleteByLetterInfo]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterInfoGuid uniqueidentifier

AS

DELETE FROM [dbo].[mp_Letter]
WHERE
	[LetterInfoGuid] = @LetterInfoGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_WebParts_Insert]    Script Date: 11/10/2008 11:52:07 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_WebParts_Insert]

/*
Author:   			
Created: 			6/3/2006
Last Modified: 		2008-01-28
*/

@WebPartID	uniqueidentifier,
@SiteGuid	uniqueidentifier,
@SiteID int,
@Title nvarchar(255),
@Description nvarchar(255),
@ImageUrl nvarchar(255),
@ClassName nvarchar(255),
@AssemblyName nvarchar(255),
@AvailableForMyPage bit,
@AllowMultipleInstancesOnMyPage bit,
@AvailableForContentSystem bit

	
AS

INSERT INTO 	[dbo].[mp_WebParts] 
(
				[WebPartID],
				SiteGuid,
				[SiteID],
				[Title],
				[Description],
				[ImageUrl],
				[ClassName],
				[AssemblyName],
				[AvailableForMyPage],
				[AllowMultipleInstancesOnMyPage],
				[AvailableForContentSystem]
) 

VALUES 
(
				@WebPartID,
				@SiteGuid,
				@SiteID,
				@Title,
				@Description,
				@ImageUrl,
				@ClassName,
				@AssemblyName,
				@AvailableForMyPage,
				@AllowMultipleInstancesOnMyPage,
				@AvailableForContentSystem
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_WebParts_GetWebPartsForMyPage]    Script Date: 11/10/2008 11:52:06 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_WebParts_GetWebPartsForMyPage]

/*
Author:				
Created:			6/11/2006
Last Modified:		6/11/2006

*/

@SiteID		int


AS
SELECT  		m.ModuleID,
				m.SiteID,
				m.ModuleDefID,
				m.ModuleTitle,
				m.AllowMultipleInstancesOnMyPage,
				m.CountOfUseOnMyPage ,
				m.Icon As ModuleIcon,
				md.Icon As FeatureIcon,
				md.FeatureName,
				0 As IsAssembly,
				'' As WebPartID
				
				
				
				
    
FROM
    			mp_Modules m
  
INNER JOIN
    			mp_ModuleDefinitions md
ON 			m.ModuleDefID = md.ModuleDefID

WHERE   
    			m.SiteID = @SiteID
				AND m.AvailableForMyPage = 1

UNION

SELECT
				-1 As ModuleID,
				w.SiteID,
				0 As MuduleDefID,
				w.Title As ModuleTitle,
				w.AllowMultipleInstancesOnMyPage,
				w.CountOfUseOnMyPage ,
				w.ImageUrl As ModuleIcon,
				w.ImageUrl As FeatureIcon,
				w.Description As FeatureName,
				1 As IsAssembly,
				CONVERT(varchar(36),w.WebPartID) As WebPartID

FROM			mp_WebParts w

WHERE			w.SiteID = @SiteID
				AND w.AvailableForMyPage = 1
				



		
    
ORDER BY
    			ModuleTitle
GO
/****** Object:  StoredProcedure [dbo].[mp_WebParts_SelectBySite]    Script Date: 11/10/2008 11:52:07 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_WebParts_SelectBySite]

/*
Author:   			
Created: 			6/11/2006
Last Modified: 		2008-01-28
*/

@SiteID		int

AS
SELECT *
		
FROM
		[dbo].[mp_WebParts]
		
WHERE
		[SiteID] = @SiteID
		AND AvailableForContentSystem = 1
GO
/****** Object:  StoredProcedure [dbo].[mp_WebParts_UpdateCountOfUseOnMyPage]    Script Date: 11/10/2008 11:52:08 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_WebParts_UpdateCountOfUseOnMyPage]

/*
Author:   			
Created: 			6/15/2006
Last Modified: 		6/15/2006
*/
	
@WebPartID uniqueidentifier, 
@Increment	int


AS
UPDATE 		[dbo].[mp_WebParts] 

SET
			CountOfUseOnMyPage = CountOfUseOnMyPage + @Increment
			
WHERE
			[WebPartID] = @WebPartID
GO
/****** Object:  StoredProcedure [dbo].[mp_WebParts_SelectOne]    Script Date: 11/10/2008 11:52:07 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_WebParts_SelectOne]

/*
Author:   			
Created: 			6/3/2006
Last Modified: 		2008-01-28
*/

@WebPartID uniqueidentifier

AS


SELECT *
		
FROM
		[dbo].[mp_WebParts]
		
WHERE
		[WebPartID] = @WebPartID
GO
/****** Object:  StoredProcedure [dbo].[mp_WebParts_Update]    Script Date: 11/10/2008 11:52:08 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_WebParts_Update]

/*
Author:   			
Created: 			6/3/2006
Last Modified: 		6/3/2006
*/
	
@WebPartID uniqueidentifier, 
@SiteID int, 
@Title nvarchar(255), 
@Description nvarchar(255), 
@ImageUrl nvarchar(255), 
@ClassName nvarchar(255), 
@AssemblyName nvarchar(255), 
@AvailableForMyPage bit, 
@AllowMultipleInstancesOnMyPage bit, 
@AvailableForContentSystem bit 


AS

UPDATE 		[dbo].[mp_WebParts] 

SET
			[SiteID] = @SiteID,
			[Title] = @Title,
			[Description] = @Description,
			[ImageUrl] = @ImageUrl,
			[ClassName] = @ClassName,
			[AssemblyName] = @AssemblyName,
			[AvailableForMyPage] = @AvailableForMyPage,
			[AllowMultipleInstancesOnMyPage] = @AllowMultipleInstancesOnMyPage,
			[AvailableForContentSystem] = @AvailableForContentSystem
			
WHERE
			[WebPartID] = @WebPartID
GO
/****** Object:  StoredProcedure [dbo].[mp_WebParts_GetMostPopularWebPartsForMyPage]    Script Date: 11/10/2008 11:52:06 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_WebParts_GetMostPopularWebPartsForMyPage]

/*
Author:				
Created:			6/11/2006
Last Modified:		6/11/2006

*/

@SiteID		int


AS

SELECT TOP 15 dt.* 
FROM
(

SELECT  		m.ModuleID,
				m.SiteID,
				m.ModuleDefID,
				m.ModuleTitle,
				m.AllowMultipleInstancesOnMyPage,
				m.CountOfUseOnMyPage ,
				m.Icon As ModuleIcon,
				md.Icon As FeatureIcon,
				md.FeatureName,
				0 As IsAssembly,
				'' As WebPartID
				
				
				
				
    
FROM
    			mp_Modules m
  
INNER JOIN
    			mp_ModuleDefinitions md
ON 			m.ModuleDefID = md.ModuleDefID

WHERE   
    			m.SiteID = @SiteID
				AND m.AvailableForMyPage = 1

UNION

SELECT
				0 As ModuleID,
				w.SiteID,
				0 As MuduleDefID,
				w.Title As ModuleTitle,
				w.AllowMultipleInstancesOnMyPage,
				w.CountOfUseOnMyPage ,
				w.ImageUrl As ModuleIcon,
				w.ImageUrl As FeatureIcon,
				w.Description As FeatureName,
				1 As IsAssembly,
				CONVERT(varchar(36),w.WebPartID) As WebPartID

FROM			mp_WebParts w

WHERE			w.SiteID = @SiteID
				AND w.AvailableForMyPage = 1
				



		
    
--ORDER BY		CountOfUseOnMyPage DESC, ModuleTitle

) dt

ORDER BY dt.CountOfUseOnMyPage DESC, dt.ModuleTitle
GO
/****** Object:  StoredProcedure [dbo].[mp_WebParts_GetCount]    Script Date: 11/10/2008 11:52:05 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_WebParts_GetCount]

/*
Author:				
Created:			6/11/2006
Last Modified:		6/11/2006

*/

@SiteID		int


AS

SELECT Count(*)
FROM
(

SELECT  		m.ModuleID
				
				
FROM
    			mp_Modules m
  
INNER JOIN
    			mp_ModuleDefinitions md
ON 			m.ModuleDefID = md.ModuleDefID

WHERE   
    			m.SiteID = @SiteID
				AND m.AvailableForMyPage = 1

UNION

SELECT
				0 As ModuleID
				

FROM			mp_WebParts w

WHERE			w.SiteID = @SiteID
				AND w.AvailableForMyPage = 1
				


) dt
GO
/****** Object:  StoredProcedure [dbo].[mp_WebParts_WebPartExists]    Script Date: 11/10/2008 11:52:09 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_WebParts_WebPartExists]

/*
Author:			
Created:		6/7/2006
Last Modified:	6/7/2006

*/
    
@SiteID  	int,
@ClassName	nvarchar(255),
@AssemblyName	nvarchar(255)

AS
IF EXISTS (	SELECT 	WebPartID
		FROM		mp_WebParts
		WHERE	SiteID = @SiteID
				AND (ClassName = @ClassName AND AssemblyName = @AssemblyName))
SELECT 1
ELSE
SELECT 0
GO
/****** Object:  StoredProcedure [dbo].[mp_WebParts_Delete]    Script Date: 11/10/2008 11:52:05 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_WebParts_Delete]

/*
Author:   			
Created: 			6/3/2006
Last Modified: 		6/3/2006
*/

@WebPartID uniqueidentifier

AS

DELETE FROM [dbo].[mp_WebParts]
WHERE
	[WebPartID] = @WebPartID
GO
/****** Object:  StoredProcedure [dbo].[mp_Modules_SelectForMyPage]    Script Date: 11/10/2008 11:50:58 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Modules_SelectForMyPage]

/*
Author:				
Created:			2006-05-21
Last Modified:		2008-07-24

*/

@SiteID		int


AS
SELECT  		m.ModuleID,
				m.SiteID,
				m.ModuleDefID,
				m.ModuleTitle,
				m.AllowMultipleInstancesOnMyPage,
				m.HideFromUnAuth,
				m.HideFromAuth,
				m.Icon As ModuleIcon,
				md.Icon As FeatureIcon,
				md.FeatureName
				
				
				
				
    
FROM
    			mp_Modules m
  
INNER JOIN
    			mp_ModuleDefinitions md
ON 			m.ModuleDefID = md.ModuleDefID


WHERE   
    			m.SiteID = @SiteID
				AND m.AvailableForMyPage = 1
		
    
ORDER BY
    			m.ModuleTitle
GO
/****** Object:  StoredProcedure [dbo].[mp_Modules_UpdateCountOfUseOnMyPage]    Script Date: 11/10/2008 11:51:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Modules_UpdateCountOfUseOnMyPage]

/*
Author:   			
Created: 			6/15/2006
Last Modified: 		6/15/2006

*/
	
@ModuleID int, 
@Increment	int


AS
UPDATE 		[dbo].[mp_Modules] 

SET
			
			CountOfUseOnMyPage = CountOfUseOnMyPage + @Increment
			
WHERE
			[ModuleID] = @ModuleID
GO
/****** Object:  StoredProcedure [dbo].[mp_Modules_SelectOne]    Script Date: 11/10/2008 11:50:59 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Modules_SelectOne]

/*
Author:   			
Created: 			12/26/2004
Last Modified: 			12/26/2004

*/

@ModuleID int

AS


SELECT	*
		
FROM
		[dbo].[mp_Modules]
		
WHERE
		[ModuleID] = @ModuleID
GO
/****** Object:  StoredProcedure [dbo].[mp_Modules_Update]    Script Date: 11/10/2008 11:51:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Modules_Update]

/*
Author:   			
Created: 			2004-12-26
Last Modified: 		2008-07-24

*/
	
@ModuleID int, 
@ModuleDefID int, 
@ModuleTitle nvarchar(255), 
@AuthorizedEditRoles ntext, 
@CacheTime int, 
@ShowTitle bit ,
@EditUserID	int,
@AvailableForMyPage	bit,
@AllowMultipleInstancesOnMyPage	bit,
@Icon	nvarchar(255),
@HideFromAuth bit,
@HideFromUnAuth bit


AS
UPDATE 		[dbo].[mp_Modules] 

SET
			
			[ModuleDefID] = @ModuleDefID,
			
			[ModuleTitle] = @ModuleTitle,
			[AuthorizedEditRoles] = @AuthorizedEditRoles,
			[CacheTime] = @CacheTime,
			[ShowTitle] = @ShowTitle,
			EditUserID = @EditUserID,
			AvailableForMyPage = @AvailableForMyPage,
			AllowMultipleInstancesOnMyPage = @AllowMultipleInstancesOnMyPage,
			Icon = @Icon,
			HideFromAuth = @HideFromAuth,
			HideFromUnAuth = @HideFromUnAuth
			
WHERE
			[ModuleID] = @ModuleID
GO
/****** Object:  StoredProcedure [dbo].[mp_Modules_SelectOneByPage]    Script Date: 11/10/2008 11:50:59 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Modules_SelectOneByPage]

/*
Author:   			
Created: 			2004-12-26
Last Modified: 		2008-07-24

*/

@ModuleID int,
@PageID		int

AS
SELECT  		m.ModuleID,
				m.[Guid],
				m.FeatureGuid,
				m.SiteGuid,
				m.SiteID,
				m.HideFromUnAuth,
				m.HideFromAuth,
				pm.PageID,
				m.ModuleDefID,
				pm.ModuleOrder,
				pm.PaneName,
				m.ModuleTitle,
				m.AuthorizedEditRoles,
				m.CacheTime,
				m.ShowTitle,
				m.EditUserID,
				m.EditUserGuid,
				m.AvailableForMyPage,
				m.AllowMultipleInstancesOnMyPage,
				m.Icon,
				m.CreatedByUserID,
				m.CreatedDate,
				pm.PublishBeginDate,
				pm.PublishEndDate,
				md.ControlSrc
    
FROM
    			mp_Modules m
  
INNER JOIN
    			mp_ModuleDefinitions md
ON 			m.ModuleDefID = md.ModuleDefID

INNER JOIN		mp_PageModules pm
ON				m.ModuleID = pm.ModuleID
    
WHERE   
    			pm.PageID = @PageID
				AND pm.ModuleID = @ModuleID
GO
/****** Object:  StoredProcedure [dbo].[mp_Modules_Delete]    Script Date: 11/10/2008 11:50:57 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Modules_Delete]

/*
Author:   			
Created: 			12/26/2004
Last Modified: 		6/28/2006


*/

@ModuleID int

AS

DELETE FROM [dbo].[mp_PageModules]
WHERE ModuleID = @ModuleID

DELETE FROM [dbo].[mp_Modules]
WHERE ModuleID = @ModuleID
GO
/****** Object:  StoredProcedure [dbo].[mp_Modules_SelectByPage]    Script Date: 11/10/2008 11:50:58 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Modules_SelectByPage]

/*
Author:				
Created:			2004-12-26
Last Modified:		2008-07-24

*/

@PageID		int


AS
SELECT  		m.ModuleID,
				m.[Guid],
				m.FeatureGuid,
				m.SiteGuid,
				m.SiteID,
				m.HideFromUnAuth,
				m.HideFromAuth,
				pm.PageID,
				m.ModuleDefID,
				pm.ModuleOrder,
				pm.PaneName,
				m.ModuleTitle,
				m.AuthorizedEditRoles,
				m.CacheTime,
				m.ShowTitle,
				m.EditUserID,
				m.EditUserGuid,
				m.AvailableForMyPage,
				m.CreatedByUserID,
				m.CreatedDate,
				pm.PublishBeginDate,
				pm.PublishEndDate,
				md.ControlSrc,
				md.FeatureName
    
FROM
    			mp_Modules m
  
INNER JOIN
    			mp_ModuleDefinitions md
ON 			m.ModuleDefID = md.ModuleDefID

INNER JOIN		mp_PageModules pm
ON				m.ModuleID = pm.ModuleID
    
WHERE   
    			pm.PageID = @PageID
				AND pm.PublishBeginDate < GetutcDate()
				AND	(
					(pm.PublishEndDate IS NULL)
					OR
					(pm.PublishEndDate > GetutcDate())
					)
		
    
ORDER BY
    			pm.ModuleOrder
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteHosts_SelectOne]    Script Date: 11/10/2008 11:51:23 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SiteHosts_SelectOne]

/*
Author:   			
Created: 			3/6/2005
Last Modified: 		2008-01-28

*/

@HostID int

AS


SELECT	*
		
FROM
		[dbo].[mp_SiteHosts]
		
WHERE
		[HostID] = @HostID
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteHosts_Delete]    Script Date: 11/10/2008 11:51:22 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SiteHosts_Delete]

/*
Author:   			
Created: 			3/6/2005
Last Modified: 			3/6/2005


*/

@HostID int

AS

DELETE FROM [dbo].[mp_SiteHosts]
WHERE
	[HostID] = @HostID
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteHosts_Update]    Script Date: 11/10/2008 11:51:23 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SiteHosts_Update]

/*
Author:   			
Created: 			3/6/2005
Last Modified: 			3/6/2005


*/
	
@HostID int, 
@SiteID int, 
@HostName nvarchar(255) 


AS

UPDATE 		[dbo].[mp_SiteHosts] 

SET
			[SiteID] = @SiteID,
			[HostName] = @HostName
			
WHERE
			[HostID] = @HostID
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteHosts_Select]    Script Date: 11/10/2008 11:51:23 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SiteHosts_Select]

/*
Author:   			
Created: 			3/6/2005
Last Modified: 			3/13/2005


*/

@SiteID		int

AS


SELECT *
		
FROM
		[dbo].[mp_SiteHosts]

WHERE	SiteID = @SiteID
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteHosts_Insert]    Script Date: 11/10/2008 11:51:22 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SiteHosts_Insert]

/*
Author:   			
Created: 			3/6/2005
Last Modified: 		2008-01-28

*/

@SiteGuid	uniqueidentifier,
@SiteID int,
@HostName nvarchar(255)

	
AS

INSERT INTO 	[dbo].[mp_SiteHosts] 
(
				SiteGuid,
				[SiteID],
				[HostName]
) 

VALUES 
(
				@SiteGuid,
				@SiteID,
				@HostName
				
)
SELECT @@IDENTITY
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleDefinitions_SelectUserModules]    Script Date: 11/10/2008 11:50:54 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_ModuleDefinitions_SelectUserModules]

    
@SiteID  int


AS

SELECT   		md.*

FROM			mp_ModuleDefinitions md

JOIN			mp_SiteModuleDefinitions smd
ON			smd.ModuleDefID = md.ModuleDefID
    
WHERE   		smd.SiteID = @SiteID
			AND md.IsAdmin = 0

ORDER BY 		md.SortOrder, md.FeatureName
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleDefinitions_Select]    Script Date: 11/10/2008 11:50:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleDefinitions_Select]

    
@SiteGuid  uniqueidentifier


AS

SELECT   	md.*

FROM		mp_ModuleDefinitions md

JOIN		mp_SiteModuleDefinitions smd
ON		smd.FeatureGuid = md.Guid
    
WHERE   	smd.SiteGuid = @SiteGuid

ORDER BY 	md.SortOrder, md.FeatureName
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleDefinitions_SelectOneByGuid]    Script Date: 11/10/2008 11:50:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleDefinitions_SelectOneByGuid]

    
@FeatureGuid uniqueidentifier

AS

SELECT	*

FROM
    mp_ModuleDefinitions

WHERE
    [Guid] = @FeatureGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleDefinitions_Delete]    Script Date: 11/10/2008 11:52:10 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleDefinitions_Delete]

    
@ModuleDefID int

AS

DELETE FROM
    mp_ModuleDefinitions

WHERE
    ModuleDefID = @ModuleDefID
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleDefinitions_Update]    Script Date: 11/10/2008 11:50:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleDefinitions_Update]

/*
Author:   			
Created: 			2004-12-26
Last Modified: 		2007-08-06

*/
	
@ModuleDefID int, 
@FeatureName nvarchar(255), 
@ControlSrc nvarchar(255), 
@SortOrder int, 
@IsAdmin bit,
@Icon	nvarchar(255),
@DefaultCacheTime int,
@ResourceFile nvarchar(255)


AS
UPDATE 		[dbo].[mp_ModuleDefinitions] 

SET

			[FeatureName] = @FeatureName,
			[ControlSrc] = @ControlSrc,
			[SortOrder] = @SortOrder,
			DefaultCacheTime = @DefaultCacheTime,
			Icon = @Icon,
			[IsAdmin] = @IsAdmin,
			[ResourceFile] = @ResourceFile
			
WHERE
			[ModuleDefID] = @ModuleDefID
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleDefinitions_SelectOne]    Script Date: 11/10/2008 11:50:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleDefinitions_SelectOne]

    
@ModuleDefID int

AS

SELECT	*

FROM
    mp_ModuleDefinitions

WHERE
    ModuleDefID = @ModuleDefID
GO
/****** Object:  StoredProcedure [dbo].[mp_AuthorizeNetLog_SelectByCart]    Script Date: 11/10/2008 11:50:15 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_AuthorizeNetLog_SelectByCart]

/*
Author:   			
Created: 			2008-07-01
Last Modified: 		2008-07-01
*/

@CartGuid uniqueidentifier

AS


SELECT *
		
FROM
		[dbo].[mp_AuthorizeNetLog]
		
WHERE
		[CartGuid] = @CartGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_AuthorizeNetLog_SelectOne]    Script Date: 11/10/2008 11:50:15 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_AuthorizeNetLog_SelectOne]

/*
Author:   			
Created: 			2008-3-10
Last Modified: 		2008-3-10
*/

@RowGuid uniqueidentifier

AS


SELECT
		[RowGuid],
		[CreatedUtc],
		[SiteGuid],
		[UserGuid],
		[StoreGuid],
		[CartGuid],
		[RawResponse],
		[ResponseCode],
		[ResponseReasonCode],
		[Reason],
		[AvsCode],
		[CcvCode],
		[CavCode],
		[TransactionId],
		[TransactionType],
		[Method],
		[AuthCode],
		[Amount],
		[Tax],
		[Duty],
		[Freight]
		
FROM
		[dbo].[mp_AuthorizeNetLog]
		
WHERE
		[RowGuid] = @RowGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_AuthorizeNetLog_Update]    Script Date: 11/10/2008 11:50:16 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_AuthorizeNetLog_Update]

/*
Author:   			
Created: 			2008-3-10
Last Modified: 		2008-3-10
*/
	
@RowGuid uniqueidentifier, 
@SiteGuid uniqueidentifier, 
@UserGuid uniqueidentifier, 
@StoreGuid uniqueidentifier, 
@CartGuid uniqueidentifier, 
@RawResponse ntext, 
@ResponseCode nchar(1), 
@ResponseReasonCode nvarchar(20), 
@Reason ntext, 
@AvsCode nvarchar(50), 
@CcvCode nchar(1), 
@CavCode nchar(1), 
@TransactionId nvarchar(50), 
@TransactionType nvarchar(50), 
@Method nvarchar(20), 
@AuthCode nvarchar(50), 
@Amount decimal(15, 4), 
@Tax decimal(15, 4), 
@Duty decimal(15, 4), 
@Freight decimal(15, 4) 


AS

UPDATE 		[dbo].[mp_AuthorizeNetLog] 

SET
			[SiteGuid] = @SiteGuid,
			[UserGuid] = @UserGuid,
			[StoreGuid] = @StoreGuid,
			[CartGuid] = @CartGuid,
			[RawResponse] = @RawResponse,
			[ResponseCode] = @ResponseCode,
			[ResponseReasonCode] = @ResponseReasonCode,
			[Reason] = @Reason,
			[AvsCode] = @AvsCode,
			[CcvCode] = @CcvCode,
			[CavCode] = @CavCode,
			[TransactionId] = @TransactionId,
			[TransactionType] = @TransactionType,
			[Method] = @Method,
			[AuthCode] = @AuthCode,
			[Amount] = @Amount,
			[Tax] = @Tax,
			[Duty] = @Duty,
			[Freight] = @Freight
			
WHERE
			[RowGuid] = @RowGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_AuthorizeNetLog_Insert]    Script Date: 11/10/2008 11:50:15 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_AuthorizeNetLog_Insert]

/*
Author:   			
Created: 			2008-3-10
Last Modified: 		2008-3-10
*/

@RowGuid uniqueidentifier,
@CreatedUtc datetime,
@SiteGuid uniqueidentifier,
@UserGuid uniqueidentifier,
@StoreGuid uniqueidentifier,
@CartGuid uniqueidentifier,
@RawResponse ntext,
@ResponseCode nchar(1),
@ResponseReasonCode nvarchar(20),
@Reason ntext,
@AvsCode nvarchar(50),
@CcvCode nchar(1),
@CavCode nchar(1),
@TransactionId nvarchar(50),
@TransactionType nvarchar(50),
@Method nvarchar(20),
@AuthCode nvarchar(50),
@Amount decimal(15, 4),
@Tax decimal(15, 4),
@Duty decimal(15, 4),
@Freight decimal(15, 4)

	
AS

INSERT INTO 	[dbo].[mp_AuthorizeNetLog] 
(
				[RowGuid],
				[CreatedUtc],
				[SiteGuid],
				[UserGuid],
				[StoreGuid],
				[CartGuid],
				[RawResponse],
				[ResponseCode],
				[ResponseReasonCode],
				[Reason],
				[AvsCode],
				[CcvCode],
				[CavCode],
				[TransactionId],
				[TransactionType],
				[Method],
				[AuthCode],
				[Amount],
				[Tax],
				[Duty],
				[Freight]
) 

VALUES 
(
				@RowGuid,
				@CreatedUtc,
				@SiteGuid,
				@UserGuid,
				@StoreGuid,
				@CartGuid,
				@RawResponse,
				@ResponseCode,
				@ResponseReasonCode,
				@Reason,
				@AvsCode,
				@CcvCode,
				@CavCode,
				@TransactionId,
				@TransactionType,
				@Method,
				@AuthCode,
				@Amount,
				@Tax,
				@Duty,
				@Freight
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_AuthorizeNetLog_SelectAll]    Script Date: 11/10/2008 11:50:15 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_AuthorizeNetLog_SelectAll]

/*
Author:   			
Created: 			2008-3-10
Last Modified: 		2008-3-10
*/

AS


SELECT
		[RowGuid],
		[CreatedUtc],
		[SiteGuid],
		[UserGuid],
		[StoreGuid],
		[CartGuid],
		[RawResponse],
		[ResponseCode],
		[ResponseReasonCode],
		[Reason],
		[AvsCode],
		[CcvCode],
		[CavCode],
		[TransactionId],
		[TransactionType],
		[Method],
		[AuthCode],
		[Amount],
		[Tax],
		[Duty],
		[Freight]
		
FROM
		[dbo].[mp_AuthorizeNetLog]
GO
/****** Object:  StoredProcedure [dbo].[mp_AuthorizeNetLog_GetCount]    Script Date: 11/10/2008 11:50:13 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_AuthorizeNetLog_GetCount]

/*
Author:   			
Created: 			2008-3-10
Last Modified: 		2008-3-10
*/

AS

SELECT COUNT(*) FROM [dbo].[mp_AuthorizeNetLog]
GO
/****** Object:  StoredProcedure [dbo].[mp_AuthorizeNetLog_Delete]    Script Date: 11/10/2008 11:50:13 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_AuthorizeNetLog_Delete]

/*
Author:   			
Created: 			2008-3-10
Last Modified: 		2008-3-10
*/

@RowGuid uniqueidentifier

AS

DELETE FROM [dbo].[mp_AuthorizeNetLog]
WHERE
	[RowGuid] = @RowGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_HtmlContent_Insert]    Script Date: 11/10/2008 11:50:35 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_HtmlContent_Insert]

/*
Author:   			
Created: 			12/23/2004
Last Modified: 		2008-01-27

*/

@ItemGuid	uniqueidentifier,
@ModuleGuid	uniqueidentifier,
@ModuleID int,
@Title nvarchar(255),
@Excerpt ntext,
@Body ntext,
@MoreLink nvarchar(255),
@SortOrder int,
@BeginDate datetime,
@EndDate datetime,
@CreatedDate datetime,
@UserID int,
@UserGuid	uniqueidentifier

	
AS

INSERT INTO 	[dbo].[mp_HtmlContent] 
(
				ItemGuid,
				ModuleGuid,
				[ModuleID],
				[Title],
				[Excerpt],
				[Body],
				[MoreLink],
				[SortOrder],
				[BeginDate],
				[EndDate],
				[CreatedDate],
				[UserID],
				[UserGuid],
				LastModUserGuid,
				LastModUtc
) 

VALUES 
(
				@ItemGuid,
				@ModuleGuid,
				@ModuleID,
				@Title,
				@Excerpt,
				@Body,
				@MoreLink,
				@SortOrder,
				@BeginDate,
				@EndDate,
				@CreatedDate,
				@UserID,
				@UserGuid,
				@UserGuid,
				@CreatedDate
				
)
SELECT @@IDENTITY
GO
/****** Object:  StoredProcedure [dbo].[mp_HtmlContent_SelectAll]    Script Date: 11/10/2008 11:50:36 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_HtmlContent_SelectAll]

/*
Author:   			
Created: 			12/23/2004
Last Modified: 			12/23/2004


*/

AS


SELECT	*
		
FROM
		[dbo].[mp_HtmlContent]
GO
/****** Object:  StoredProcedure [dbo].[mp_HtmlContent_Select]    Script Date: 11/10/2008 11:50:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_HtmlContent_Select]

/*
Author:			Joe Audettte
Created:		2004-12-23
Last Modified:	2008-08-28

*/


@ModuleID int,
@BeginDate datetime

AS
SELECT  	*

FROM		mp_HtmlContent

WHERE	ModuleID = @ModuleID
		AND BeginDate <= @BeginDate
		AND EndDate >= @BeginDate

ORDER BY BeginDate DESC
GO
/****** Object:  StoredProcedure [dbo].[mp_HtmlContent_Delete]    Script Date: 11/10/2008 11:50:34 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_HtmlContent_Delete]

/*
Author:   			
Created: 			12/23/2004
Last Modified: 			12/23/2004

*/

@ItemID int

AS

DELETE FROM [dbo].[mp_HtmlContent]
WHERE
	[ItemID] = @ItemID
GO
/****** Object:  StoredProcedure [dbo].[mp_HtmlContent_Update]    Script Date: 11/10/2008 11:50:37 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_HtmlContent_Update]

/*
Author:   			
Created: 			12/23/2004
Last Modified: 		2008-01-28


*/
	
@ItemID int, 
@ModuleID int, 
@Title nvarchar(255), 
@Excerpt ntext, 
@Body ntext, 
@MoreLink nvarchar(255), 
@SortOrder int, 
@BeginDate datetime, 
@EndDate datetime, 
@LastModUtc datetime, 
@LastModUserGuid	uniqueidentifier


AS

UPDATE 		[dbo].[mp_HtmlContent] 

SET
			[ModuleID] = @ModuleID,
			[Title] = @Title,
			[Excerpt] = @Excerpt,
			[Body] = @Body,
			[MoreLink] = @MoreLink,
			[SortOrder] = @SortOrder,
			[BeginDate] = @BeginDate,
			[EndDate] = @EndDate,
			[LastModUtc] = @LastModUtc,
			[LastModUserGuid] = @LastModUserGuid
			
WHERE
			[ItemID] = @ItemID
GO
/****** Object:  StoredProcedure [dbo].[mp_HtmlContent_SelectOne]    Script Date: 11/10/2008 11:50:36 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_HtmlContent_SelectOne]

/*
Author:			Joe Audettte
Created:		12/23/2004
Last Modified:		12/23/2004

*/


@ItemID	int

AS

SELECT  	*

FROM		mp_HtmlContent

WHERE	ItemID = @ItemID
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSendLog_GetCount]    Script Date: 11/10/2008 11:50:49 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterSendLog_GetCount]

/*
Author:   			
Created: 			2008-1-8
Last Modified: 		2008-1-8
*/


@LetterGuid uniqueidentifier

AS

SELECT COUNT(*) FROM [dbo].[mp_LetterSendLog]
WHERE
	[LetterGuid] = @LetterGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSendLog_DeleteByLetter]    Script Date: 11/10/2008 11:50:49 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterSendLog_DeleteByLetter]

/*
Author:   			
Created: 			2008-1-8
Last Modified: 		2008-1-8
*/

@LetterGuid uniqueidentifier

AS

DELETE FROM [dbo].[mp_LetterSendLog]
WHERE
	[LetterGuid] = @LetterGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSendLog_Insert]    Script Date: 11/10/2008 11:50:49 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterSendLog_Insert]

/*
Author:   			
Created: 			2008-1-8
Last Modified: 		2008-1-8
*/

@LetterGuid uniqueidentifier,
@UserGuid uniqueidentifier,
@EmailAddress nvarchar(100),
@UTC datetime,
@ErrorOccurred bit,
@ErrorMessage ntext

	
AS

INSERT INTO 	[dbo].[mp_LetterSendLog] 
(
				[LetterGuid],
				[UserGuid],
				[EmailAddress],
				[UTC],
				[ErrorOccurred],
				[ErrorMessage]
) 

VALUES 
(
				@LetterGuid,
				@UserGuid,
				@EmailAddress,
				@UTC,
				@ErrorOccurred,
				@ErrorMessage
				
)
SELECT @@IDENTITY
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSendLog_Update]    Script Date: 11/10/2008 11:50:50 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterSendLog_Update]

/*
Author:   			
Created: 			2008-1-8
Last Modified: 		2008-1-8
*/
	
@RowID int, 
@LetterGuid uniqueidentifier, 
@UserGuid uniqueidentifier, 
@EmailAddress nvarchar(100), 
@UTC datetime, 
@ErrorOccurred bit, 
@ErrorMessage ntext 


AS

UPDATE 		[dbo].[mp_LetterSendLog] 

SET
			[LetterGuid] = @LetterGuid,
			[UserGuid] = @UserGuid,
			[EmailAddress] = @EmailAddress,
			[UTC] = @UTC,
			[ErrorOccurred] = @ErrorOccurred,
			[ErrorMessage] = @ErrorMessage
			
WHERE
			[RowID] = @RowID
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSendLog_SelectOne]    Script Date: 11/10/2008 11:50:49 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterSendLog_SelectOne]

/*
Author:   			
Created: 			2008-1-8
Last Modified: 		2008-1-8
*/

@RowID int

AS


SELECT
		[RowID],
		[LetterGuid],
		[UserGuid],
		[EmailAddress],
		[UTC],
		[ErrorOccurred],
		[ErrorMessage]
		
FROM
		[dbo].[mp_LetterSendLog]
		
WHERE
		[RowID] = @RowID
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSendLog_Delete]    Script Date: 11/10/2008 11:50:48 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterSendLog_Delete]

/*
Author:   			
Created: 			2008-1-8
Last Modified: 		2008-1-8
*/

@RowID int

AS

DELETE FROM [dbo].[mp_LetterSendLog]
WHERE
	[RowID] = @RowID
GO
/****** Object:  StoredProcedure [dbo].[mp_PageModule_SelectByModule]    Script Date: 11/10/2008 11:51:03 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_PageModule_SelectByModule]

/*
Author:			
Created:		2007-07-23
Last Modified:	2007-07-23

*/
    
@ModuleID  	int


AS

SELECT *
		
FROM		mp_PageModules
		
WHERE	ModuleID = @ModuleID
GO
/****** Object:  StoredProcedure [dbo].[mp_PageModules_DeleteByPage]    Script Date: 11/10/2008 11:51:04 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_PageModules_DeleteByPage]
(
    @PageID int
)
AS

DELETE FROM
    mp_PageModules

WHERE
    PageID = @PageID
GO
/****** Object:  StoredProcedure [dbo].[mp_PageModules_Update]    Script Date: 11/10/2008 11:51:05 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_PageModules_Update]

/*
Author:   			
Created: 			5/18/2006
Last Modified: 		5/18/2006

*/

@ModuleID			int,
@PageID				int,
@PaneName			nvarchar(50),
@ModuleOrder		int,
@PublishBeginDate	datetime,
@PublishEndDate		datetime

	
AS
UPDATE 	[dbo].[mp_PageModules] 
SET
				PaneName = @PaneName,
				ModuleOrder = @ModuleOrder,
				PublishBeginDate = @PublishBeginDate,
				PublishEndDate = @PublishEndDate

WHERE			ModuleID = @ModuleID
				AND PageID = @PageID
GO
/****** Object:  StoredProcedure [dbo].[mp_PageModules_Insert]    Script Date: 11/10/2008 11:51:04 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_PageModules_Insert]

/*
Author:   			
Created: 			5/18/2006
Last Modified: 		2008-01-27

*/

@PageGuid	uniqueidentifier,
@ModuleGuid uniqueidentifier,
@ModuleID			int,
@PageID				int,
@PaneName			nvarchar(50),
@ModuleOrder		int,
@PublishBeginDate	datetime,
@PublishEndDate		datetime

	
AS
INSERT INTO 	[dbo].[mp_PageModules] 
(
				PageGuid,
				ModuleGuid,
				ModuleID,
				PageID,
				PaneName,
				ModuleOrder,
				PublishBeginDate,
				PublishEndDate
				
) 

VALUES 
(
				@PageGuid,
				@ModuleGuid,
				@ModuleID,
				@PageID,
				@PaneName,
				@ModuleOrder,
				@PublishBeginDate,
				@PublishEndDate
				
				
)
SELECT @@IDENTITY
GO
/****** Object:  StoredProcedure [dbo].[mp_Modules_DeleteInstance]    Script Date: 11/10/2008 11:50:57 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Modules_DeleteInstance]

/*
Author:   			
Created: 			5/18/2006
Last Modified: 		5/18/2006


*/

@ModuleID int,
@PageID		int

AS
DELETE FROM [dbo].[mp_PageModules]
WHERE ModuleID = @ModuleID AND PageID = @PageID
GO
/****** Object:  StoredProcedure [dbo].[mp_Modules_UpdateModuleOrder]    Script Date: 11/10/2008 11:51:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Modules_UpdateModuleOrder]
(
	@PageID				int,
    @ModuleID           int,
    @ModuleOrder        int,
    @PaneName           nvarchar(50)
)
AS
UPDATE
    mp_PageModules

SET
    ModuleOrder = @ModuleOrder,
    PaneName    = @PaneName

WHERE
    ModuleID = @ModuleID
	AND PageID = @PageID
GO
/****** Object:  StoredProcedure [dbo].[mp_PageModule_SelectByPage]    Script Date: 11/10/2008 11:51:04 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_PageModule_SelectByPage]

/*
Author:			
Created:		2007-09-01
Last Modified:	2007-09-01

*/
    
@PageID  	int


AS

SELECT *
		
FROM		mp_PageModules
		
WHERE	PageID = @PageID
GO
/****** Object:  StoredProcedure [dbo].[mp_PageModule_Exists]    Script Date: 11/10/2008 11:51:03 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_PageModule_Exists]

/*
Author:			
Created:		5/18/2006
Last Modified:	5/18/2006

*/
    
@ModuleID  	int,
@PageID		int

AS
IF EXISTS (	SELECT 	ModuleID
		FROM		mp_PageModules
		WHERE	ModuleID = @ModuleID
				AND PageID = @PageID )
SELECT 1
ELSE
SELECT 0
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterSubscriberHx_Insert]    Script Date: 11/10/2008 11:50:53 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterSubscriberHx_Insert]

/*
Author:   			
Created: 			9/22/2007
Last Modified: 		9/22/2007
*/

@LetterInfoGuid uniqueidentifier,
@UserGuid uniqueidentifier,
@UseHtml bit,
@BeginUTC datetime,
@EndUTC datetime

	
AS

INSERT INTO 	[dbo].[mp_LetterSubscriberHx] 
(
				[LetterInfoGuid],
				[UserGuid],
				[UseHtml],
				[BeginUTC],
				[EndUTC]
) 

VALUES 
(
				@LetterInfoGuid,
				@UserGuid,
				@UseHtml,
				@BeginUTC,
				@EndUTC
				
)
SELECT @@IDENTITY
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteFolders_SelectOne]    Script Date: 11/10/2008 11:51:21 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SiteFolders_SelectOne]

/*
Author:   			
Created: 			5/11/2007
Last Modified: 		5/11/2007
*/

@Guid uniqueidentifier

AS


SELECT
		[Guid],
		[SiteGuid],
		[FolderName]
		
FROM
		[dbo].[mp_SiteFolders]
		
WHERE
		[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteFolders_Update]    Script Date: 11/10/2008 11:51:22 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SiteFolders_Update]

/*
Author:   			
Created: 			5/11/2007
Last Modified: 		5/11/2007
*/
	
@Guid uniqueidentifier, 
@SiteGuid uniqueidentifier, 
@FolderName nvarchar(255) 


AS

UPDATE 		[dbo].[mp_SiteFolders] 

SET
			[SiteGuid] = @SiteGuid,
			[FolderName] = @FolderName
			
WHERE
			[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteFolders_Insert]    Script Date: 11/10/2008 11:51:21 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SiteFolders_Insert]

/*
Author:   			
Created: 			5/11/2007
Last Modified: 		5/11/2007
*/

@Guid uniqueidentifier,
@SiteGuid uniqueidentifier,
@FolderName nvarchar(255)

	
AS

INSERT INTO 	[dbo].[mp_SiteFolders] 
(
				[Guid],
				[SiteGuid],
				[FolderName]
) 

VALUES 
(
				@Guid,
				@SiteGuid,
				@FolderName
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteFolders_Delete]    Script Date: 11/10/2008 11:51:21 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SiteFolders_Delete]

/*
Author:   			
Created: 			5/11/2007
Last Modified: 		5/11/2007
*/

@Guid uniqueidentifier

AS

DELETE FROM [dbo].[mp_SiteFolders]
WHERE
	[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteFolders_SelectBySite]    Script Date: 11/10/2008 11:51:21 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SiteFolders_SelectBySite]

/*
Author:   			
Created: 			5/11/2007
Last Modified: 		5/11/2007
*/

@SiteGuid uniqueidentifier

AS


SELECT
		[Guid],
		[SiteGuid],
		[FolderName]
		
FROM
		[dbo].[mp_SiteFolders]
		
WHERE
		[SiteGuid] = @SiteGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteFolder_Exists]    Script Date: 11/10/2008 11:51:20 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SiteFolder_Exists]

/*
Author:			
Created:		5/11/2007
Last Modified:	5/11/2007

*/
    
@FolderName	nvarchar(255)

AS

IF EXISTS (	SELECT 	[Guid]
		FROM		mp_SiteFolders
		WHERE		FolderName = @FolderName )
SELECT 1
ELSE
SELECT 0
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleSettings_Update]    Script Date: 11/10/2008 11:51:03 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleSettings_Update]
(
	@ModuleGuid		uniqueidentifier,
    @ModuleID      int,
    @SettingName   nvarchar(50),
    @SettingValue  nvarchar(255)
)
AS

IF NOT EXISTS (
    SELECT 
        * 
    FROM 
        mp_ModuleSettings 
    WHERE 
        ModuleID = @ModuleID
      AND
        SettingName = @SettingName
)
INSERT INTO mp_ModuleSettings (
	SettingGuid,
	ModuleGuid,
    ModuleID,
    SettingName,
    SettingValue
) 
VALUES (
	newid(),
	@ModuleGuid,
    @ModuleID,
    @SettingName,
    @SettingValue
)
ELSE
UPDATE
    mp_ModuleSettings

SET
    SettingValue = @SettingValue

WHERE
    ModuleID = @ModuleID
  AND
    SettingName = @SettingName
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleSettings_Insert]    Script Date: 11/10/2008 11:51:02 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleSettings_Insert]

/*
Author:			
Created:		6/9/2005
Last Modified:		2008-06-04

*/


@SettingGuid		uniqueidentifier,
@ModuleGuid		uniqueidentifier,
@ModuleID			int,
@SettingName			nvarchar(50),
@SettingValue			nvarchar(255),
@ControlType			nvarchar(50),
@RegexValidationExpression 	ntext,
@ControlSrc			nvarchar(255),
@HelpKey			nvarchar(255),
@SortOrder			int




AS

INSERT INTO 	mp_ModuleSettings
(
			SettingGuid,
			ModuleGuid,
			ModuleID,
			SettingName,
			SettingValue,
			ControlType,
			RegexValidationExpression,
			ControlSrc,
			HelpKey,
			SortOrder
)

VALUES
(
			@SettingGuid,
			@ModuleGuid,
			@ModuleID,
			@SettingName,
			@SettingValue,
			@ControlType,
			@RegexValidationExpression,
			@ControlSrc,
			@HelpKey,
			@SortOrder
)
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleSettings_Delete]    Script Date: 11/10/2008 11:51:01 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleSettings_Delete]

/*
Author:			
Created:		1/1/2005
Last Modified:		1/1/2005

*/

@ModuleID		int

AS

DELETE FROM mp_ModuleSettings

WHERE	ModuleID = @ModuleID
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoCountry_SelectByISOCode2]    Script Date: 11/10/2008 11:50:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoCountry_SelectByISOCode2]

/*
Author:   			
Created: 			2008-06-22
Last Modified: 		2008-06-22
*/

@ISOCode2 nchar(2)

AS


SELECT
		*
		
FROM
		[dbo].[mp_GeoCountry]
		
WHERE
		ISOCode2 = @ISOCode2
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoCountry_Update]    Script Date: 11/10/2008 11:50:27 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoCountry_Update]

/*
Author:   			
Created: 			2/16/2007
Last Modified: 		2/16/2007
*/
	
@Guid uniqueidentifier, 
@Name nvarchar(255), 
@ISOCode2 nchar(2), 
@ISOCode3 nchar(3) 


AS

UPDATE 		[dbo].[mp_GeoCountry] 

SET
			[Name] = @Name,
			[ISOCode2] = @ISOCode2,
			[ISOCode3] = @ISOCode3
			
WHERE
			[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoCountry_Delete]    Script Date: 11/10/2008 11:52:10 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoCountry_Delete]

/*
Author:   			
Created: 			2/16/2007
Last Modified: 		2/16/2007
*/

@Guid uniqueidentifier

AS

DELETE FROM [dbo].[mp_GeoCountry]
WHERE
	[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoCountry_SelectAll]    Script Date: 11/10/2008 11:50:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoCountry_SelectAll]

/*
Author:   			
Created: 			2/16/2007
Last Modified: 		2/16/2007
*/

AS


SELECT
		[Guid],
		[Name],
		[ISOCode2],
		[ISOCode3]
		
FROM
		[dbo].[mp_GeoCountry]

ORDER BY [Name]
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoCountry_GetCount]    Script Date: 11/10/2008 11:50:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoCountry_GetCount]

/*
Author:   			
Created: 			2008-06-23
Last Modified: 		2008-06-23
*/

AS


SELECT COUNT(*)
		
FROM
		[dbo].[mp_GeoCountry]
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoCountry_Insert]    Script Date: 11/10/2008 11:50:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoCountry_Insert]

/*
Author:   			
Created: 			2/16/2007
Last Modified: 		2/16/2007
*/

@Guid uniqueidentifier,
@Name nvarchar(255),
@ISOCode2 nchar(2),
@ISOCode3 nchar(3)

	
AS

INSERT INTO 	[dbo].[mp_GeoCountry] 
(
				[Guid],
				[Name],
				[ISOCode2],
				[ISOCode3]
) 

VALUES 
(
				@Guid,
				@Name,
				@ISOCode2,
				@ISOCode3
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_GeoCountry_SelectOne]    Script Date: 11/10/2008 11:50:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_GeoCountry_SelectOne]

/*
Author:   			
Created: 			2/16/2007
Last Modified: 		2/16/2007
*/

@Guid uniqueidentifier

AS


SELECT
		[Guid],
		[Name],
		[ISOCode2],
		[ISOCode3]
		
FROM
		[dbo].[mp_GeoCountry]
		
WHERE
		[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_UserProperties_Insert]    Script Date: 11/10/2008 11:51:52 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserProperties_Insert]

/*
Author:   			
Created: 			12/31/2006
Last Modified: 		12/31/2006
*/

@PropertyID uniqueidentifier,
@UserGuid uniqueidentifier,
@PropertyName nvarchar(255),
@PropertyValueString ntext,
@PropertyValueBinary image,
@LastUpdatedDate datetime,
@IsLazyLoaded bit

	
AS



INSERT INTO 	[dbo].[mp_UserProperties] 
(
				[PropertyID],
				[UserGuid],
				[PropertyName],
				[PropertyValueString],
				[PropertyValueBinary],
				[LastUpdatedDate],
				[IsLazyLoaded]
) 

VALUES 
(
				@PropertyID,
				@UserGuid,
				@PropertyName,
				@PropertyValueString,
				@PropertyValueBinary,
				@LastUpdatedDate,
				@IsLazyLoaded
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_UserProperties_Update]    Script Date: 11/10/2008 11:51:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserProperties_Update]

/*
Author:   			
Created: 			12/31/2006
Last Modified: 		12/31/2006
*/
	 
@UserGuid uniqueidentifier, 
@PropertyName nvarchar(255), 
@PropertyValueString ntext, 
@PropertyValueBinary image, 
@LastUpdatedDate datetime, 
@IsLazyLoaded bit 


AS

UPDATE 		[dbo].[mp_UserProperties] 

SET
			[UserGuid] = @UserGuid,
			[PropertyName] = @PropertyName,
			[PropertyValueString] = @PropertyValueString,
			[PropertyValueBinary] = @PropertyValueBinary,
			[LastUpdatedDate] = @LastUpdatedDate,
			[IsLazyLoaded] = @IsLazyLoaded
			
WHERE
			[UserGuid] = @UserGuid
			AND [PropertyName] = @PropertyName
GO
/****** Object:  StoredProcedure [dbo].[mp_UserProperties_SelectByUser]    Script Date: 11/10/2008 11:51:52 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserProperties_SelectByUser]

/*
Author:   			
Created: 			12/31/2006
Last Modified: 		12/31/2006
*/

@UserGuid uniqueidentifier


AS


SELECT	
		[PropertyID],
		[UserGuid],
		[PropertyName],
		[PropertyValueString],
		[PropertyValueBinary],
		[LastUpdatedDate],
		[IsLazyLoaded]
		
FROM
		[dbo].[mp_UserProperties]
		
WHERE
		[UserGuid] = @UserGuid
		AND IsLazyLoaded = 0
GO
/****** Object:  StoredProcedure [dbo].[mp_UserProperties_SelectOne]    Script Date: 11/10/2008 11:51:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserProperties_SelectOne]

/*
Author:   			
Created: 			12/31/2006
Last Modified: 		12/31/2006
*/

@UserGuid uniqueidentifier,
@PropertyName nvarchar(255)

AS


SELECT	TOP 1
		[PropertyID],
		[UserGuid],
		[PropertyName],
		[PropertyValueString],
		[PropertyValueBinary],
		[LastUpdatedDate],
		[IsLazyLoaded]
		
FROM
		[dbo].[mp_UserProperties]
		
WHERE
		[UserGuid] = @UserGuid
		AND PropertyName = @PropertyName
GO
/****** Object:  StoredProcedure [dbo].[mp_UserProperties_PropertyExists]    Script Date: 11/10/2008 11:51:52 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_UserProperties_PropertyExists]

/*
Author:			
Created:		12/31/2006
Last Modified:	12/31/2006

*/
    
@UserGuid  	uniqueidentifier,
@PropertyName	nvarchar(255)

AS
SELECT Count(*)
FROM mp_UserProperties
WHERE UserGuid = @UserGuid
AND [PropertyName] = @PropertyName
GO
/****** Object:  StoredProcedure [dbo].[mp_UserProperties_Delete]    Script Date: 11/10/2008 11:51:51 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserProperties_Delete]

/*
Author:   			
Created: 			12/31/2006
Last Modified: 		12/31/2006
*/

@UserGuid uniqueidentifier,
@PropertyName	nvarchar(255)

AS

DELETE FROM [dbo].[mp_UserProperties]
WHERE
	[UserGuid] = @UserGuid
	AND [PropertyName] = @PropertyName
GO
/****** Object:  StoredProcedure [dbo].[mp_Language_SelectOne]    Script Date: 11/10/2008 11:50:39 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Language_SelectOne]

/*
Author:   			
Created: 			2/17/2007
Last Modified: 		2/17/2007
*/

@Guid uniqueidentifier

AS


SELECT
		[Guid],
		[Name],
		[Code],
		[Sort]
		
FROM
		[dbo].[mp_Language]
		
WHERE
		[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_Language_GetCount]    Script Date: 11/10/2008 11:50:38 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Language_GetCount]

/*
Author:   			
Created: 			2008-06-23
Last Modified: 		2008-06-28
*/

AS


SELECT COUNT(*)
		
FROM
		[dbo].[mp_Language]
GO
/****** Object:  StoredProcedure [dbo].[mp_Language_Insert]    Script Date: 11/10/2008 11:50:38 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Language_Insert]

/*
Author:   			
Created: 			2/17/2007
Last Modified: 		2/17/2007
*/

@Guid uniqueidentifier,
@Name nvarchar(255),
@Code nchar(2),
@Sort int

	
AS

INSERT INTO 	[dbo].[mp_Language] 
(
				[Guid],
				[Name],
				[Code],
				[Sort]
) 

VALUES 
(
				@Guid,
				@Name,
				@Code,
				@Sort
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_Language_Delete]    Script Date: 11/10/2008 11:50:38 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Language_Delete]

/*
Author:   			
Created: 			2/17/2007
Last Modified: 		2/17/2007
*/

@Guid uniqueidentifier

AS

DELETE FROM [dbo].[mp_Language]
WHERE
	[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_Language_Update]    Script Date: 11/10/2008 11:50:39 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Language_Update]

/*
Author:   			
Created: 			2/17/2007
Last Modified: 		2/17/2007
*/
	
@Guid uniqueidentifier, 
@Name nvarchar(255), 
@Code nchar(2), 
@Sort int 


AS

UPDATE 		[dbo].[mp_Language] 

SET
			[Name] = @Name,
			[Code] = @Code,
			[Sort] = @Sort
			
WHERE
			[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_Language_SelectAll]    Script Date: 11/10/2008 11:50:38 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Language_SelectAll]

/*
Author:   			
Created: 			2/17/2007
Last Modified: 		2/17/2007
*/

AS


SELECT
		[Guid],
		[Name],
		[Code],
		[Sort]
		
FROM
		[dbo].[mp_Language]
GO
/****** Object:  StoredProcedure [dbo].[mp_TaxRateHistory_Insert]    Script Date: 11/10/2008 11:51:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaxRateHistory_Insert]

/*
Author:   			
Created: 			2/22/2007
Last Modified: 		2/23/2007
*/

@Guid uniqueidentifier,
@TaxRateGuid uniqueidentifier,
@SiteGuid uniqueidentifier,
@GeoZoneGuid uniqueidentifier,
@TaxClassGuid uniqueidentifier,
@Priority int,
@Rate decimal(18, 4),
@Description nvarchar(255),
@Created datetime,
@CreatedBy uniqueidentifier,
@LastModified datetime,
@ModifiedBy uniqueidentifier,
@LogTime datetime

	
AS
INSERT INTO 	[dbo].[mp_TaxRateHistory] 
(
				[Guid],
				[TaxRateGuid],
				[SiteGuid],
				[GeoZoneGuid],
				[TaxClassGuid],
				[Priority],
				[Rate],
				[Description],
				[Created],
				[CreatedBy],
				[LastModified],
				[ModifiedBy],
				[LogTime]
) 

VALUES 
(
				@Guid,
				@TaxRateGuid,
				@SiteGuid,
				@GeoZoneGuid,
				@TaxClassGuid,
				@Priority,
				@Rate,
				@Description,
				@Created,
				@CreatedBy,
				@LastModified,
				@ModifiedBy,
				@LogTime
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_PayPalLog_Delete]    Script Date: 11/10/2008 11:51:11 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_PayPalLog_Delete]

/*
Author:   			
Created: 			2008-3-9
Last Modified: 		2008-3-9
*/

@RowGuid uniqueidentifier

AS

DELETE FROM [dbo].[mp_PayPalLog]
WHERE
	[RowGuid] = @RowGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_PayPalLog_SelectNewestLog]    Script Date: 11/10/2008 11:51:14 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_PayPalLog_SelectNewestLog]

/*
Author:   			
Created: 			2008-06-26
Last Modified: 		2008-06-26
*/

@CartGuid uniqueidentifier,
@RequestType nvarchar(255)

AS


SELECT TOP 1 *
		
FROM
		[dbo].[mp_PayPalLog]
		
WHERE
		[CartGuid] = @CartGuid
		AND (RequestType = @RequestType OR @RequestType = '')

ORDER BY 
		CreatedUtc DESC
GO
/****** Object:  StoredProcedure [dbo].[mp_PayPalLog_SelectByCart]    Script Date: 11/10/2008 11:51:13 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_PayPalLog_SelectByCart]

/*
Author:   			
Created: 			2008-07-01
Last Modified: 		2008--07-01
*/

@CartGuid uniqueidentifier

AS


SELECT *
		
FROM
		[dbo].[mp_PayPalLog]
		
WHERE
		[CartGuid] = @CartGuid

ORDER BY
		CreatedUtc
GO
/****** Object:  StoredProcedure [dbo].[mp_PayPalLog_Insert]    Script Date: 11/10/2008 11:51:13 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_PayPalLog_Insert]

/*
Author:   			
Created: 			2008-07-05
Last Modified: 		2008-07-05
*/

@RowGuid uniqueidentifier,
@CreatedUtc datetime,
@SiteGuid uniqueidentifier,
@UserGuid uniqueidentifier,
@StoreGuid uniqueidentifier,
@CartGuid uniqueidentifier,
@RequestType nvarchar(255),
@ApiVersion nvarchar(50),
@RawResponse ntext,
@Token nvarchar(50),
@PayerId nvarchar(50),
@TransactionId nvarchar(50),
@PaymentType nvarchar(10),
@PaymentStatus nvarchar(50),
@PendingReason nvarchar(255),
@ReasonCode nvarchar(50),
@CurrencyCode nvarchar(50),
@ExchangeRate decimal(15, 4),
@CartTotal decimal(15, 4),
@PayPalAmt decimal(15, 4),
@TaxAmt decimal(15, 4),
@FeeAmt decimal(15, 4),
@SettleAmt decimal(15, 4),
@ProviderName nvarchar(255),
@ReturnUrl nvarchar(255),
@SerializedObject ntext,
@PDTProviderName nvarchar(255),
@IPNProviderName nvarchar(255),
@Response nvarchar(255)

	
AS

INSERT INTO 	[dbo].[mp_PayPalLog] 
(
				[RowGuid],
				[CreatedUtc],
				[SiteGuid],
				[UserGuid],
				[StoreGuid],
				[CartGuid],
				[RequestType],
				[ApiVersion],
				[RawResponse],
				[Token],
				[PayerId],
				[TransactionId],
				[PaymentType],
				[PaymentStatus],
				[PendingReason],
				[ReasonCode],
				[CurrencyCode],
				[ExchangeRate],
				[CartTotal],
				[PayPalAmt],
				[TaxAmt],
				[FeeAmt],
				[SettleAmt],
				ProviderName,
				ReturnUrl,
				SerializedObject,
				PDTProviderName,
				IPNProviderName,
				Response
) 

VALUES 
(
				@RowGuid,
				@CreatedUtc,
				@SiteGuid,
				@UserGuid,
				@StoreGuid,
				@CartGuid,
				@RequestType,
				@ApiVersion,
				@RawResponse,
				@Token,
				@PayerId,
				@TransactionId,
				@PaymentType,
				@PaymentStatus,
				@PendingReason,
				@ReasonCode,
				@CurrencyCode,
				@ExchangeRate,
				@CartTotal,
				@PayPalAmt,
				@TaxAmt,
				@FeeAmt,
				@SettleAmt,
				@ProviderName,
				@ReturnUrl,
				@SerializedObject,
				@PDTProviderName,
				@IPNProviderName,
				@Response
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_PayPalLog_GetCount]    Script Date: 11/10/2008 11:51:11 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_PayPalLog_GetCount]

/*
Author:   			
Created: 			2008-3-9
Last Modified: 		2008-3-9
*/

AS

SELECT COUNT(*) FROM [dbo].[mp_PayPalLog]
GO
/****** Object:  StoredProcedure [dbo].[mp_PayPalLog_SelectOne]    Script Date: 11/10/2008 11:51:14 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_PayPalLog_SelectOne]

/*
Author:   			
Created: 			2008-3-9
Last Modified: 		2008-3-9
*/

@RowGuid uniqueidentifier

AS


SELECT
		*
		
FROM
		[dbo].[mp_PayPalLog]
		
WHERE
		[RowGuid] = @RowGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_PayPalLog_SelectAll]    Script Date: 11/10/2008 11:51:13 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_PayPalLog_SelectAll]

/*
Author:   			
Created: 			2008-3-9
Last Modified: 		2008-3-9
*/

AS


SELECT
		*
		
FROM
		[dbo].[mp_PayPalLog]
GO
/****** Object:  StoredProcedure [dbo].[mp_PayPalLog_Update]    Script Date: 11/10/2008 11:51:16 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_PayPalLog_Update]

/*
Author:   			
Created: 			2008-3-9
Last Modified: 		2008-3-9
*/
	
@RowGuid uniqueidentifier, 
@CreatedUtc datetime, 
@SiteGuid uniqueidentifier, 
@UserGuid uniqueidentifier, 
@StoreGuid uniqueidentifier, 
@CartGuid uniqueidentifier, 
@RequestType nvarchar(255), 
@ApiVersion nvarchar(50), 
@RawResponse ntext, 
@Token nvarchar(50), 
@PayerId nvarchar(50), 
@TransactionId nvarchar(50), 
@PaymentType nvarchar(10), 
@PaymentStatus nvarchar(50), 
@PendingReason nvarchar(255), 
@ReasonCode nvarchar(50), 
@CurrencyCode nvarchar(50), 
@ExchangeRate decimal(15, 4), 
@CartTotal decimal(15, 4), 
@PayPalAmt decimal(15, 4), 
@TaxAmt decimal(15, 4), 
@FeeAmt decimal(15, 4), 
@SettleAmt decimal(15, 4) 


AS

UPDATE 		[dbo].[mp_PayPalLog] 

SET
			[CreatedUtc] = @CreatedUtc,
			[SiteGuid] = @SiteGuid,
			[UserGuid] = @UserGuid,
			[StoreGuid] = @StoreGuid,
			[CartGuid] = @CartGuid,
			[RequestType] = @RequestType,
			[ApiVersion] = @ApiVersion,
			[RawResponse] = @RawResponse,
			[Token] = @Token,
			[PayerId] = @PayerId,
			[TransactionId] = @TransactionId,
			[PaymentType] = @PaymentType,
			[PaymentStatus] = @PaymentStatus,
			[PendingReason] = @PendingReason,
			[ReasonCode] = @ReasonCode,
			[CurrencyCode] = @CurrencyCode,
			[ExchangeRate] = @ExchangeRate,
			[CartTotal] = @CartTotal,
			[PayPalAmt] = @PayPalAmt,
			[TaxAmt] = @TaxAmt,
			[FeeAmt] = @FeeAmt,
			[SettleAmt] = @SettleAmt
			
WHERE
			[RowGuid] = @RowGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_PayPalLog_SelectSetExpressCheckoutByToken]    Script Date: 11/10/2008 11:51:14 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_PayPalLog_SelectSetExpressCheckoutByToken]

/*
Author:   			
Created: 			2008-06-26
Last Modified: 		2008-06-26
*/

@Token nvarchar(50)

AS


SELECT TOP 1 *
		
FROM
		[dbo].[mp_PayPalLog]
		
WHERE
		[Token] = @Token
		AND RequestType = 'SetExpressCheckout'

ORDER BY 
		CreatedUtc DESC
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterHtmlTemplate_SelectOne]    Script Date: 11/10/2008 11:50:44 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterHtmlTemplate_SelectOne]

/*
Author:   			
Created: 			2007-12-27
Last Modified: 		2007-12-27
*/

@Guid uniqueidentifier

AS


SELECT
		[Guid],
		[SiteGuid],
		[Title],
		[Html],
		[LastModUTC]
		
FROM
		[dbo].[mp_LetterHtmlTemplate]
		
WHERE
		[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterHtmlTemplate_Update]    Script Date: 11/10/2008 11:50:45 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterHtmlTemplate_Update]

/*
Author:   			
Created: 			2007-12-27
Last Modified: 		2007-12-27
*/
	
@Guid uniqueidentifier, 
@Title nvarchar(255), 
@Html ntext, 
@LastModUTC datetime 


AS

UPDATE 		[dbo].[mp_LetterHtmlTemplate] 

SET
			[Title] = @Title,
			[Html] = @Html,
			[LastModUTC] = @LastModUTC
			
WHERE
			[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterHtmlTemplate_Delete]    Script Date: 11/10/2008 11:50:43 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_LetterHtmlTemplate_Delete]

/*
Author:   			
Created: 			2007-12-27
Last Modified: 		2007-12-27
*/

@Guid uniqueidentifier

AS

DELETE FROM [dbo].[mp_LetterHtmlTemplate]
WHERE
	[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterHtmlTemplate_Insert]    Script Date: 11/10/2008 11:50:44 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterHtmlTemplate_Insert]

/*
Author:   			
Created: 			2007-12-27
Last Modified: 		2007-12-27
*/

@Guid uniqueidentifier,
@SiteGuid uniqueidentifier,
@Title nvarchar(255),
@Html ntext,
@LastModUTC datetime

	
AS

INSERT INTO 	[dbo].[mp_LetterHtmlTemplate] 
(
				[Guid],
				[SiteGuid],
				[Title],
				[Html],
				[LastModUTC]
) 

VALUES 
(
				@Guid,
				@SiteGuid,
				@Title,
				@Html,
				@LastModUTC
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterHtmlTemplate_GetCount]    Script Date: 11/10/2008 11:50:43 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterHtmlTemplate_GetCount]

/*
Author:   			
Created: 			2007-12-27
Last Modified: 		2007-12-27
*/

@SiteGuid uniqueidentifier


AS

SELECT COUNT(*) FROM [dbo].[mp_LetterHtmlTemplate]
WHERE SiteGuid = @SiteGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_LetterHtmlTemplate_SelectAll]    Script Date: 11/10/2008 11:50:44 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_LetterHtmlTemplate_SelectAll]

/*
Author:   			
Created: 			2007-12-27
Last Modified: 		2007-12-27
*/

@SiteGuid uniqueidentifier

AS


SELECT
		[Guid],
		[SiteGuid],
		[Title],
		[Html],
		[LastModUTC]
		
FROM
		[dbo].[mp_LetterHtmlTemplate]

WHERE	[SiteGuid] = @SiteGuid

ORDER BY	[Title]
GO
/****** Object:  StoredProcedure [dbo].[mp_TaxRate_Delete]    Script Date: 11/10/2008 11:51:43 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaxRate_Delete]

/*
Author:   			
Created: 			2/22/2007
Last Modified: 		2/22/2007
*/

@Guid uniqueidentifier

AS

DELETE FROM [dbo].[mp_TaxRate]
WHERE
	[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_TaxRate_SelectAll]    Script Date: 11/10/2008 11:51:44 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaxRate_SelectAll]

/*
Author:   			
Created: 			2/22/2007
Last Modified: 		2/22/2007
*/

@SiteGuid uniqueidentifier,
@GeoZoneGuid uniqueidentifier

AS


SELECT
		*
		
FROM
		[dbo].[mp_TaxRate]

WHERE
		[SiteGuid] = @SiteGuid
		AND [GeoZoneGuid] = @GeoZoneGuid

ORDER BY [Priority]
GO
/****** Object:  StoredProcedure [dbo].[mp_TaxRate_Update]    Script Date: 11/10/2008 11:51:44 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaxRate_Update]

/*
Author:   			
Created: 			2/22/2007
Last Modified: 		2/22/2007
*/
	
@Guid uniqueidentifier, 
@GeoZoneGuid uniqueidentifier, 
@TaxClassGuid uniqueidentifier, 
@Priority int, 
@Rate decimal(18, 4), 
@Description nvarchar(255), 
@LastModified datetime, 
@ModifiedBy uniqueidentifier 


AS

UPDATE 		[dbo].[mp_TaxRate] 

SET
			[GeoZoneGuid] = @GeoZoneGuid,
			[TaxClassGuid] = @TaxClassGuid,
			[Priority] = @Priority,
			[Rate] = @Rate,
			[Description] = @Description,
			[LastModified] = @LastModified,
			[ModifiedBy] = @ModifiedBy
			
WHERE
			[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_TaxRate_Insert]    Script Date: 11/10/2008 11:51:43 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaxRate_Insert]

/*
Author:   			
Created: 			2/22/2007
Last Modified: 		2/22/2007
*/

@Guid uniqueidentifier,
@SiteGuid uniqueidentifier,
@GeoZoneGuid uniqueidentifier,
@TaxClassGuid uniqueidentifier,
@Priority int,
@Rate decimal(18, 4),
@Description nvarchar(255),
@Created datetime,
@CreatedBy uniqueidentifier,
@LastModified datetime,
@ModifiedBy uniqueidentifier

	
AS

INSERT INTO 	[dbo].[mp_TaxRate] 
(
				[Guid],
				[SiteGuid],
				[GeoZoneGuid],
				[TaxClassGuid],
				[Priority],
				[Rate],
				[Description],
				[Created],
				[CreatedBy],
				[LastModified],
				[ModifiedBy]
) 

VALUES 
(
				@Guid,
				@SiteGuid,
				@GeoZoneGuid,
				@TaxClassGuid,
				@Priority,
				@Rate,
				@Description,
				@Created,
				@CreatedBy,
				@LastModified,
				@ModifiedBy
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_TaxRate_SelectOne]    Script Date: 11/10/2008 11:51:44 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaxRate_SelectOne]

/*
Author:   			
Created: 			2/22/2007
Last Modified: 		2/22/2007
*/

@Guid uniqueidentifier

AS


SELECT
		*
		
FROM
		[dbo].[mp_TaxRate]
		
WHERE
		[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_SiteModuleDefinitions_Delete]    Script Date: 11/10/2008 11:51:23 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SiteModuleDefinitions_Delete]


/*
Author:			
Created:		3/12/2005
Last Modified:	2008-01-26

*/


@SiteGuid		uniqueidentifier,
@FeatureGuid	uniqueidentifier


AS

DELETE FROM mp_SiteModuleDefinitions
WHERE	SiteGuid = @SiteGuid 
		AND FeatureGuid = @FeatureGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_UpdateLastLoginTime]    Script Date: 11/10/2008 11:52:04 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_UpdateLastLoginTime]


@UserID	uniqueidentifier,
@LastLoginTime	datetime


AS

UPDATE mp_Users WITH (ROWLOCK)
SET LastLoginDate = @LastLoginTime
WHERE UserGuid = @UserID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SetRegistrationConfirmationGuid]    Script Date: 11/10/2008 11:52:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[mp_Users_SetRegistrationConfirmationGuid] 

@UserGuid					uniqueidentifier,
@RegisterConfirmGuid		uniqueidentifier

AS
UPDATE	mp_Users
SET		IsLockedOut = 1,
		RegisterConfirmGuid = @RegisterConfirmGuid
		

WHERE	UserGuid = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SetFailedPasswordAttemptStartWindow]    Script Date: 11/10/2008 11:52:02 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_SetFailedPasswordAttemptStartWindow]

/*
Author:				
Created:			1/18/2007
Last Modified:		4/29/2007

*/

@UserGuid uniqueidentifier,
@WindowStartTime datetime

AS
UPDATE		mp_Users

SET			

FailedPwdAttemptWindowStart = @WindowStartTime


WHERE		UserGuid = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_Update]    Script Date: 11/10/2008 11:52:04 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Users_Update]

/*
Author:			
Created:		2004-09-30
Last Modified:	2007-11-31

*/

    
@UserID        			int,   
@Name				nvarchar(100),
@LoginName			nvarchar(50),
@Email           			nvarchar(100),   
@Password    			nvarchar(255),
@Gender			nchar(1),
@ProfileApproved		bit,
@ApprovedForForums		bit,
@Trusted			bit,
@DisplayInMemberList		bit,
@WebSiteURL			nvarchar(100),
@Country			nvarchar(100),
@State				nvarchar(100),
@Occupation			nvarchar(100),
@Interests			nvarchar(100),
@MSN				nvarchar(50),
@Yahoo			nvarchar(50),
@AIM				nvarchar(50),
@ICQ				nvarchar(50),
@AvatarUrl			nvarchar(255),
@Signature			nvarchar(255),
@Skin				nvarchar(100),
@LoweredEmail		nvarchar(100),
@PasswordQuestion		nvarchar(255),
@PasswordAnswer		nvarchar(255),
@Comment		ntext,
@TimeOffsetHours	int,
@OpenIDURI			nvarchar(255),
@WindowsLiveID			nvarchar(255)



AS
UPDATE		mp_Users

SET			[Name] = @Name,
			LoginName = @LoginName,
			Email = @Email,
    			[Password] = @Password,
			Gender = @Gender,
			ProfileApproved = @ProfileApproved,
			ApprovedForForums = @ApprovedForForums,
			Trusted = @Trusted,
			DisplayInMemberList = @DisplayInMemberList,
			WebSiteURL = @WebSiteURL,
			Country = @Country,
			[State] = @State,
			Occupation = @Occupation,
			Interests = @Interests,
			MSN = @MSN,
			Yahoo = @Yahoo,
			AIM = @AIM,
			ICQ = @ICQ,
			AvatarUrl = @AvatarUrl,
			[Signature] = @Signature,
			Skin = @Skin,
			LoweredEmail = @LoweredEmail,
			PasswordQuestion = @PasswordQuestion,
			PasswordAnswer = @PasswordAnswer,
			Comment = @Comment,
			TimeOffsetHours = @TimeOffsetHours,
			OpenIDURI = @OpenIDURI,
			WindowsLiveID = @WindowsLiveID
			
WHERE		UserID = @UserID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_Count]    Script Date: 11/10/2008 11:51:55 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_Count]

/*
Author:			
Created:		11/29/2004
Last Modified:		5/12/2005

*/

@SiteID		int

AS

SELECT  	COUNT(*)

FROM		mp_Users

WHERE	SiteID = @SiteID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SelectByEmail]    Script Date: 11/10/2008 11:51:59 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Users_SelectByEmail]

    
@SiteID	int,
@Email 		nvarchar(100)


AS

SELECT	*

FROM
    mp_Users

WHERE
	SiteID = @SiteID
   	AND Email = @Email
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_IncrementTotalPosts]    Script Date: 11/10/2008 11:51:57 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_IncrementTotalPosts]

/*
Author:				
Created:			10/3/2004
Last Modified:			10/3/2004

*/

@UserID		int

AS


UPDATE		mp_Users

SET			TotalPosts = TotalPosts + 1

WHERE		UserID = @UserID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_LoginByEmail]    Script Date: 11/10/2008 11:51:59 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE Procedure [dbo].[mp_Users_LoginByEmail]

   
@SiteID	int, 
@Email    	nvarchar(100), 
@Password 	nvarchar(128), 
@UserName 	nvarchar(100) OUTPUT

AS

SELECT
    @UserName = Name

FROM
    mp_Users

WHERE
		SiteID = @SiteID
    		AND Email = @Email
  		AND [Password] = @Password
GO
/****** Object:  StoredProcedure [dbo].[mp_UserRoles_SelectNotInRole]    Script Date: 11/10/2008 11:51:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserRoles_SelectNotInRole]

@SiteID	int,
@RoleID  int

AS
SELECT  DISTINCT
    		u.UserID,
    		u.[Name],
    		u.Email,
			u.LoginName

FROM		mp_Users  u
    		
    
LEFT OUTER JOIN 		
		mp_UserRoles ur

ON 		u.UserID = ur.UserID
		AND ur.RoleID = @RoleID

WHERE		u.SiteID = @SiteID
    		
			AND ur.RoleID IS NULL

ORDER BY	u.[Name]
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_GetNewestUserID]    Script Date: 11/10/2008 11:51:57 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_GetNewestUserID]

/*
Author:			
Created:		12/3/2006
Last Modified:	12/3/2006

*/

@SiteID		int

AS
SELECT  	MAX(UserID)

FROM		mp_Users

WHERE	SiteID = @SiteID
GO
/****** Object:  StoredProcedure [dbo].[mp_UserRoles_SelectByRoleID]    Script Date: 11/10/2008 11:51:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserRoles_SelectByRoleID]

    
@RoleID  int

AS

SELECT  
    		ur.UserID,
    		u.[Name],
    		u.Email,
		u.LoginName

FROM
    		mp_UserRoles ur
    
JOIN 		mp_Users  u
ON 		u.UserID = ur.UserID

WHERE   
    		ur.RoleID = @RoleID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SelectUsersOnlineSinceTime]    Script Date: 11/10/2008 11:52:01 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_SelectUsersOnlineSinceTime]

/*
Author:			
Created:		11/7/2006
Last Modified:	11/7/2006

*/

@SiteID		int,
@SinceTime		datetime

AS
SELECT  	*

FROM		mp_Users

WHERE	SiteID = @SiteID
		AND LastActivityDate > @SinceTime
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_DecrementTotalPosts]    Script Date: 11/10/2008 11:51:56 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_DecrementTotalPosts]

/*
Author:				
Created:			10/3/2004
Last Modified:			10/3/2004

*/

@UserID		int

AS


UPDATE		mp_Users

SET			TotalPosts = TotalPosts - 1

WHERE		UserID = @UserID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SetFailedPasswordAnswerAttemptCount]    Script Date: 11/10/2008 11:52:01 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_SetFailedPasswordAnswerAttemptCount]

/*
Author:				
Created:			1/18/2007
Last Modified:		4/29/2007

*/

@UserGuid uniqueidentifier,
@AttemptCount int

AS
UPDATE		mp_Users

SET			

FailedPwdAnswerAttemptCount = @AttemptCount


WHERE		UserGuid = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_UpdateLastActivityTime]    Script Date: 11/10/2008 11:52:04 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_UpdateLastActivityTime]


@UserID	uniqueidentifier,
@LastUpdate	datetime


AS

UPDATE mp_Users WITH (ROWLOCK)
SET LastActivityDate = @LastUpdate
WHERE UserGuid = @UserID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SelectOne]    Script Date: 11/10/2008 11:52:00 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_SelectOne]

/*
Author:			
Created:		10/3/2004
Last Modified:		10/3/2004

*/

@UserID		int

AS

SELECT	*

FROM		mp_Users

WHERE	UserID = @UserID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_CountByFirstLetter]    Script Date: 11/10/2008 11:51:55 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_CountByFirstLetter]

/*
Author:			
Created:		12/7/2006
Last Modified:	12/7/2006

*/

@SiteID		int,
@UserNameBeginsWith 		nvarchar(1)

AS
SELECT  	COUNT(*)

FROM		mp_Users

WHERE	SiteID = @SiteID
AND (
	(LEFT([Name], 1) = @UserNameBeginsWith)
	OR @UserNameBeginsWith = ''
	)
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_GetCountByMonthYear]    Script Date: 11/10/2008 11:51:57 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Users_GetCountByMonthYear]


@SiteID		int

AS
SELECT  
	YEAR(DateCreated) As Y,
    MONTH(DateCreated) As M,
	CONVERT(varchar(10),YEAR(DateCreated)) + '-' + CONVERT(varchar(3),MONTH(DateCreated)) As Label,
	COUNT(*) As Users

FROM
    mp_Users

WHERE SiteID = @SiteID
    

GROUP BY YEAR(DateCreated), MONTH(DateCreated), CONVERT(varchar(10), YEAR(DateCreated)) + '-' + CONVERT(varchar(3), MONTH(DateCreated))
ORDER BY 
YEAR(DateCreated), MONTH(DateCreated)
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SelectGuidByWindowsLiveID]    Script Date: 11/10/2008 11:52:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Users_SelectGuidByWindowsLiveID]

    
@SiteID	int,
@WindowsLiveID 		nvarchar(36)


AS

SELECT	UserGuid

FROM
    mp_Users

WHERE
	SiteID = @SiteID
   	AND WindowsLiveID = @WindowsLiveID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_FlagAsDeleted]    Script Date: 11/10/2008 11:51:57 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_FlagAsDeleted]


@UserID int

AS

UPDATE
    mp_Users

SET	IsDeleted = 1

WHERE
    UserID=@UserID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_Delete]    Script Date: 11/10/2008 11:51:56 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Users_Delete]
(
    @UserID int
)
AS

DELETE FROM
    mp_Users

WHERE
    UserID=@UserID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_Insert]    Script Date: 11/10/2008 11:51:58 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE Procedure [dbo].[mp_Users_Insert]

/*
Author:			
Created:		9/30/2004
Last Modified:	2008-01-27

*/

@SiteGuid	uniqueidentifier,
@SiteID	int,
@Name     	nvarchar(50),
@LoginName	nvarchar(50),
@Email    	nvarchar(100),
@Password 	nvarchar(50),
@UserGuid	uniqueidentifier,
@DateCreated datetime


AS
INSERT INTO 		mp_Users
(
		SiteGuid,
			SiteID,
    			[Name],
			LoginName,
    			Email,
    			[Password],
			UserGuid,
			DateCreated
	

)

VALUES
(
			@SiteGuid,
			@SiteID,
    			@Name,
			@LoginName,
    			@Email,
    			@Password,
			@UserGuid,
			@DateCreated
)

SELECT		@@Identity As UserID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_UpdateLastPasswordChangeTime]    Script Date: 11/10/2008 11:52:05 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_UpdateLastPasswordChangeTime]


@UserID	uniqueidentifier,
@PasswordChangeTime	datetime


AS

UPDATE mp_Users WITH (ROWLOCK)
SET LastPasswordChangedDate = @PasswordChangeTime
WHERE UserGuid = @UserID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_AccountClearLockout]    Script Date: 11/10/2008 11:51:55 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_AccountClearLockout]

@UserGuid		uniqueidentifier


AS

UPDATE	mp_Users
SET		IsLockedOut = 0
		

WHERE	UserGuid = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SelectGuidByOpenIDURI]    Script Date: 11/10/2008 11:52:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Users_SelectGuidByOpenIDURI]

    
@SiteID	int,
@OpenIDURI 		nvarchar(255)


AS

SELECT	UserGuid

FROM
    mp_Users

WHERE
	SiteID = @SiteID
   	AND OpenIDURI = @OpenIDURI
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_Login]    Script Date: 11/10/2008 11:51:58 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE Procedure [dbo].[mp_Users_Login]

   
@SiteID	int, 
@LoginName    	nvarchar(50), 
@Password 	nvarchar(128), 
@UserName 	nvarchar(100) OUTPUT

AS
SELECT
    @UserName = Name

FROM
    mp_Users

WHERE
		SiteID = @SiteID
    		AND LoginName = @LoginName
  		AND [Password] = @Password
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_AccountLockout]    Script Date: 11/10/2008 11:51:55 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_AccountLockout]

@UserGuid		uniqueidentifier,
@LockoutTime		datetime

AS

UPDATE	mp_Users
SET		IsLockedOut = 1,
		LastLockoutDate = @LockoutTime

WHERE	UserGuid = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SmartDropDown]    Script Date: 11/10/2008 11:52:02 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Users_SmartDropDown]

/*
Author:		
Created:	6/19/2005
Last Modified:	6/19/2005

*/


@SiteID			int,
@Query				nvarchar(50),
@RowsToGet			int


AS


SET ROWCOUNT @RowsToGet


SELECT 		u1.UserID,
			u1.[Name] AS SiteUser

FROM			mp_Users u1

WHERE		u1.SiteID = @SiteID
			AND u1.[Name] LIKE @Query + '%'

UNION

SELECT 		u2.UserID,
			u2.[Email] As SiteUser

FROM			mp_Users u2

WHERE		u2.SiteID = @SiteID
			AND u2.[Email] LIKE @Query + '%'

ORDER BY		SiteUser
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SelectByLoginName]    Script Date: 11/10/2008 11:51:59 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_SelectByLoginName]

    
@SiteID	int,
@LoginName 		nvarchar(50)


AS

SELECT	*

FROM
    mp_Users

WHERE
	SiteID = @SiteID
   	AND LoginName = @LoginName
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SelectByGuid]    Script Date: 11/10/2008 11:51:59 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_SelectByGuid]

/*
Author:			
Created:		4/15/2006
Last Modified:		4/15/2006

*/

@UserGuid	uniqueidentifier

AS

SELECT	*

FROM		mp_Users

WHERE	UserGuid = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_CountOnlineSinceTime]    Script Date: 11/10/2008 11:51:56 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_CountOnlineSinceTime]

/*
Author:			
Created:		4/15/2006
Last Modified:		4/15/2006

*/

@SiteID		int,
@SinceTime		datetime

AS

SELECT  	COUNT(*)

FROM		mp_Users

WHERE	SiteID = @SiteID
		AND LastActivityDate > @SinceTime
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_UpdatePasswordQuestionAndAnswer]    Script Date: 11/10/2008 11:52:05 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_UpdatePasswordQuestionAndAnswer]


@UserID		uniqueidentifier,
@PasswordQuestion	nvarchar(255),
@PasswordAnswer	nvarchar(255)


AS

UPDATE mp_Users WITH (ROWLOCK)
SET PasswordQuestion = @PasswordQuestion,
	PasswordAnswer = @PasswordAnswer

WHERE UserGuid = @UserID
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_ConfirmRegistration]    Script Date: 11/10/2008 11:51:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[mp_Users_ConfirmRegistration] 

@EmptyGuid					uniqueidentifier,
@RegisterConfirmGuid		uniqueidentifier

AS
UPDATE	mp_Users
SET		IsLockedOut = 0,
		RegisterConfirmGuid = @EmptyGuid
		

WHERE	RegisterConfirmGuid = @RegisterConfirmGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_Select]    Script Date: 11/10/2008 11:51:59 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Users_Select]


@SiteID		int

AS
SELECT  
    UserID,
	LoginName,
    Email,
	Password

FROM
    mp_Users

WHERE SiteID = @SiteID
    
ORDER BY Email
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SelectTop50UsersOnlineSinceTime]    Script Date: 11/10/2008 11:52:01 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_SelectTop50UsersOnlineSinceTime]

/*
Author:			
Created:		11/7/2006
Last Modified:	11/7/2006

*/

@SiteID		int,
@SinceTime		datetime

AS
SELECT TOP 50 	*

FROM		mp_Users

WHERE	SiteID = @SiteID
		AND LastActivityDate > @SinceTime

ORDER BY LastActivityDate desc
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SetFailedPasswordAttemptCount]    Script Date: 11/10/2008 11:52:02 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_SetFailedPasswordAttemptCount]

/*
Author:				
Created:			1/18/2007
Last Modified:		1/18/2007

*/

@UserGuid uniqueidentifier,
@AttemptCount int

AS
UPDATE		mp_Users

SET			

FailedPasswordAttemptCount = @AttemptCount


WHERE		UserGuid = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_SetFailedPasswordAnswerAttemptStartWindow]    Script Date: 11/10/2008 11:52:01 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_SetFailedPasswordAnswerAttemptStartWindow]

/*
Author:				
Created:			1/18/2007
Last Modified:		4/29/2007

*/

@UserGuid uniqueidentifier,
@WindowStartTime datetime

AS
UPDATE		mp_Users

SET			

FailedPwdAnswerWindowStart = @WindowStartTime


WHERE		UserGuid = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_Users_CountByRegistrationDateRange]    Script Date: 11/10/2008 11:51:56 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_Users_CountByRegistrationDateRange]

/*
Author:				
Created:			12/3/2006
Last Modified:		12/3/2006

*/

@SiteID		int,
@BeginDate	datetime,
@EndDate	datetime

AS
SELECT  	COUNT(*)

FROM		mp_Users

WHERE	SiteID = @SiteID
AND DateCreated Between @BeginDate And @EndDate
GO
/****** Object:  StoredProcedure [dbo].[mp_Currency_Update]    Script Date: 11/10/2008 11:50:22 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Currency_Update]

/*
Author:   			
Created: 			2/18/2007
Last Modified: 		2/18/2007
*/
	
@Guid uniqueidentifier, 
@Title nvarchar(50), 
@Code nchar(3), 
@SymbolLeft nvarchar(15), 
@SymbolRight nvarchar(15), 
@DecimalPointChar nchar(1), 
@ThousandsPointChar nchar(1), 
@DecimalPlaces nchar(1), 
@Value decimal(13, 8), 
@LastModified datetime



AS

UPDATE 		[dbo].[mp_Currency] 

SET
			[Title] = @Title,
			[Code] = @Code,
			[SymbolLeft] = @SymbolLeft,
			[SymbolRight] = @SymbolRight,
			[DecimalPointChar] = @DecimalPointChar,
			[ThousandsPointChar] = @ThousandsPointChar,
			[DecimalPlaces] = @DecimalPlaces,
			[Value] = @Value,
			[LastModified] = @LastModified
			
WHERE
			[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_Currency_Delete]    Script Date: 11/10/2008 11:50:21 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Currency_Delete]

/*
Author:   			
Created: 			2/18/2007
Last Modified: 		2/18/2007
*/

@Guid uniqueidentifier

AS

DELETE FROM [dbo].[mp_Currency]
WHERE
	[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_Currency_SelectOne]    Script Date: 11/10/2008 11:50:22 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Currency_SelectOne]

/*
Author:   			
Created: 			2/18/2007
Last Modified: 		2/18/2007
*/

@Guid uniqueidentifier

AS


SELECT
		[Guid],
		[Title],
		[Code],
		[SymbolLeft],
		[SymbolRight],
		[DecimalPointChar],
		[ThousandsPointChar],
		[DecimalPlaces],
		[Value],
		[LastModified],
		[Created]
		
FROM
		[dbo].[mp_Currency]
		
WHERE
		[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_Currency_SelectAll]    Script Date: 11/10/2008 11:50:21 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Currency_SelectAll]

/*
Author:   			
Created: 			2/18/2007
Last Modified: 		2/18/2007
*/

AS


SELECT
		[Guid],
		[Title],
		[Code],
		[SymbolLeft],
		[SymbolRight],
		[DecimalPointChar],
		[ThousandsPointChar],
		[DecimalPlaces],
		[Value],
		[LastModified],
		[Created]
		
FROM
		[dbo].[mp_Currency]

ORDER BY [Title]
GO
/****** Object:  StoredProcedure [dbo].[mp_Currency_Insert]    Script Date: 11/10/2008 11:50:21 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_Currency_Insert]

/*
Author:   			
Created: 			2/18/2007
Last Modified: 		2/18/2007
*/

@Guid uniqueidentifier,
@Title nvarchar(50),
@Code nchar(3),
@SymbolLeft nvarchar(15),
@SymbolRight nvarchar(15),
@DecimalPointChar nchar(1),
@ThousandsPointChar nchar(1),
@DecimalPlaces nchar(1),
@Value decimal(13, 8),
@LastModified datetime,
@Created datetime

	
AS

INSERT INTO 	[dbo].[mp_Currency] 
(
				[Guid],
				[Title],
				[Code],
				[SymbolLeft],
				[SymbolRight],
				[DecimalPointChar],
				[ThousandsPointChar],
				[DecimalPlaces],
				[Value],
				[LastModified],
				[Created]
) 

VALUES 
(
				@Guid,
				@Title,
				@Code,
				@SymbolLeft,
				@SymbolRight,
				@DecimalPointChar,
				@ThousandsPointChar,
				@DecimalPlaces,
				@Value,
				@LastModified,
				@Created
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_TaxClass_SelectOne]    Script Date: 11/10/2008 11:51:42 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_TaxClass_SelectOne]

/*
Author:   			
Created: 			2/17/2007
Last Modified: 		2/17/2007
*/

@Guid uniqueidentifier

AS


SELECT
		*
		
FROM
		[dbo].[mp_TaxClass]
		
WHERE
		[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_TaxClass_SelectBySite]    Script Date: 11/10/2008 11:51:42 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_TaxClass_SelectBySite]

/*
Author:   			
Created: 			2/17/2007
Last Modified: 		2/17/2007
*/

@SiteGuid uniqueidentifier

AS


SELECT
		*
		
FROM
		[dbo].[mp_TaxClass]

WHERE	[SiteGuid] = @SiteGuid

ORDER BY	[Title]
GO
/****** Object:  StoredProcedure [dbo].[mp_TaxClass_Delete]    Script Date: 11/10/2008 11:51:41 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_TaxClass_Delete]

/*
Author:   			
Created: 			2/17/2007
Last Modified: 		2/17/2007
*/

@Guid uniqueidentifier

AS

DELETE FROM [dbo].[mp_TaxClass]
WHERE
	[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_TaxClass_Insert]    Script Date: 11/10/2008 11:51:41 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_TaxClass_Insert]

/*
Author:   			
Created: 			2/17/2007
Last Modified: 		2/17/2007
*/

@Guid uniqueidentifier,
@SiteGuid uniqueidentifier,
@Title nvarchar(255),
@Description ntext,
@LastModified datetime,
@Created datetime

	
AS

INSERT INTO 	[dbo].[mp_TaxClass] 
(
				[Guid],
				[SiteGuid],
				[Title],
				[Description],
				[LastModified],
				[Created]
) 

VALUES 
(
				@Guid,
				@SiteGuid,
				@Title,
				@Description,
				@LastModified,
				@Created
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_TaxClass_CountBySite]    Script Date: 11/10/2008 11:51:41 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_TaxClass_CountBySite]

/*
Author:   			
Created: 			2/17/2007
Last Modified: 		2/17/2007
*/

@SiteGuid uniqueidentifier

AS


SELECT COUNT(*)
		
FROM
		[dbo].[mp_TaxClass]

WHERE	[SiteGuid] = @SiteGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_TaxClass_Update]    Script Date: 11/10/2008 11:51:42 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_TaxClass_Update]

/*
Author:   			
Created: 			2/17/2007
Last Modified: 		2/17/2007
*/
	
@Guid uniqueidentifier,  
@Title nvarchar(255), 
@Description ntext, 
@LastModified datetime, 
@Created datetime 


AS

UPDATE 		[dbo].[mp_TaxClass] 

SET
			[Title] = @Title,
			[Description] = @Description,
			[LastModified] = @LastModified,
			[Created] = @Created
			
WHERE
			[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_UserLocation_GetCountByUser]    Script Date: 11/10/2008 11:51:46 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserLocation_GetCountByUser]

/*
Author:   			
Created: 			2008-1-4
Last Modified: 		2008-1-4
*/

@UserGuid	uniqueidentifier

AS

SELECT COUNT(*) 
FROM [dbo].[mp_UserLocation]
WHERE [UserGuid] = @UserGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_UserLocation_SelectOne]    Script Date: 11/10/2008 11:51:48 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserLocation_SelectOne]

/*
Author:   			
Created: 			2008-1-4
Last Modified: 		2008-1-4
*/

@RowID uniqueidentifier

AS


SELECT
		[RowID],
		[UserGuid],
		[SiteGuid],
		[IPAddress],
		[IPAddressLong],
		[Hostname],
		[Longitude],
		[Latitude],
		[ISP],
		[Continent],
		[Country],
		[Region],
		[City],
		[TimeZone],
		[CaptureCount],
		[FirstCaptureUTC],
		[LastCaptureUTC]
		
FROM
		[dbo].[mp_UserLocation]
		
WHERE
		[RowID] = @RowID
GO
/****** Object:  StoredProcedure [dbo].[mp_UserLocation_Delete]    Script Date: 11/10/2008 11:51:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserLocation_Delete]

/*
Author:   			
Created: 			2008-1-4
Last Modified: 		2008-1-4
*/

@RowID uniqueidentifier

AS

DELETE FROM [dbo].[mp_UserLocation]
WHERE
	[RowID] = @RowID
GO
/****** Object:  StoredProcedure [dbo].[mp_UserLocation_Exists]    Script Date: 11/10/2008 11:51:46 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserLocation_Exists]

/*
Author:   			
Created: 			2008-1-4
Last Modified: 		2008-1-4
*/

@UserGuid	uniqueidentifier,
@IPAddressLong bigint

AS

SELECT COUNT(*) 
FROM [dbo].[mp_UserLocation]
WHERE [UserGuid] = @UserGuid
AND IPAddressLong = @IPAddressLong
GO
/****** Object:  StoredProcedure [dbo].[mp_UserLocation_SelectOneByUserAndIP]    Script Date: 11/10/2008 11:51:48 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserLocation_SelectOneByUserAndIP]

/*
Author:   			
Created: 			2008-1-4
Last Modified: 		2008-1-4
*/

@UserGuid uniqueidentifier,
@IPAddressLong	bigint

AS


SELECT
		[RowID],
		[UserGuid],
		[SiteGuid],
		[IPAddress],
		[IPAddressLong],
		[Hostname],
		[Longitude],
		[Latitude],
		[ISP],
		[Continent],
		[Country],
		[Region],
		[City],
		[TimeZone],
		[CaptureCount],
		[FirstCaptureUTC],
		[LastCaptureUTC]
		
FROM
		[dbo].[mp_UserLocation]
		
WHERE
		[UserGuid] = @UserGuid
		AND [IPAddressLong] = @IPAddressLong
GO
/****** Object:  StoredProcedure [dbo].[mp_UserLocation_SelectByUser]    Script Date: 11/10/2008 11:51:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserLocation_SelectByUser]

/*
Author:   			
Created: 			2008-1-4
Last Modified: 		2008-1-4
*/

@UserGuid uniqueidentifier

AS


SELECT
		[RowID],
		[UserGuid],
		[SiteGuid],
		[IPAddress],
		[IPAddressLong],
		[Hostname],
		[Longitude],
		[Latitude],
		[ISP],
		[Continent],
		[Country],
		[Region],
		[City],
		[TimeZone],
		[CaptureCount],
		[FirstCaptureUTC],
		[LastCaptureUTC]
		
FROM
		[dbo].[mp_UserLocation]
		
WHERE
		[UserGuid] = @UserGuid

ORDER BY	
		[LastCaptureUTC] DESC
GO
/****** Object:  StoredProcedure [dbo].[mp_UserLocation_SelectBySite]    Script Date: 11/10/2008 11:51:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserLocation_SelectBySite]

/*
Author:   			
Created: 			2008-1-4
Last Modified: 		2008-1-4
*/

@SiteGuid uniqueidentifier

AS


SELECT
		[RowID],
		[UserGuid],
		[SiteGuid],
		[IPAddress],
		[IPAddressLong],
		[Hostname],
		[Longitude],
		[Latitude],
		[ISP],
		[Continent],
		[Country],
		[Region],
		[City],
		[TimeZone],
		[CaptureCount],
		[FirstCaptureUTC],
		[LastCaptureUTC]
		
FROM
		[dbo].[mp_UserLocation]
		
WHERE
		[SiteGuid] = @SiteGuid

ORDER BY	
		[IPAddressLong]
GO
/****** Object:  StoredProcedure [dbo].[mp_UserLocation_Update]    Script Date: 11/10/2008 11:51:49 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserLocation_Update]

/*
Author:   			
Created: 			2008-1-4
Last Modified: 		2008-1-4
*/
	
@RowID uniqueidentifier, 
@UserGuid uniqueidentifier, 
@SiteGuid uniqueidentifier, 
@IPAddress nvarchar(50), 
@IPAddressLong bigint, 
@Hostname nvarchar(255), 
@Longitude float, 
@Latitude float, 
@ISP nvarchar(255), 
@Continent nvarchar(255), 
@Country nvarchar(255), 
@Region nvarchar(255), 
@City nvarchar(255), 
@TimeZone nvarchar(255), 
@CaptureCount int,  
@LastCaptureUTC datetime 


AS

UPDATE 		[dbo].[mp_UserLocation] 

SET
			[UserGuid] = @UserGuid,
			[SiteGuid] = @SiteGuid,
			[IPAddress] = @IPAddress,
			[IPAddressLong] = @IPAddressLong,
			[Hostname] = @Hostname,
			[Longitude] = @Longitude,
			[Latitude] = @Latitude,
			[ISP] = @ISP,
			[Continent] = @Continent,
			[Country] = @Country,
			[Region] = @Region,
			[City] = @City,
			[TimeZone] = @TimeZone,
			[CaptureCount] = @CaptureCount,
			[LastCaptureUTC] = @LastCaptureUTC
			
WHERE
			[RowID] = @RowID
GO
/****** Object:  StoredProcedure [dbo].[mp_UserLocation_Insert]    Script Date: 11/10/2008 11:51:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserLocation_Insert]

/*
Author:   			
Created: 			2008-1-4
Last Modified: 		2008-1-4
*/

@RowID uniqueidentifier,
@UserGuid uniqueidentifier,
@SiteGuid uniqueidentifier,
@IPAddress nvarchar(50),
@IPAddressLong bigint,
@Hostname nvarchar(255),
@Longitude float,
@Latitude float,
@ISP nvarchar(255),
@Continent nvarchar(255),
@Country nvarchar(255),
@Region nvarchar(255),
@City nvarchar(255),
@TimeZone nvarchar(255),
@CaptureCount int,
@FirstCaptureUTC datetime,
@LastCaptureUTC datetime

	
AS

INSERT INTO 	[dbo].[mp_UserLocation] 
(
				[RowID],
				[UserGuid],
				[SiteGuid],
				[IPAddress],
				[IPAddressLong],
				[Hostname],
				[Longitude],
				[Latitude],
				[ISP],
				[Continent],
				[Country],
				[Region],
				[City],
				[TimeZone],
				[CaptureCount],
				[FirstCaptureUTC],
				[LastCaptureUTC]
) 

VALUES 
(
				@RowID,
				@UserGuid,
				@SiteGuid,
				@IPAddress,
				@IPAddressLong,
				@Hostname,
				@Longitude,
				@Latitude,
				@ISP,
				@Continent,
				@Country,
				@Region,
				@City,
				@TimeZone,
				@CaptureCount,
				@FirstCaptureUTC,
				@LastCaptureUTC
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_UserLocation_GetCountBySite]    Script Date: 11/10/2008 11:51:46 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserLocation_GetCountBySite]

/*
Author:   			
Created: 			2008-1-4
Last Modified: 		2008-1-4
*/

@SiteGuid	uniqueidentifier

AS

SELECT COUNT(*) 
FROM [dbo].[mp_UserLocation]
WHERE [SiteGuid] = @SiteGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_UserRoles_DeleteUserRoles]    Script Date: 11/10/2008 11:51:54 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_UserRoles_DeleteUserRoles]

/*
Author:			
Created:		11/30/2005
Last Modified:		11/30/2005

*/
    
@UserID int

AS

DELETE FROM	mp_UserRoles

WHERE	UserID = @UserID
GO
/****** Object:  StoredProcedure [dbo].[mp_UserRoles_Delete]    Script Date: 11/10/2008 11:51:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_UserRoles_Delete]
(
   
    	@RoleID int,
	 @UserID int
)
AS

DELETE FROM
    mp_UserRoles

WHERE
    UserID=@UserID
    AND
    RoleID=@RoleID
GO
/****** Object:  StoredProcedure [dbo].[mp_UserRoles_Insert]    Script Date: 11/10/2008 11:51:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE Procedure [dbo].[mp_UserRoles_Insert]
(
@RoleID int,
@UserID int,
@RoleGuid	uniqueidentifier,
@UserGuid	uniqueidentifier
    
)
AS

IF NOT EXISTS (SELECT RoleID FROM mp_UserRoles
WHERE UserID = @UserID AND RoleID = @RoleID)
BEGIN
INSERT INTO mp_UserRoles
    (
        UserID,
        RoleID,
		RoleGuid,
		UserGuid
    )

    VALUES
    (
        @UserID,
        @RoleID,
		@RoleGuid,
		@UserGuid
    )
END
GO
/****** Object:  StoredProcedure [dbo].[mp_FriendlyUrls_Delete]    Script Date: 11/10/2008 11:50:22 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_FriendlyUrls_Delete]

/*
Author:   			
Created: 			6/1/2005
Last Modified: 			6/1/2005

*/

@UrlID int

AS

DELETE FROM [dbo].[mp_FriendlyUrls]
WHERE
	[UrlID] = @UrlID
GO
/****** Object:  StoredProcedure [dbo].[mp_FriendlyUrls_DeleteByPageID]    Script Date: 11/10/2008 11:50:23 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_FriendlyUrls_DeleteByPageID]

/*
Author:   			
Created: 			6/1/2005
Last Modified: 			6/1/2005

*/

@PageID int

AS

DELETE FROM [dbo].[mp_FriendlyUrls]
WHERE
	RealUrl LIKE '%pageid=' + CONVERT(varchar(255), @PageID)
GO
/****** Object:  StoredProcedure [dbo].[mp_FriendlyUrls_Exists]    Script Date: 11/10/2008 11:50:23 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_FriendlyUrls_Exists]

/*
Author:			
Created:		2007-06-08
Last Modified:	2007-06-08

*/
    
@SiteID  	int,
@FriendlyUrl	nvarchar(255)

AS

IF EXISTS (	SELECT 	UrlID
		FROM		mp_FriendlyUrls
		WHERE	SiteID = @SiteID
				AND FriendlyUrl = @FriendlyUrl)
SELECT 1
ELSE
SELECT 0
GO
/****** Object:  StoredProcedure [dbo].[mp_FriendlyUrls_SelectBySiteID]    Script Date: 11/10/2008 11:50:24 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_FriendlyUrls_SelectBySiteID]

/*
Author:   			
Created: 			2007/06/07
Last Modified: 		2007/06/07
*/

@SiteID		int

AS




SELECT
		*
		
FROM
		[dbo].[mp_FriendlyUrls]

WHERE	SiteID = @SiteID
ORDER BY FriendlyUrl
GO
/****** Object:  StoredProcedure [dbo].[mp_FriendlyUrls_SelectOne]    Script Date: 11/10/2008 11:50:25 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_FriendlyUrls_SelectOne]

/*
Author:   			
Created: 			6/1/2005
Last Modified: 		2008-01-27

*/

@UrlID int

AS

SELECT
		*
		
FROM
		[dbo].[mp_FriendlyUrls]
		
WHERE
		[UrlID] = @UrlID
GO
/****** Object:  StoredProcedure [dbo].[mp_FriendlyUrls_SelectBySiteUrl]    Script Date: 11/10/2008 11:50:24 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_FriendlyUrls_SelectBySiteUrl]

/*
Author:   			
Created: 			9/10/2006
Last Modified: 		4/15/2007
*/

@SiteID				int,
@FriendlyUrl		varchar(255)

AS
SELECT *
		
FROM
		[dbo].[mp_FriendlyUrls] u


WHERE	u.SiteID = @SiteID
		AND u.FriendlyUrl = @FriendlyUrl
GO
/****** Object:  StoredProcedure [dbo].[mp_FriendlyUrls_Insert]    Script Date: 11/10/2008 11:50:24 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_FriendlyUrls_Insert]

/*
Author:   			
Created: 			6/1/2005
Last Modified: 		2008-01-27


*/

@ItemGuid	uniqueidentifier,
@SiteGuid	uniqueidentifier,
@PageGuid	uniqueidentifier,
@SiteID int,
@FriendlyUrl varchar(255),
@RealUrl varchar(255),
@IsPattern bit

	
AS

INSERT INTO 	[dbo].[mp_FriendlyUrls] 
(
				ItemGuid,
				SiteGuid,
				PageGuid,
				[SiteID],
				[FriendlyUrl],
				[RealUrl],
				[IsPattern]
) 

VALUES 
(
				@ItemGuid,
				@SiteGuid,
				@PageGuid,
				@SiteID,
				@FriendlyUrl,
				@RealUrl,
				@IsPattern
				
)
SELECT @@IDENTITY
GO
/****** Object:  StoredProcedure [dbo].[mp_FriendlyUrls_DeleteByPageGuid]    Script Date: 11/10/2008 11:50:23 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_FriendlyUrls_DeleteByPageGuid]

/*
Author:   			
Created: 			2008-05-15
Last Modified: 		2008-05-15

*/

@PageGuid	uniqueidentifier

AS

DELETE FROM [dbo].[mp_FriendlyUrls]
WHERE
	[PageGuid] = @PageGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_FriendlyUrls_GetCount]    Script Date: 11/10/2008 11:50:23 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_FriendlyUrls_GetCount]

/*
Author:   			
Created: 			2008-6-15
Last Modified: 		2008-6-15
*/

@SiteID int

AS

SELECT COUNT(*) 
FROM [dbo].[mp_FriendlyUrls]
WHERE SiteID = @SiteID
GO
/****** Object:  StoredProcedure [dbo].[mp_FriendlyUrls_Update]    Script Date: 11/10/2008 11:50:25 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_FriendlyUrls_Update]

/*
Author:   			
Created: 			6/1/2005
Last Modified: 		2008-01-27


*/
	
@UrlID int, 
@SiteID int, 
@FriendlyUrl varchar(255), 
@RealUrl varchar(255), 
@IsPattern bit ,
@PageGuid	uniqueidentifier

AS

UPDATE 		[dbo].[mp_FriendlyUrls] 

SET
			[SiteID] = @SiteID,
			[FriendlyUrl] = @FriendlyUrl,
			[RealUrl] = @RealUrl,
			[IsPattern] = @IsPattern,
			PageGuid = @PageGuid
			
WHERE
			[UrlID] = @UrlID
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_GetUnfinishedCount]    Script Date: 11/10/2008 11:51:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_GetUnfinishedCount]

/*
Author:   			
Created: 			2007-12-29
Last Modified: 		2007-12-29
*/

AS

SELECT COUNT(*) 
FROM [dbo].[mp_TaskQueue]
WHERE	
		CompleteUTC IS NULL
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_UpdateNotification]    Script Date: 11/10/2008 11:51:40 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_UpdateNotification]

/*
Author:   			
Created: 			2008-01-05
Last Modified: 		2008-01-05
*/
	
@Guid uniqueidentifier,  
@NotificationSentUTC datetime


AS

UPDATE 		[dbo].[mp_TaskQueue] 

SET
			
			[NotificationSentUTC] = @NotificationSentUTC
			
			
WHERE
			[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_GetCount]    Script Date: 11/10/2008 11:51:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_GetCount]

/*
Author:   			
Created: 			2007-12-29
Last Modified: 		2007-12-29
*/


AS

SELECT COUNT(*) 
FROM [dbo].[mp_TaskQueue]
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_Delete]    Script Date: 11/10/2008 11:51:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_Delete]

/*
Author:   			
Created: 			2007-12-29
Last Modified: 		2007-12-29
*/

@Guid uniqueidentifier

AS

DELETE FROM [dbo].[mp_TaskQueue]
WHERE
	[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_Update]    Script Date: 11/10/2008 11:51:40 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_Update]

/*
Author:   			
Created: 			2007-12-29
Last Modified: 		2007-12-29
*/
	
@Guid uniqueidentifier,  
@StartUTC datetime, 
@CompleteUTC datetime, 
@LastStatusUpdateUTC datetime, 
@CompleteRatio float, 
@Status nvarchar(255)


AS

UPDATE 		[dbo].[mp_TaskQueue] 

SET
			
			[StartUTC] = @StartUTC,
			[CompleteUTC] = @CompleteUTC,
			[LastStatusUpdateUTC] = @LastStatusUpdateUTC,
			[CompleteRatio] = @CompleteRatio,
			[Status] = @Status
			
			
WHERE
			[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_SelectTasksNotStarted]    Script Date: 11/10/2008 11:51:39 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_SelectTasksNotStarted]

/*
Author:   			
Created: 			2007-12-29
Last Modified: 		2008-01-05
*/

AS


SELECT
		[Guid],
		[SiteGuid],
		[QueuedBy],
		[TaskName],
		[NotifyOnCompletion],
		[NotificationToEmail],
		[NotificationFromEmail],
		[NotificationSubject],
		[TaskCompleteMessage],
		[NotificationSentUTC],
		[CanStop],
		[CanResume],
		[UpdateFrequency],
		[QueuedUTC],
		[StartUTC],
		[CompleteUTC],
		[LastStatusUpdateUTC],
		[CompleteRatio],
		[Status],
		[SerializedTaskObject],
		[SerializedTaskType]
		
FROM
		[dbo].[mp_TaskQueue]

WHERE
		
		StartUTC IS NULL

ORDER BY
		[QueuedUTC]
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_SelectIncompleteBySite]    Script Date: 11/10/2008 11:51:38 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_SelectIncompleteBySite]

/*
Author:   			
Created: 			2007-12-29
Last Modified: 		2008-01-05
*/

@SiteGuid uniqueidentifier

AS


SELECT
		[Guid],
		[SiteGuid],
		[QueuedBy],
		[TaskName],
		[NotifyOnCompletion],
		[NotificationToEmail],
		[NotificationFromEmail],
		[NotificationSubject],
		[TaskCompleteMessage],
		[NotificationSentUTC],
		[CanStop],
		[CanResume],
		[UpdateFrequency],
		[QueuedUTC],
		[StartUTC],
		[CompleteUTC],
		[LastStatusUpdateUTC],
		[CompleteRatio],
		[Status],
		[SerializedTaskObject],
		[SerializedTaskType]
		
FROM
		[dbo].[mp_TaskQueue]

WHERE
		[SiteGuid] = @SiteGuid
		AND CompleteUTC IS NULL

ORDER BY
		[QueuedUTC]
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_GetCountBySite]    Script Date: 11/10/2008 11:51:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_GetCountBySite]

/*
Author:   			
Created: 			2007-12-29
Last Modified: 		2007-12-29
*/

@SiteGuid uniqueidentifier

AS

SELECT COUNT(*) 
FROM [dbo].[mp_TaskQueue]
WHERE	SiteGuid = @SiteGuid
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_SelectOne]    Script Date: 11/10/2008 11:51:38 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_SelectOne]

/*
Author:   			
Created: 			2007-12-29
Last Modified: 		2008-01-05
*/

@Guid uniqueidentifier

AS


SELECT
		[Guid],
		[SiteGuid],
		[QueuedBy],
		[TaskName],
		[NotifyOnCompletion],
		[NotificationToEmail],
		[NotificationFromEmail],
		[NotificationSubject],
		[TaskCompleteMessage],
		[NotificationSentUTC],
		[CanStop],
		[CanResume],
		[UpdateFrequency],
		[QueuedUTC],
		[StartUTC],
		[CompleteUTC],
		[LastStatusUpdateUTC],
		[CompleteRatio],
		[Status],
		[SerializedTaskObject],
		[SerializedTaskType]
		
FROM
		[dbo].[mp_TaskQueue]
		
WHERE
		[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_SelectForNotification]    Script Date: 11/10/2008 11:51:38 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_SelectForNotification]

/*
Author:   			
Created: 			2008-01-05
Last Modified: 		2008-01-05
*/


AS


SELECT
		[Guid],
		[SiteGuid],
		[QueuedBy],
		[TaskName],
		[NotifyOnCompletion],
		[NotificationToEmail],
		[NotificationFromEmail],
		[NotificationSubject],
		[TaskCompleteMessage],
		[NotificationSentUTC],
		[CanStop],
		[CanResume],
		[UpdateFrequency],
		[QueuedUTC],
		[StartUTC],
		[CompleteUTC],
		[LastStatusUpdateUTC],
		[CompleteRatio],
		[Status],
		[SerializedTaskObject],
		[SerializedTaskType]
		
FROM
		[dbo].[mp_TaskQueue]

WHERE
		[NotifyOnCompletion] = 1
		AND [CompleteUTC] IS NOT NULL
		AND [NotificationSentUTC] IS NULL
		

ORDER BY
		[QueuedUTC]
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_DeleteCompletedBySite]    Script Date: 11/10/2008 11:51:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_DeleteCompletedBySite]

/*
Author:   			
Created: 			2008-01-07
Last Modified: 		2008-01-07
*/

@SiteGuid uniqueidentifier

AS

DELETE FROM [dbo].[mp_TaskQueue]
WHERE
	[SiteGuid] = @SiteGuid
	AND [CompleteUTC] IS NOT NULL
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_DeleteCompleted]    Script Date: 11/10/2008 11:51:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_DeleteCompleted]

/*
Author:   			
Created: 			2008-01-07
Last Modified: 		2008-01-07
*/



AS

DELETE FROM [dbo].[mp_TaskQueue]
WHERE
	[CompleteUTC] IS NOT NULL
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_UpdateStart]    Script Date: 11/10/2008 11:51:40 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_UpdateStart]

/*
Author:   			
Created: 			2008-01-02
Last Modified: 		2008-01-02
*/
	
@Guid uniqueidentifier,  
@StartUTC datetime,  
@LastStatusUpdateUTC datetime, 
@CompleteRatio float, 
@Status nvarchar(255)


AS

UPDATE 		[dbo].[mp_TaskQueue] 

SET
			
			[StartUTC] = @StartUTC,
			[LastStatusUpdateUTC] = @LastStatusUpdateUTC,
			[CompleteRatio] = @CompleteRatio,
			[Status] = @Status
			
			
WHERE
			[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_UpdateStatus]    Script Date: 11/10/2008 11:51:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_UpdateStatus]

/*
Author:   			
Created: 			2008-01-02
Last Modified: 		2008-01-02
*/
	
@Guid uniqueidentifier,   
@LastStatusUpdateUTC datetime, 
@CompleteRatio float, 
@Status nvarchar(255)


AS

UPDATE 		[dbo].[mp_TaskQueue] 

SET
			
			
			[LastStatusUpdateUTC] = @LastStatusUpdateUTC,
			[CompleteRatio] = @CompleteRatio,
			[Status] = @Status
			
			
WHERE
			[Guid] = @Guid
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_Insert]    Script Date: 11/10/2008 11:51:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_Insert]

/*
Author:   			
Created: 			2007-12-29
Last Modified: 		2007-12-29
*/

@Guid uniqueidentifier,
@SiteGuid uniqueidentifier,
@QueuedBy uniqueidentifier,
@TaskName nvarchar(255),
@NotifyOnCompletion bit,
@NotificationToEmail nvarchar(255),
@NotificationFromEmail nvarchar(255),
@NotificationSubject nvarchar(255),
@TaskCompleteMessage ntext,
@CanStop bit,
@CanResume bit,
@UpdateFrequency int,
@QueuedUTC datetime,
@CompleteRatio float,
@Status nvarchar(255),
@SerializedTaskObject ntext,
@SerializedTaskType nvarchar(255)

	
AS

INSERT INTO 	[dbo].[mp_TaskQueue] 
(
				[Guid],
				[SiteGuid],
				[QueuedBy],
				[TaskName],
				[NotifyOnCompletion],
				[NotificationToEmail],
				[NotificationFromEmail],
				[NotificationSubject],
				[TaskCompleteMessage],
				[CanStop],
				[CanResume],
				[UpdateFrequency],
				[QueuedUTC],
				[CompleteRatio],
				[Status],
				[SerializedTaskObject],
				[SerializedTaskType]
) 

VALUES 
(
				@Guid,
				@SiteGuid,
				@QueuedBy,
				@TaskName,
				@NotifyOnCompletion,
				@NotificationToEmail,
				@NotificationFromEmail,
				@NotificationSubject,
				@TaskCompleteMessage,
				@CanStop,
				@CanResume,
				@UpdateFrequency,
				@QueuedUTC,
				@CompleteRatio,
				@Status,
				@SerializedTaskObject,
				@SerializedTaskType
				
)
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_SelectIncomplete]    Script Date: 11/10/2008 11:51:38 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_SelectIncomplete]

/*
Author:   			
Created: 			2007-12-29
Last Modified: 		2008-01-05
*/

AS


SELECT
		[Guid],
		[SiteGuid],
		[QueuedBy],
		[TaskName],
		[NotifyOnCompletion],
		[NotificationToEmail],
		[NotificationFromEmail],
		[NotificationSubject],
		[TaskCompleteMessage],
		[NotificationSentUTC],
		[CanStop],
		[CanResume],
		[UpdateFrequency],
		[QueuedUTC],
		[StartUTC],
		[CompleteUTC],
		[LastStatusUpdateUTC],
		[CompleteRatio],
		[Status],
		[SerializedTaskObject],
		[SerializedTaskType]
		
FROM
		[dbo].[mp_TaskQueue]

WHERE
		
		CompleteUTC IS NULL

ORDER BY
		[QueuedUTC]
GO
/****** Object:  StoredProcedure [dbo].[mp_TaskQueue_GetUnfinishedCountBySite]    Script Date: 11/10/2008 11:51:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_TaskQueue_GetUnfinishedCountBySite]

/*
Author:   			
Created: 			2007-12-29
Last Modified: 		2007-12-29
*/

@SiteGuid uniqueidentifier

AS

SELECT COUNT(*) 
FROM [dbo].[mp_TaskQueue]
WHERE	SiteGuid = @SiteGuid
		AND CompleteUTC IS NULL
GO
/****** Object:  StoredProcedure [dbo].[mp_SitePersonalizationAllUsers_SetPageSettings]    Script Date: 11/10/2008 11:51:26 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[mp_SitePersonalizationAllUsers_SetPageSettings] 

@SiteID		int,
@Path             		nvarchar(255),
@PageSettings    	image,
@LastUpdate   		datetime

AS


BEGIN
    
    DECLARE @PathID UNIQUEIDENTIFIER
    SELECT @PathID = NULL
	DECLARE @SiteGuid uniqueidentifier
	SET @SiteGuid = (SELECT TOP 1 SiteGuid FROM mp_Sites WHERE siteID = @SiteID)
    
    

    SELECT @PathID = u.PathID FROM mp_SitePaths u WHERE u.SiteID = @SiteID AND u.LoweredPath = LOWER(@Path)
    IF (@PathID IS NULL)
    BEGIN
        EXEC mp_SitePaths_CreatePath @SiteGuid, @SiteID, @Path, @PathID OUTPUT
    END

    IF (EXISTS(SELECT PathID FROM mp_SitePersonalizationAllUsers WHERE PathID = @PathID))
        	UPDATE mp_SitePersonalizationAllUsers 
	SET PageSettings = @PageSettings, LastUpdate = @LastUpdate 
	WHERE PathID = @PathID
    ELSE
        INSERT INTO mp_SitePersonalizationAllUsers(PathID, PageSettings, LastUpdate) 
	VALUES (@PathID, @PageSettings, @LastUpdate)
    RETURN 0
END
GO
/****** Object:  StoredProcedure [dbo].[mp_SitePersonalizationPerUser_SetPageSettings]    Script Date: 11/10/2008 11:51:27 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_SitePersonalizationPerUser_SetPageSettings]
 (
    @SiteID		int,
    @Path             	NVARCHAR(255),
    @UserID        	UNIQUEIDENTIFIER,
    @PageSettings     	IMAGE,
    @LastUpdate   	DATETIME
)
AS
BEGIN
 
    DECLARE @PathID UNIQUEIDENTIFIER
    SELECT @PathID = NULL
   DECLARE @SiteGuid uniqueidentifier
	SET @SiteGuid = (SELECT TOP 1 SiteGuid FROM mp_Sites WHERE siteID = @SiteID)
    

    SELECT @PathID = u.PathID FROM mp_SitePaths u WHERE u.SiteID = @SiteID AND u.LoweredPath = LOWER(@Path)
    IF (@PathID IS NULL)
     BEGIN
        EXEC mp_SitePaths_CreatePath @SiteGuid, @SiteID, @Path, @PathID OUTPUT
     END

    IF (EXISTS(SELECT PathID FROM mp_SitePersonalizationPerUser WHERE UserID = @UserID AND PathID = @PathID))
        UPDATE mp_SitePersonalizationPerUser 
	SET PageSettings = @PageSettings, LastUpdate = @LastUpdate 
	WHERE UserID = @UserID AND PathID = @PathID
    ELSE
        INSERT INTO mp_SitePersonalizationPerUser
	(
			UserID, 
			PathID, 
			PageSettings, 
			LastUpdate
	)
	 VALUES (
			@UserID, 
			@PathID, 
			@PageSettings, 
			@LastUpdate)
    RETURN 0
END
GO
/****** Object:  StoredProcedure [dbo].[mp_ModuleDefinitions_Insert]    Script Date: 11/10/2008 11:50:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mp_ModuleDefinitions_Insert]

/*
Author:   			
Created: 			2004-12-26
Last Modified: 		2007-08-06

*/

@SiteID int,
@FeatureName nvarchar(255),
@ControlSrc nvarchar(255),
@SortOrder int,
@IsAdmin bit,
@Icon	nvarchar(255),
@DefaultCacheTime int,
@FeatureGuid uniqueidentifier,
@ResourceFile nvarchar(255)
	
AS
DECLARE @ModuleDefID int

INSERT INTO 	[dbo].[mp_ModuleDefinitions] 
(
				[Guid],
				[FeatureName],
				[ControlSrc],
				[SortOrder],
				DefaultCacheTime,
				Icon,
				[IsAdmin],
				[ResourceFile]
) 

VALUES 
(
				@FeatureGuid,
				@FeatureName,
				@ControlSrc,
				@SortOrder,
				@DefaultCacheTime,
				@Icon,
				@IsAdmin,
				@ResourceFile
				
)


SET @ModuleDefID =  @@IDENTITY 

IF @SiteID > -1
BEGIN
DECLARE @SiteGuid uniqueidentifier
SET @SiteGuid = (SELECT TOP 1 SiteGuid FROM mp_Sites WHERE SiteID = @SiteID)
Exec mp_SiteModuleDefinitions_Insert @SiteGuid, @FeatureGuid

END

SELECT @ModuleDefID
GO

SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[mp_HtmlContent_DeleteBySite]

/*
Author:   			
Created: 			2008-11-12
Last Modified: 		2008-11-12

*/

@SiteID int

AS

DELETE FROM mp_HtmlContent
WHERE ModuleID IN (SELECT ModuleID FROM mp_Modules WHERE SiteID = @SiteID)


GO



INSERT INTO [mp_SiteSettingsExDef]([KeyName],[DefaultValue],[GroupName],[SortOrder]) 
VALUES('SMTPUser','','SMTP', 100)

INSERT INTO [mp_SiteSettingsExDef]([KeyName],[DefaultValue],[GroupName],[SortOrder]) 
VALUES('SMTPPassword','','SMTP', 200)

INSERT INTO [mp_SiteSettingsExDef]([KeyName],[DefaultValue],[GroupName],[SortOrder]) 
VALUES('SMTPServer','localhost','SMTP', 300)

INSERT INTO [mp_SiteSettingsExDef]([KeyName],[DefaultValue],[GroupName],[SortOrder]) 
VALUES('SMTPPort','25','SMTP', 400)

INSERT INTO [mp_SiteSettingsExDef]([KeyName],[DefaultValue],[GroupName],[SortOrder]) 
VALUES('SMTPRequiresAuthentication','false','SMTP', 500)

INSERT INTO [mp_SiteSettingsExDef]([KeyName],[DefaultValue],[GroupName],[SortOrder]) 
VALUES('SMTPUseSsl','false','SMTP', 600)

INSERT INTO [mp_SiteSettingsExDef]([KeyName],[DefaultValue],[GroupName],[SortOrder]) 
VALUES('SMTPPreferredEncoding','','SMTP', 700)

GO




SET NUMERIC_ROUNDABORT OFF
GO
SET XACT_ABORT, ANSI_PADDING, ANSI_WARNINGS, CONCAT_NULL_YIELDS_NULL, ARITHABORT, QUOTED_IDENTIFIER, ANSI_NULLS, NOCOUNT ON
GO

BEGIN TRANSACTION


ALTER TABLE [dbo].[mp_GeoZone] DROP CONSTRAINT [FK_mp_GeoZone_mp_GeoCountry]




INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('000DA5AD-296A-4698-A21B-7D9C23FEEA14','Indonesia','ID','IDN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('0055471A-7993-42A1-897C-E5DAF92E7C0E','Maldives','MV','MDV')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('01261D1A-74D6-4E02-86C5-BED1A192F67D','Zimbabwe','ZW','ZWE')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('01CA292D-86CA-4FA5-9205-2B0A37E7353B','Iceland','IS','ISL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('0416E2FC-C902-4452-8DE9-29A2B453E685','Kyrgyzstan','KG','KGZ')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('045A6098-A4A5-457A-AEF0-6CC57CC4A813','Malawi','MW','MWI')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('04724868-0448-48EF-840B-7D5DA12495EC','Malaysia','MY','MYS')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('056F6ED6-8F6D-4366-A755-2D6B8FB2B7AD','Marshall Islands','MH','MHL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('0589489D-A413-47C6-A90A-600520A8C52D','St. Helena','SH','SHN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('05B98DDC-F36B-4DAF-9459-0717FDE9B38E','Equatorial Guinea','GQ','GNQ')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('061E11A1-33A2-42F0-8F8D-27E65FC47076','Sudan','SD','SDN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('06BB7816-9AD4-47DC-B1CD-6E206AFDFCCA','Austria','AT','AUT')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('0758CF79-94EB-4FA3-BD2C-8213034FB66C','Virgin Islands (U.S.)','VI','VIR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('0789D8A8-59D0-4D2F-8E26-5D917E55550C','To','TG','T')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('07E1DE2F-B11E-4F3B-A342-964F72D24371','Netherlands','NL','NLD')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('085D9357-416B-48D6-8C9E-EC3E9E2582D0','Peru','PE','PER')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('0B182EE0-0CC0-4844-9CF0-BA15F47682E8','Con','CG','COG')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('0BD0E1A0-EA93-4883-B0A0-9F3C8668C68C','Singapore','SG','SGP')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('0C356C5A-CA44-4301-8212-1826CCDADC42','Canada','CA','CAN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('0D074A4F-DF7F-49F3-8375-D35BDC934AE0','Zaire','ZR','ZAR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('10D4D58E-D0C2-4A4E-8FDD-B99D68C0BD22','Eritrea','ER','ERI')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('10FDC2BB-F3A6-4A9D-A6E9-F4C781E8DBFF','Mexico','MX','MEX')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('13FAA99E-18F2-4E6F-B275-1E785B3383F3','Brazil','BR','BRA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('14962ADD-4536-4854-BEA3-A5A904932E1C','Moldova, Republic of','MD','MDA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('1583045C-5A80-4850-AC32-F177956FBD6A','Myanmar','MM','MMR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('167838F1-3FDD-4FB6-9268-4BEAFEECEA4B','Estonia','EE','EST')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('171A3E3E-CC78-4D4A-93EE-ACE870DCB4C4','Swaziland','SZ','SWZ')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('18160966-4EEB-4C6B-A526-5022042FE1E4','Montserrat','MS','MSR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('19F2DA98-FEFD-4B45-A260-8D9392C35A24','Czech Republic','CZ','CZE')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('1A07C0B8-EB6D-4153-8CB1-BE6E31FEB566','Bosnia and Herzewina','BA','BIH')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('1A6A2DB1-D162-4FEA-B660-B88FC25F558E','Grenada','GD','GRD')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('1B8FBDE0-E709-4F7B-838D-B09DEF73DE8F','Botswana','BW','BWA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('1C7FF578-F079-4B5B-9993-2E0253B8CC14','Morocco','MA','MAR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('1D0DAE21-CD07-4022-B86A-7780C5EA0264','Cayman Islands','KY','CYM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('1D925A47-3902-462A-BA2E-C58E5CB24F2F','American Samoa','AS','ASM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('1E64910A-BCE3-402C-9035-9CB1F820B195','Bolivia','BO','BOL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('1FCC4A89-0E8F-4FA2-B8D0-4FF5EC2277DF','United Kingdom','GB','GBR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('20A15881-215B-4C4C-9512-80E55ABBB5BA','Saint Vincent and the Grenadines','VC','VCT')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('216D38D9-5EEB-42B7-8D2D-0757409DC5FB','Pitcairn','PN','PCN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('2391213F-FCBF-479A-9AB9-AF1D6DEB9E11','Benin','BJ','BEN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('23BA8DCE-C784-4712-A6A0-0271F175D4E5','Central African Republic','CF','CAF')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('24045513-0CD8-4FB9-9CF6-78BF717F6A7E','Samoa','WS','WSM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('25ED463D-21F5-412C-9BDB-6D76073EA790','Jordan','JO','JOR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('267865B1-E8DA-432D-BE45-63933F18A40F','Korea, Republic of','KR','KOR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('278AB63A-9C7E-4CAD-9C99-984F8810D151','Sri Lanka','LK','LKA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('27A6A985-3A89-4309-AC40-D1F0A94646CE','Sierra Leone','SL','SLE')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('28218639-6094-4AA2-AE88-9206630BB930','Libyan Arab Jamahiriya','LY','LBY')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('2AFE5A06-2692-4B96-A385-F299E469D196','Panama','PA','PAN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('2BAD76B2-20F3-4568-96BB-D60C39CFEC37','Sweden','SE','SWE')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('2D5B53A8-8341-4DA4-A296-E516FE5BB953','Germany','DE','DEU')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('2DD32741-D7E9-49C9-B3D3-B58C4A913E60','Chad','TD','TCD')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('2EBCE3A9-660A-4C1D-AC8F-0E899B34A987','Australia','AU','AUS')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('31F9B05E-E21D-41D5-8753-7CDD3BFA917B','Yuslavia','YU','YUG')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('3220B426-8251-4F95-85C8-3F7821ECC932','Burkina Faso','BF','BFA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('32EB5D85-1283-4586-BB16-B2B978B6537F','Cameroon','CM','CMR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('333ED823-0E19-4BCC-A74E-C6C66FE76834','Cote D Ivoire','CI','CIV')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('356D4B6E-9CCB-4DC6-9C82-837433178275','Palau','PW','PLW')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('3664546F-14F2-4561-9B77-67E8BE6A9B1F','Barbados','BB','BRB')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('36F89C06-1509-42D2-AEA6-7B4CE3BBC4F5','Seychelles','SC','SYC')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('386812D8-E983-4D3A-B7F0-1FA0BBE5919F','Comoros','KM','COM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Spain','ES','ESP')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('391EBAFD-7689-41E5-A785-DF6A3280528D','Tokelau','TK','TKL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('392616F8-1B24-489F-8600-BAE22EF478CC','Armenia','AM','ARM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('3A733002-9223-4BD7-B2A9-62FA359C4CBD','Gabon','GA','GAB')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('3C864692-824C-4593-A739-D1309D4CD75E','Macedonia, The Former Yuslav Republic of','MK','MKD')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('3D3A06A0-0853-4D01-B273-AF7B7CD7002C','Saint Lucia','LC','LCA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('3E57398A-0006-4E48-8CB4-F9F143DFCF22','British Indian Ocean Territory','IO','IOT')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('3E747B23-543F-4AD0-80A9-5E421651F3B4','Western Sahara','EH','ESH')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('3F677556-1C9C-4315-9CFC-210A54F1F41D','Cook Islands','CK','COK')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('3FBD7371-510A-45B4-813A-88373D19A5A4','Slovenia','SI','SVN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('4448E7B7-4E4D-4F19-B64D-E649D0F76CC1','Guinea','GN','GIN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('44577B6A-6918-4508-ADE4-B6C2ADB25000','Guatemala','GT','GTM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('468DCA85-484A-4529-8753-B26DBC316A71','East Timor','TP','TMP')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('48CD745A-4C47-4282-B60A-CB4B4639C6EE','Guam','GU','GUM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('48E5E925-6D98-4039-AF6E-36D676059B85','Korea, Democratic Peoples Republic of','KP','PRK')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('4CC52CE2-0A6C-4564-8FE6-2EEB347A9429','Ethiopia','ET','ETH')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('4CE3DF16-4D00-4F4D-A5D6-675020FA117D','Cocos (Keeling) Islands','CC','CCK')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('4DBE5363-AAD6-4019-B445-472D6E1E49BD','Somalia','SO','SOM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('4DCD6ECF-AF6C-4C76-95DB-A0EFAC63F3DE','Greenland','GL','GRL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('4E6D9507-9FB0-4290-80AF-E98AABACCEDB','Lao Peoples Democratic Republic','LA','LAO')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('4EB5BCBE-13AA-45F0-AFDF-77B379347509','Norfolk Island','NF','NFK')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('4F660961-0AFF-4539-9C0B-3BB2662B7A99','France','FR','FRA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('52316192-6328-4E45-A39C-37FC96CAD138','Nigeria','NG','NGA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('54D227B4-1F3E-4F20-B16C-6428B77F5252','Poland','PL','POL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('574E1B06-4332-4A1C-9B30-5DAF2CCE6B10','Andorra','AD','AND')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('579FBEE3-0BE0-4884-B7C5-658C23C4E7D3','Antarctica','AQ','ATA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('58C5C312-85D2-47A3-87A7-1549EC0CCD44','Liberia','LR','LBR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('5AAC5AA6-8BC0-4BE5-A4DE-76A5917DD2B2','Bangladesh','BD','BGD')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('5C3D7F0E-1900-4D73-ACF6-69459D70D616','Nicaragua','NI','NIC')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('5DC77E2B-DF39-475B-99DA-C9756CABB5B6','Anla','AO','A')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('5EDC9DDF-242C-4533-9C38-CBF41709EF60','El Salvador','SV','SLV')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('5F6DF4FF-EF4B-43D9-98F5-D66EF9D27C67','Macau','MO','MAC')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Switzerland','CH','CHE')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('612C5585-4E93-4F4F-9735-EC9AB7F2AAB9','Thailand','TH','THA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('61EF876B-9508-48E9-AFBF-2D4386C38127','Hungary','HU','HUN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('63404C30-266D-47B6-BEDA-FD252283E4E5','Nepal','NP','NPL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('63AECD7A-9B3F-4732-BF8C-1702AD3A49DC','Falkland Islands (Malvinas)','FK','FLK')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('65223343-756C-4083-A20F-CF3CF98EFBDC','Mayotte','YT','MYT')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('6599493D-EAD6-41CE-AE9C-2A47EA74C1A8','Honduras','HN','HND')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('666699CD-7460-44B1-AFA9-ADC363778FF4','Romania','RO','ROM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('66C2BFB0-11C9-4191-8E91-1A0314726CC6','Dominican Republic','DO','DOM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('66D1D01B-A1A5-4634-9C15-4CD382A44147','Egypt','EG','EGY')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('66D7E3D5-F89C-42C5-82D5-9E6869AB9775','Mauritius','MU','MUS')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('66F06C44-26FF-4015-B0CE-D241A39DEF8B','Papua New Guinea','PG','PNG')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('6717BE36-81C1-4DF3-A6F8-0F5EEF45CEC9','Puerto Rico','PR','PRI')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('67497E93-C793-4134-915E-E04F5ADAE5D0','Antigua and Barbuda','AG','ATG')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('68ABEFDB-27F4-4CB8-840C-AFEE8510C249','Tunisia','TN','TUN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('6F101294-0433-492B-99F7-D59105A9970B','Senegal','SN','SEN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('70A106CA-3A82-4E37-AEA3-4A0BF8D50AFA','Namibia','NA','NAM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('70E9EF51-B838-461B-A1D8-2B32EE49855B','Chile','CL','CHL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('72BBBB80-EA6C-43C9-8CCD-99D26290F560','Belgium','BE','BEL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('73355D89-317A-43A5-8EBB-FA60DD738C5B','South Africa','ZA','ZAF')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('7376C282-B5A3-4898-A342-C45F1C18B609','New Zealand','NZ','NZL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('73FBC893-331D-4E67-9753-AB988AC005C7','Svalbard and Jan Mayen Islands','SJ','SJM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('74DFB95B-515D-4561-938D-169AC3782280','New Caledonia','NC','NCL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('75F88974-01AC-47D7-BCEE-6CE1F0C0D0FC','Trinidad and Toba','TT','TTO')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('7756AA70-F22A-4F42-B8F4-E56CA9746064','Qatar','QA','QAT')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('776102B6-3D75-4570-8215-484367EA2A80','Lesotho','LS','LSO')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('77BBFB67-9D1D-41F9-8626-B327AA90A584','French Polynesia','PF','PYF')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('77DCE560-3D53-4483-963E-37D5F72E219E','Tajikistan','TJ','TJK')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('78A78ABB-31D9-4E2A-AEA5-6744F27A6519','Azerbaijan','AZ','AZE')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('7B3B0B11-B3CF-4E69-B4C2-C414BB7BD78D','Ecuador','EC','ECU')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('7B534A1E-E06D-4A2C-8EA6-85C128201834','Latvia','LV','LVA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('7C0BA316-C6D9-48DC-919E-76E0EE0CF0FB','Rwanda','RW','RWA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('7C2C1E29-9E58-45EB-B512-5894496CD4DD','Paraguay','PY','PRY')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('7E11E0DC-0A4E-4DB9-9673-84600C8035C4','Ireland','IE','IRL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('7E83BA7D-1C8F-465C-87D3-9BD86256031A','Cape Verde','CV','CPV')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('7F2E9D46-F5DB-48BF-8E07-D6D12E77D857','Reunion','RE','REU')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('7FE147D0-FD91-4119-83AD-4E7EBCCDFD89','United Arab Emirates','AE','ARE')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('83C5561E-E4BE-40B0-AE56-28A371680AF8','Denmark','DK','DNK')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('844686BA-57C3-4C91-8B33-C1E1889A44C0','Albania','AL','ALB')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('880F29A2-E51C-4016-AB18-CA09275673C3','Guinea-bissau','GW','GNB')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('88592F8B-1D15-4AA0-9115-4A28B67E1753','Lebanon','LB','LBN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('8AF11A89-1487-4B21-AABF-6AF57EAD8474','Solomon Islands','SB','SLB')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('8C982139-3609-48D3-B145-B5CEB484C414','United States Minor Outlying Islands','UM','UMI')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('8C9D27F2-FE77-4653-9696-B046D6536BFA','Netherlands Antilles','AN','ANT')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('8F5124FA-CB2A-4CC9-87BB-BC155DC9791A','Gambia','GM','GMB')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('8FE152E5-B58C-4D3C-B143-358D5C54BA06','Ukraine','UA','UKR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('90255D75-AF44-4B5D-BCFD-77CD27DCE782','Madagascar','MG','MDG')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('90684E6E-2B34-4F18-BBD1-F610F76179B7','Malta','MT','MLT')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('9151AAF1-A75B-4A2C-BF2B-C823E2586DB2','Fiji','FJ','FJI')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('92A52065-32B0-42C6-A0AA-E8B8A341F79C','Guyana','GY','GUY')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('931EE133-2B60-4B82-8889-7C9855CA030A','Kazakhstan','KZ','KAZ')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('96DBB697-3D7E-49BF-AC9B-0EA5CC014A6F','Niue','NU','NIU')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('972B8208-C88D-47BB-9E79-1574FAB34DFB','San Marino','SM','SMR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('99C347F1-1427-4D41-BC12-945D38F92A94','Lithuania','LT','LTU')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('99F791E7-7343-42E8-8C19-3C41068B5F8D','Viet Nam','VN','VNM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('9AB1EE28-B81F-4B89-AE6B-3C6E5322E269','Jamaica','JM','JAM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('9B5A87F8-F024-4B76-B230-95913E474B57','Yemen','YE','YEM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('9C035E40-A5DC-406B-A83A-559F940EB355','Cyprus','CY','CYP')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('9CA410F0-EB75-4105-90A1-09FC8D2873B8','France, Metropolitan','FX','FXX')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('9D2C4779-1608-4D2A-B157-F5C4BB334EED','French Guiana','GF','GUF')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('9DCF0A16-DB7F-4B63-BAD7-30F80BCD9901','Philippines','PH','PHL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('9F9AC0E3-F689-4E98-B1BB-0F5F01F20FAD','Russian Federation','RU','RUS')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('A141AB0D-7E2C-48B1-9963-BA8685BCDFE3','Slovakia (Slovak Republic)','SK','SVK')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('A4F1D01A-EBFC-4BD3-9521-BE6D73F79FAC','Luxembourg','LU','LUX')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('A566AC8D-4A81-4A11-9CFB-979517440CE2','Iran (Islamic Republic of)','IR','IRN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('A642097B-CC0A-430D-9425-9F8385FC6AA4','Italy','IT','ITA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('A71D6727-61E7-4282-9FCB-526D1E7BC24F','United States','US','USA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('AA393972-1604-47D2-A533-81B41199CCF0','Djibouti','DJ','DJI')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('AAE223C8-6330-4641-B12B-F231866DE4C6','Anguilla','AI','AIA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('AE094B3E-A8B8-4E29-9853-3BD464EFD247','Monaco','MC','MCO')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('AEA2F438-77BC-43F5-84FC-C781141A1D47','Sao Tome and Principe','ST','STP')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('AEBD8175-FFFE-4EE2-B208-C0BBBD049664','Uruguay','UY','URY')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('B0FC7899-9C6F-4B80-838F-692A7A0AA83B','Oman','OM','OMN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('B10C1EFC-5341-4EC4-BE12-A70DBB1C41CC','Liechtenstein','LI','LIE')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('B14E1447-0BCA-4DD5-87E1-60C0B5D2988B','Saudi Arabia','SA','SAU')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('B225D445-6884-4232-97E4-B33499982104','Northern Mariana Islands','MP','MNP')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('B32A6FE3-F534-4C42-BD2D-8E2307476BA2','Mozambique','MZ','MOZ')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('B3732BD9-C3D6-4861-8DBE-EB2884557F34','Vanuatu','VU','VUT')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('B47E2EEC-62A0-440C-9F20-AF9C5C75D57B','Greece','GR','GRC')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('B4A3405B-1293-4E98-9B11-777F666B25D4','Bahamas','BS','BHS')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('B50F640F-0AE9-4D63-ACB2-2ABD94B6271B','Gibraltar','GI','GIB')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('B5133B5B-1687-447A-B88A-EF21F7599EDA','Argentina','AR','ARG')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('B5946EA8-B8A8-45B9-827D-86FA13E034CD','Hong Kong','HK','HKG')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('B5EE8DA7-5CC3-44F3-BD63-094CB93B4674','Uzbekistan','UZ','UZB')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('B85AA3D6-D923-438C-AAD7-2063F6BFBD3C','Nauru','NR','NRU')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('BAF7D87C-F09B-42CC-BECD-49C2B3426226','Tanzania, United Republic of','TZ','TZA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('BB176526-F5C6-4871-9E75-CFEEF799AD48','Tuvalu','TV','TUV')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('BBAAA327-F8CC-43AE-8B0E-FC054EEDA968','Tonga','TO','TON')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('BD2C67C0-26A4-46D5-B58A-F26DCFA8F34B','Taiwan','TW','TWN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('BDB52E20-8F5C-4A6C-A8D5-2B4DC060CC13','Heard and Mc Donald Islands','HM','HMD')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('BEC3AF5B-D2D4-4DFB-ACA5-CF87059469D4','Algerian','DZ','DZA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('BF3B8CD7-679E-4546-81FC-85652653FE8F','Saint Kitts and Nevis','KN','KNA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('C03527D6-1936-4FDB-AB72-93AE7CB571ED','Kuwait','KW','KWT')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('C046CA0B-6DD9-459C-BF76-BD024363AAAC','Pakistan','PK','PAK')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('C10D2E3A-AF21-4BAD-9B18-FBF3FB659EAE','Bahrain','BH','BHR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('C1EC594F-4B56-436D-AA28-CE3004DE2803','Bhutan','BT','BTN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('C1F503A3-C6B4-4EEE-9FEA-1F656F3B0825','Kiribati','KI','KIR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('C23969D4-E195-4E53-BF7E-D3D041184325','China','CN','CHN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('C43B2A01-933B-4021-896F-FCD27F3820DA','India','IN','IND')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('C47BF5EA-DFE4-4C9F-8BBC-067BD15FA6D2','Kenya','KE','KEN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('C63D51D8-B319-4A48-A6F1-81671B28EF07','Bouvet Island','BV','BVT')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('C7C9F73A-F4BE-4C59-9278-524D6069D9DC','Colombia','CO','COL')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('C87D4CAE-84EE-4336-BC57-69C4EA33A6BC','Syrian Arab Republic','SY','SYR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('CD85035D-3901-4D07-A254-90750CD57C90','Georgia','GE','GEO')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('CDA35E7B-29B0-4D34-B925-BF753D16AF7E','South Georgia and the South Sandwich Islands','GS','SGS')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('CE737F29-05A4-4A9A-B5DC-F1876F409334','Haiti','HT','HTI')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('D42BD5B7-9F7E-4CB2-A295-E37471CDB1C2','Virgin Islands (British)','VG','VGB')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('D61F7A82-85C5-45E1-A23C-60EDAE497459','Belarus','BY','BLR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('D7A96DD1-66F4-49B4-9085-53A12FACAC98','Burundi','BI','BDI')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('D9510667-AE8B-4066-811C-08C6834EFADF','Uganda','UG','UGA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('DA19B4E1-DFEA-43C9-AD8B-19E7036F0DA4','Turks and Caicos Islands','TC','TCA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('DA8E07C2-7B3D-46AF-BCC5-FEF0A68B11D1','Turkey','TR','TUR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('DAC6366F-295F-4DDC-B08C-5A521C70774D','Martinique','MQ','MTQ')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('DD3D7458-318B-4C6B-891C-766A6D7AC265','Dominica','DM','DMA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('E0274040-EF54-4B6E-B572-AF65A948D8C4','Wallis and Futuna Islands','WF','WLF')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('E04ED9C1-FACE-4EE6-BADE-7E522C0D210E','Brunei Darussalam','BN','BRN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('E1AA65E1-D524-48BA-91EF-39570B9984D7','Aruba','AW','ABW')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('E399424A-A86A-4C61-B92B-450106831B4C','French Southern Territories','TF','ATF')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('E55C6A3A-A5E9-4575-B24F-6DA0FD4115CD','Norway','NO','NOR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('E6471BF0-4692-4B7A-B104-94B12B30A284','Turkmenistan','TM','TKM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('E691AC69-A14D-4CCA-86ED-82978614283E','Costa Rica','CR','CRI')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('E82E9DC1-7D00-47C0-9476-10EAF259967D','Bermuda','BM','BMU')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('E8F03EAA-DDD2-4FF2-8B66-DA69FF074CCD','Mauritania','MR','MRT')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('EADABF25-0FA0-4E8E-AA1E-26D02EB70653','Faroe Islands','FO','FRO')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('EAFEB25D-265A-4899-BE24-BB0F4BF64480','Cambodia','KH','KHM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('EB692475-F7AF-402F-BB0D-CD420F670B88','Niger','NE','NER')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('EC0D252B-7BA6-4AC4-AD41-6158A10E9CCF','Finland','FI','FIN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('EC4D278F-0D96-478F-B023-0FDC7520C56C','Iraq','IQ','IRQ')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('F015E45E-D93A-4D3A-A010-648CA65B47BE','Venezuela','VE','VEN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('F2F258D7-B650-45F9-A0E1-58687C08F4E4','Suriname','SR','SUR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('F321B513-8164-4882-BAE0-F3657A1A98FB','Micronesia, Federated States of','FM','FSM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('F3418C04-E3A8-4826-A41F-DCDBB5E4613E','Monlia','MN','MNG')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('F3B7F86F-3165-4430-B263-87E1222B5BB1','Croatia','HR','HRV')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('F5548AC2-958F-4B3D-8669-38B58735C517','Belize','BZ','BLZ')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('F63CE832-2C8D-4C43-A4D8-134FC4311098','Guadeloupe','GP','GLP')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('F6E6E602-468A-4DD7-ACE4-3DA5FEFC165A','St. Pierre and Miquelon','PM','SPM')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('F74A81FA-3D6A-415C-88FD-5458ED8C45C2','Japan','JP','JPN')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('F909C4C1-5FA9-4188-B848-ECD37E3DBF64','Cuba','CU','CUB')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('F95A5BB1-59A5-4125-B803-A278B13B3D3B','Zambia','ZM','ZMB')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('F9C72583-E1F8-4F13-BFB5-DDF68BCD656A','Christmas Island','CX','CXR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('FA26AE74-5404-4AAF-BD54-9B78266CCF03','Portugal','PT','PRT')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('FBEA6604-4E57-46B6-A3F2-E5DE8514C7B0','Vatican City State (Holy See)','VA','VAT')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('FBFF9784-D58C-4C86-A7F2-2F8CE68D10E7','Mali','ML','MLI')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('FD70FE71-1429-4C6E-B399-90318ED9DDCB','Bulgaria','BG','BGR')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('FDC8539A-82A7-4D29-BD5C-67FB9769A5AC','Ghana','GH','GHA')
INSERT INTO [mp_GeoCountry] ([Guid],[Name],[ISOCode2],[ISOCode3])VALUES('FE0E585E-FC54-4FA2-80C0-6FBFE5397E8C','Israel','IL','ISR')


INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('02BE94A5-3C10-4F83-858B-812796E714AE','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Minnesota','MN')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('02C10C0F-3F09-4D0A-A6EF-AD40AE0A007B','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Sachsen-Anhalt','SAC')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('053FAB61-2EFF-446B-A29B-E9BE91E195C9','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Jura','JU')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('05974280-A62D-4FC3-BE15-F16AB9E0F2D1','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Sachsen','SAS')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('070DD166-BDC9-4732-8DA0-48BD318D3D9E','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Avila','Avila')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('076814FC-7422-40D5-80E0-B6978589CCDC','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Schaffhausen','SH')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('07C1030F-FA7E-4B1C-BA21-C6ACD092B676','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Rheinland-Pfalz','RHE')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('0B6E3041-4368-4476-A697-A8BAFC77A9E0','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Virginia','VA')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('0DB04A9E-352B-46D6-88BC-B5416B31756D','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Las Palmas','Las Palmas')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('0DF27C73-A612-491F-8B74-C4E384317FB8','0C356C5A-CA44-4301-8212-1826CCDADC42','Manitoba','MB')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('0F115386-3220-49F1-B0F2-EAF6C78A2EDD','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Albacete','Albacete')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('1026B90D-61BE-4434-AB6D-EBFD92082DFE','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Iowa','IA')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('152F8DC5-5CAA-44B7-89A8-6469042DC865','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Puerto Rico','PR')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('155DDC67-1E74-4791-995D-2EDDB0658293','06BB7816-9AD4-47DC-B1CD-6E206AFDFCCA','Burgenland','BL')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('15B3D139-D927-43EB-8705-84DF9122999F','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Barcelona','Barcelona')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('15C350C0-058C-474D-A7C2-E3BD359B7895','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Rhode Island','RI')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('19B7CD11-15B7-48C0-918D-73FE64EAAE26','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Roraima','RR')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('1AA7127A-8C53-4840-A2DA-120F8C6607BD','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Ohio','OH')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('1BA313DE-0690-42DB-97BB-ECBA89AEC4C7','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Lleida','Lleida')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('1C5D3479-59FC-4C77-8D4E-CFC5C33422E7','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Vizcaya','Vizcaya')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('1D049867-DC28-4AE1-B8A6-D44AECB4AA0B','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Rio Grande Do Sul','RS')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('1D996BA4-1906-44C3-9C51-399FD382D278','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Tocantins','TO')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('1DA58A0A-D0F7-48B1-9D48-102F65819773','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Granada','Granada')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('1E1BA070-F44B-4DFB-8FC2-55C541F4943F','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Amapa','AP')

INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('20A995B4-82EE-4AE7-84CF-E03C2FF8858A','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Northern Mariana Islands','MP')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('21287450-809E-4662-9742-9380159D3C90','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Guipuzcoa','Guipuzcoa')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('2282DF69-BCF5-49FE-A6EB-C8C9DEC87A52','A71D6727-61E7-4282-9FCB-526D1E7BC24F','West Virginia','WV')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('25459871-1694-4D08-9E7C-6D06F2EDC7AE','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Basel-Landschaft','BL')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('2546D1AB-D4F5-4087-9B78-EA3BADFAFA12','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Sevilla','Sevilla')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('294F2E9C-49D1-4094-B558-DD2D4219B0E9','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Espirito Santo','ES')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('29F5CE90-8999-4A8E-91A5-FCF67B4FD8AB','0C356C5A-CA44-4301-8212-1826CCDADC42','Nova Scotia','NS')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('2A20CF43-8D55-4732-B810-641886F2AED4','0C356C5A-CA44-4301-8212-1826CCDADC42','British Columbia','BC')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('2A9B8FFE-91F5-4944-983D-37F52491DDE6','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Berlin','BER')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('2DF783C9-E527-4105-819E-181AF57E7CEC','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Mato Grosso Do Sul','MS')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('2F20005E-7EFC-4186-9144-6996B68EE6E3','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Tarragona','Tarragona')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('3008A1B3-1188-4F4D-A2EF-B71B4F54233E','06BB7816-9AD4-47DC-B1CD-6E206AFDFCCA','Tirol','TI')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('30FA3416-9FB1-43C1-999D-23A115218324','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Aargau','AG')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('31265516-54AF-4551-AF1B-A0900FAA3028','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Nevada','NV')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('3249C886-3B1E-426A-8CD7-EFC3922A964A','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Salamanca','Salamanca')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('335C6BA3-37E5-4CCA-B466-6927658EE92E','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Maine','ME')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('33CD3650-D80E-4157-B145-5D8D404628E4','0C356C5A-CA44-4301-8212-1826CCDADC42','Ontario','ON')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('347629B4-0C74-4E80-84C9-785FB45FB8D7','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Almeria','Almeria')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('36F88C25-7A6A-41D4-ABAC-CE05CD5ECFA1','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Hamburg','HAM')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('388A4219-A89A-4BF0-960F-F58936288A0A','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Luzern','LU')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('3C173B83-5149-4FEC-B000-64A65832C455','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Armed Forces Middle East','AM')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('3DAB4424-EFA5-409A-B96C-40DAF5EE4B6C','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','La Rioja','La Rioja')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('3DEDA5E5-10BB-41CD-87FF-F91688B5B7ED','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Thurgau','TG')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('3EBF7CEB-8E24-40AF-801C-FECCD6D780EE','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Castellon','Castellon')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('3FF66466-E523-492E-80C1-BE19AF171364','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Colorado','CO')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('41898A0B-A26C-44CE-9568-CFB75F1A2856','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Tennessee','TN')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('4308F7F6-1F1D-4248-8995-3AF588C55976','0C356C5A-CA44-4301-8212-1826CCDADC42','Newfoundland','NF')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('4344C1DD-E866-4683-9C90-22C9DB369EAE','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Segovia','Segovia')

INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('2022F303-2481-4B44-BA3D-D261B002C9C1','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Baden-Wrttemberg','BAW')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('440E892D-693C-493B-BA14-81919C3FB091','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Wallis','VS')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('48184D25-0757-405D-934D-74D96F9745DF','A71D6727-61E7-4282-9FCB-526D1E7BC24F','New Mexico','NM')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('48D12A99-BF3C-4FC7-86C5-C266424973EB','A71D6727-61E7-4282-9FCB-526D1E7BC24F','California','CA')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('4AB74396-FB33-4276-A518-AD05F28375D0','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Baleares','Baleares')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('4BC9F931-F1ED-489F-99BC-59F42BD77EEC','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Nordrhein-Westfalen','NRW')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('4BD4724C-2E5E-4DF4-8B1C-3A679C30398F','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Zug','ZG')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('4D238397-AF29-4DBC-A349-7F650A5D8D67','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Oklahoma','OK')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('4E0BC53A-62FE-4DFC-9D1D-8B928E40B22E','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Maranhao','MA')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('5006FF54-AA63-4E57-8414-30D51598BE60','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Bahia','BA')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('507E831C-8D74-44BF-A251-496B945FAED9','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Virgin Islands','VI')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('517F1242-FE90-4322-969E-353C5DBFD061','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Alicante','Alicante')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('5399DF4C-92D4-4C59-9BFB-7DC2A575A3D3','A71D6727-61E7-4282-9FCB-526D1E7BC24F','North Dakota','ND')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('56259F37-AF84-4215-AC73-259FA74C7C8D','0C356C5A-CA44-4301-8212-1826CCDADC42','Yukon Territory','YT')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('570FE94C-F226-4701-8C10-13DAB9E59625','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Texas','TX')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('58C1E282-CFFA-4B49-B268-5356BA47AA19','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Basel-Stadt','BS')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('5BBD88D1-5023-43DF-91F0-0FDD4F3878EB','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Cadiz','Cadiz')

INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('5BD4A551-46BA-465A-B3F9-E15ED70A083F','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Arizona','AZ')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('60D9D569-7D0D-448F-B567-B4BB6C518140','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Zamora','Zamora')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('611023EB-D4F2-4831-812E-C3984A125310','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Alaska','AK')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('61952DAD-6B28-4BA8-8580-5012A48ACCDC','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Marshall Islands','MH')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('61D891A3-E620-46D8-AADA-6C9C1944340C','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Glarus','GL')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('62202FA8-DB98-40F9-9A26-446AEE191CDD','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Acre','AC')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('6243F71B-D89B-4FDC-BC01-FCF46AEB1F29','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Illinois','IL')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('6352D079-20EA-42DA-9377-7A09E6B764AE','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Federated States Of Micronesia','FM')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('640CEF26-1B10-4EAC-A4AE-2F3491C38376','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Ciudad Real','Ciudad Real')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('66CC8A10-4DFB-4E8A-B5F0-B935D22A18F9','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Ceara','CE')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('6743C28C-580D-4705-9B01-AA4380D65CE9','A71D6727-61E7-4282-9FCB-526D1E7BC24F','New Jersey','NJ')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('67E1633F-7405-451D-A772-EB4119C13B2C','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Uri','UR')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('69A0494D-F8C3-434B-B8D4-C18CA5AF5A4E','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Saarland','SAR')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('6C342C68-690A-4967-97C6-E6408CA1EA59','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Genf','GE')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('6CC5CF7E-DF8F-4C30-8B75-3C7D7750A4C0','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Sergipe','SE')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('6E0EB9AC-76A2-434D-AE13-18DBE56212BF','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Ceuta','Ceuta')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('6E9D7937-3614-465E-8534-AA9A52F2C69B','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Nebraska','NE')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('71682C43-E9C4-4D96-89E7-B06D47CAA053','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Montana','MT')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('74062D11-8784-40BC-A95D-43B785EF8196','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Maryland','MD')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('74532861-C62D-49D2-A8ED-E99F401EA768','0C356C5A-CA44-4301-8212-1826CCDADC42','Northwest Territories','NT')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('7566D0A5-7394-4947-B4D7-A76A94746A23','A71D6727-61E7-4282-9FCB-526D1E7BC24F','American Samoa','AS')

INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('7783E2F6-DED1-4703-AA2B-9FC844F28018','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Caceres','Caceres')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('780D9DDB-38A2-47C8-A162-1231BEA2E54D','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Bern','BE')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('79B41943-7A78-4CEC-857D-1FB89D34D301','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Santa Catarina','SC')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('7ACE8E48-A0C5-48EE-B992-AE6EB7142408','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Mecklenburg-Vorpommern','MEC')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('7BF366D4-E9FC-4715-B7F9-1AF37CC97386','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Arkansas','AR')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('7CE436E6-349D-4F41-9053-5D7666662BB8','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Leon','Leon')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('7DC834F4-C490-4986-BFBC-10DFC94E235C','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Teruel','Teruel')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('7FCCE82B-7828-40C9-A860-A21A787780C2','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Bremen','BRE')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('84BF6B91-F9FF-4203-BAD1-B5CF01239B77','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Kentucky','KY')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('8587E33E-25FC-4C19-B504-0C93C027DD93','A71D6727-61E7-4282-9FCB-526D1E7BC24F','New Hampshire','NH')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('85F3B62E-D3E7-4DEC-B13B-DD494AD7B2CC','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Idaho','ID')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('86BDBE5D-4085-4916-984C-94C191C48C67','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Schwyz','SZ')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('87268168-CF40-442F-A526-06DDAEB1BEFD','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Michigan','MI')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('87C1483D-E471-4166-87CB-44F9C4459AA8','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Bayern','BAY')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('8A4E0E4C-2727-42CD-86D6-ED27A6A6B74B','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Cordoba','Cordoba')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('8A6DB145-7FF4-4DFA-AC88-EA161924EA03','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Freiburg','FR')

INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('8B1FE477-DB16-4DCB-92F0-DCBF2F1DE8CB','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Vermont','VT')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('8B3C48FD-9E7E-4653-A711-6DAC6971CB32','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Obwalden','OW')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('8BC664A9-B12C-4F48-AF34-A7F68384A76A','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Badajoz','Badajoz')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('8BD9D2B9-67DB-4FD6-90C7-52D0426E2007','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Guam','GU')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('8EE2F892-4EE6-44F5-938A-B553E885161A','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Pennsylvania','PA')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('8FAB7D36-B885-46CD-9DC8-41E40C8683C4','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Sao Paulo','SP')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('91BF4254-F418-404A-8CB2-5449D498991E','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Amazonas','AM')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('93215E73-4DF8-4609-AC37-9DA1B9BFE1C9','0C356C5A-CA44-4301-8212-1826CCDADC42','Saskatchewan','SK')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('933CD9EF-C021-48ED-8260-6C013685970F','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Florida','FL')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('93CDD758-CC83-4F5A-94C0-9A3D13C7FA44','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Armed Forces Europe','AE')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('956B1071-D4C1-4676-BE0C-E8834E47B674','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Burgos','Burgos')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('962D2729-CC0C-4052-ABC9-C696307F3F26','06BB7816-9AD4-47DC-B1CD-6E206AFDFCCA','Voralberg','VB')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('978ECAAB-C462-4D66-80B6-A65EB83B86A5','A71D6727-61E7-4282-9FCB-526D1E7BC24F','South Dakota','SD')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('993207EC-34A5-4896-88B0-3C43CCD11AB2','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Armed Forces Canada','AC')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('9C24162B-10DE-47C1-B55F-0DCAAA24F86E','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Nidwalden','NW')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('9C9951D7-68D2-438A-A702-4289CBC1720E','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Valencia','Valencia')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('9FB374C6-B87C-4096-A43C-D3D9FF2FD04C','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Distrito Federal','DF')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('A34DF017-1334-4F1F-AAB8-F650425F937D','06BB7816-9AD4-47DC-B1CD-6E206AFDFCCA','Krnten','KN')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('A39F8A9A-6586-41FB-9D5F-F84BD5161333','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Kansas','KS')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('A3A183AE-8117-46C0-93B7-3940C7E5694F','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Armed Forces Americas','AA')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('A3CB237B-A940-418F-8368-FA6E35263E22','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Asturias','Asturias')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('A6ED9918-44C7-4975-B680-95B4ABCFB7AC','06BB7816-9AD4-47DC-B1CD-6E206AFDFCCA','Salzburg','SB')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('AA492AC6-E3B1-4408-B503-81480B57F008','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Ourense','Ourense')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('AB47DF32-C57D-412B-B04D-67378C120AE7','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Armed Forces Pacific','AP')


INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('AD9E0130-B735-4BE0-9338-99E20BB9410D','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Thringen','THE')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('AFA207C7-E69D-46F0-8242-2A67A06C42E3','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Appenzell Innerrhoden','AI')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('B2B175A4-09BA-4E25-919C-9DE52109BF4D','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Brandenburg','BRG')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('B519AAAF-7E2C-421F-88B8-BF7853A8DE4F','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Tessin','TI')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('B5812090-E7E1-492B-B9BC-04FEC3EC9492','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Hawaii','HI')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('B5FEB85C-2DC0-4776-BA5C-8C2D1B688E89','06BB7816-9AD4-47DC-B1CD-6E206AFDFCCA','Wien','WI')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('B716403C-6B15-488B-9CD0-F60B1AA1BA41','0C356C5A-CA44-4301-8212-1826CCDADC42','New Brunswick','NB')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('B7500C17-30C7-4D87-BB47-BB35D8B1D3A6','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Navarra','Navarra')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('B8BF0B26-2F14-49E4-BFDA-2D01EAFA364B','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Alabama','AL')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('B9093677-F26A-4B47-AD98-12CAED313044','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Wisconsin','WI')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('B9F64887-ED6D-4DDC-A142-7EB8898CA47E','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Pernambuco','PE')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('B9F911EB-F762-4DA4-A81F-9BC967CD3C4B','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Waadt','VD')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('BA3C2043-CC3E-4225-B28E-BDB18C1A79EF','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Hessen','HES')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('BA5A801B-11C6-4408-B097-08AAC22E739E','A71D6727-61E7-4282-9FCB-526D1E7BC24F','South Carolina','SC')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('BB090CE7-E0CA-4D0D-96EB-1B8E044FBCA8','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Melilla','Melilla')

INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('BB607ECB-DF31-427B-88BB-4F53959B3E0C','06BB7816-9AD4-47DC-B1CD-6E206AFDFCCA','Niedersterreich','NO')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('C1983F1D-353A-4042-B097-F0E8237F7FCD','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','St. Gallen','SG')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('C26CFB75-5E44-4156-B660-A18A2A487FEC','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Murcia','Murcia')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('C2BA8E9E-D370-4639-B168-C51057E2397E','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Guadalajara','Guadalajara')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('C3E70597-E8DD-4277-B7FC-E9B4206DA073','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Connecticut','CT')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('C5D128D8-353A-43DC-BA0A-D0C35E33DE17','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Minas Gerais','MG')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('C7330896-BD61-4282-B3BF-8713A28D3B50','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Indiana','IN')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('C7A02C1C-3076-43B3-9538-B513BAB8A243','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Soria','Soria')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('CA553819-434A-408F-A2A4-92A7DF9A2618','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Cuenca','Cuenca')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('CA5C0C52-E8AE-4CCD-9A45-565E352C4E2B','06BB7816-9AD4-47DC-B1CD-6E206AFDFCCA','Steiermark','ST')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('CB47CC62-5D26-4B17-B01F-25E5432F913C','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Lugo','Lugo')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('CB6D309D-ED20-48D0-8A5D-CD1D7FD1AAD6','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Utah','UT')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('CBC4121C-D62D-410C-B699-60B08B67711F','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Piaui','PI')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('CBD2718F-DD60-4151-A24D-437FF37605C6','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Jaen','Jaen')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('CC6B7A8E-4275-4E4E-8D62-34B5480F3995','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Huesca','Huesca')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('CCD7968C-7E80-4381-958B-AB72BE0D6C35','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Solothurn','SO')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('CF6E4B72-5F4F-4CC4-ADD3-EB0964892F7B','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Huelva','Huelva')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('CF75931A-D86F-43A0-8BD9-3942D5945FF7','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Mississippi','MS')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('CFA0C0E5-B478-41BD-9029-49BD04C68871','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Washington','WA')

INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D20875CC-8572-453C-B5E0-53B49742DEBB','0C356C5A-CA44-4301-8212-1826CCDADC42','Nunavut','NU')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D21905C5-6EE9-4072-9618-8447D9C4390E','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Alava','Alava')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D21E2732-779D-406A-B1B9-CF44FF280DFE','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Pontevedra','Pontevedra')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D226235D-0EB0-49C5-9E7A-55CC91C57100','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Palencia','Palencia')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D256F9B7-8A33-4D04-9E19-95C12C967719','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Rondonia','RO')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D284266A-559D-42F3-A881-0136EA080C12','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Rio De Janeiro','RJ')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D2880E75-E454-41A1-A73D-B2CFF71197E2','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Massachusetts','MA')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D318E32E-41B6-4CA6-905D-23714709F38F','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Armed Forces Africa','AF')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D4F8133E-5580-4A66-94DD-096D295723A0','0C356C5A-CA44-4301-8212-1826CCDADC42','Prince Edward Island','PE')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D52CEDAC-FCC2-4B9C-8F9E-09DCDA91974C','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Santa Cruz de Tenerife','Santa Cruz de Tenerife')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D55B4820-1CCD-44AD-8FBE-60B750ABC2DD','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Niedersachsen','NDS')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D698A1B6-68D7-480E-8137-421C684F251D','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Alagoas','AL')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D85B7129-D009-4747-9748-B116739BA660','0C356C5A-CA44-4301-8212-1826CCDADC42','Alberta','AB')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D892EA50-FCCF-477A-BBDF-418E32DC5B98','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Appenzell Ausserrhoden','AR')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D907D2A6-4CAA-4687-898A-58BD5F978D03','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Missouri','MO')

INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('D96D5675-F3E2-42FE-B581-BD2367DC5012','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Madrid','Madrid')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('DAD6586A-C504-4117-B116-4C80A0D1BF52','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Valladolid','Valladolid')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('DB9CCCCF-9E20-4224-88A7-067E5238960D','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Toledo','Toledo')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('DEC30815-883A-45A2-9318-BFB111B383D6','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Oregon','OR')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('E026BF9D-66A9-49BF-BA77-860B8C60871D','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Zaragoza','Zaragoza')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('E663AEF7-A697-4164-8CE4-141AC5CEF6A9','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Para','PA')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('E83159F2-ABE3-4F94-80DE-A149BCF83428','A71D6727-61E7-4282-9FCB-526D1E7BC24F','District of Columbia','DC')

INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('E8426499-9214-41C8-9717-44F2A4D6D14E','0C356C5A-CA44-4301-8212-1826CCDADC42','Quebec','QC')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('E885E0CE-A268-4DB0-AFF2-A0205353E7E4','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Neuenburg','NE')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('EA73C8EB-CAC2-4B28-BB9A-D923F32C17EF','A71D6727-61E7-4282-9FCB-526D1E7BC24F','New York','NY')

INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('EB8EFD2D-B9FA-4F99-9C49-9DEF24CCC5B5','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Wyoming','WY')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('EBC9105F-1F6E-44BE-B4F2-6D23908278D6','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Louisiana','LA')

INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('DCC28B9C-8D2F-4569-AD0A-AD5717DA3BB7','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Graubnden','JU')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('DDB0CA67-8635-4F40-A01D-06CCB266EF56','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Parana','PR')

INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('EC2A6FED-19C2-4364-99CB-A59E8E0929FE','60CE9AB1-945D-4FEF-ABA8-A1BB640165BE','Zrich','ZH')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('F1BBC9FC-4B0A-4065-843E-F428F1C20346','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Georgia','GA')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('F23BAB33-CAD9-4D9C-9CED-A66B3FF4969F','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Delaware','DE')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('F2E5FFCE-BF2A-4F21-9696-FD948C07D6AE','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Rio Grande Do Norte','RN')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('F5315BF8-0DC2-49E7-ABEB-0D7348492E6B','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Cantabria','Cantabria')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('F6B97ED0-D090-4C68-A590-8FE743EE6D43','A71D6727-61E7-4282-9FCB-526D1E7BC24F','Palau','PW')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('F92A3196-5C67-4FEC-8877-78B28803B8D6','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','A Corua','A Corua')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('F93295D1-7501-487D-93AD-6BD019E82CC2','06BB7816-9AD4-47DC-B1CD-6E206AFDFCCA','Obersterreich','OO')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('FB63F22D-2A32-484E-A3E8-41BBAE13891B','2D5B53A8-8341-4DA4-A296-E516FE5BB953','Schleswig-Holstein','SCN')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('FBE69225-8CAD-4E54-B4E5-03D6E404BC3F','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Paraiba','PB')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('FCD4595B-4B67-4B73-84C6-29706A57AF38','13FAA99E-18F2-4E6F-B275-1E785B3383F3','Mato Grosso','MT')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('FE29FFDB-5E1C-44BD-BB9A-2E2E43C1B206','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Malaga','Malaga')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('FEA759DA-4280-46A8-AF3F-EC2CC03B436A','38DC01C3-48D8-4FF8-A78A-2C35D4FBFA7B','Girona','Girona')
INSERT INTO [mp_GeoZone] ([Guid],[CountryGuid],[Name],[Code])VALUES('FEC3A4F7-E3B5-44D3-BBDE-62628489B459','A71D6727-61E7-4282-9FCB-526D1E7BC24F','North Carolina','NC')



INSERT INTO [mp_Currency] ([Guid],[Title],[Code],[SymbolLeft],[SymbolRight],[DecimalPointChar],[ThousandsPointChar],[DecimalPlaces],[Value],[LastModified],[Created])VALUES('FF2DDE1B-E7D7-4C3A-9AB4-6474345E0F31','US Dollar','USD','$','','.',',','2',1.000000, getutcdate(), getutcdate())
INSERT INTO [mp_Currency] ([Guid],[Title],[Code],[SymbolLeft],[SymbolRight],[DecimalPointChar],[ThousandsPointChar],[DecimalPlaces],[Value],[LastModified],[Created])VALUES('6A5EF486-EE65-441F-9C63-C003E30981FE','Euro','EUR','',' ','.',',','2',1.00000000, getutcdate(), getutcdate())

INSERT INTO [mp_Language] ([Guid],[Name],[Code],[Sort])VALUES('346A1CA8-FAFD-420A-BDE2-C535E5BDBC26','Deutsch','de',100)
INSERT INTO [mp_Language] ([Guid],[Name],[Code],[Sort])VALUES('6D81A11E-F1D3-4CD6-B713-8C7B2BB32B3F','English','en',100)
INSERT INTO [mp_Language] ([Guid],[Name],[Code],[Sort])VALUES('FBA6E2AA-2A69-4D89-B389-D5AE92F2AA06','Espaol','es',100)







ALTER TABLE [dbo].[mp_GeoZone] ADD CONSTRAINT [FK_mp_GeoZone_mp_GeoCountry] FOREIGN KEY ([CountryGuid]) REFERENCES [dbo].[mp_GeoCountry] ([Guid])


COMMIT TRANSACTION
